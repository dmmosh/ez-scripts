#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f /home/wetsock/coding/ez-scripts/git-all/git-all.sh -o /usr/bin/git-all 
#endif

static  char data [] = 
#define      xecc_z	15
#define      xecc	((&data[0]))
	"\226\154\273\326\210\223\345\024\047\336\011\367\115\206\035\003"
	"\322\263"
#define      date_z	1
#define      date	((&data[18]))
	"\054"
#define      tst2_z	19
#define      tst2	((&data[23]))
	"\043\173\241\062\316\134\262\015\045\210\305\261\325\276\316\350"
	"\016\372\022\172\164\214\326"
#define      chk2_z	19
#define      chk2	((&data[43]))
	"\375\060\065\377\357\050\177\347\301\325\263\135\064\322\235\306"
	"\144\214\154\165\057\264"
#define      inlo_z	3
#define      inlo	((&data[64]))
	"\376\214\304"
#define      pswd_z	256
#define      pswd	((&data[95]))
	"\136\054\116\274\151\115\300\073\000\346\061\233\311\002\253\355"
	"\176\115\037\151\255\261\146\334\146\273\271\327\345\333\032\235"
	"\111\116\327\152\173\140\156\153\077\237\063\176\145\236\067\034"
	"\274\352\012\164\347\302\242\020\334\151\073\301\105\125\136\216"
	"\243\066\371\037\227\147\213\326\007\276\125\154\135\214\211\032"
	"\167\223\216\137\126\060\160\062\231\253\363\336\000\122\155\244"
	"\210\147\303\037\316\116\366\326\015\113\102\153\330\314\205\117"
	"\137\023\256\265\104\036\347\336\311\333\275\312\055\053\156\266"
	"\222\062\326\140\201\314\067\216\030\172\372\360\106\177\077\245"
	"\223\356\133\330\015\103\266\327\036\164\241\114\237\020\003\061"
	"\103\331\222\304\246\311\123\276\103\115\256\211\314\356\056\140"
	"\335\212\070\352\315\357\302\354\143\143\070\002\164\073\063\267"
	"\025\305\174\273\217\317\172\322\034\051\133\351\027\212\112\364"
	"\024\203\337\342\162\241\316\326\005\006\330\172\102\014\062\130"
	"\322\256\024\141\175\216\063\232\267\217\203\317\031\315\304\056"
	"\120\243\020\303\105\336\231\112\345\162\304\050\177\366\200\121"
	"\245\225\263\042\043\347\274\333\166\100\252\220\016\156\276\137"
	"\022\317\042\127\255\274\242\223\056\147\274\255\262\052\170\020"
	"\127\306\315\300\024\216\374\024\164\056\257\076\060\133\053\257"
	"\251\113\030\126\375\176\062\143\071\353\073\354\025\263\374\154"
	"\171\312\055\215"
#define      lsto_z	1
#define      lsto	((&data[391]))
	"\234"
#define      text_z	6286
#define      text	((&data[936]))
	"\013\211\256\067\070\127\203\121\255\200\320\340\344\012\314\040"
	"\366\342\323\363\117\115\275\174\333\026\247\176\343\000\320\357"
	"\211\177\047\302\327\252\023\205\053\344\145\020\356\061\060\344"
	"\023\003\327\142\121\225\337\054\253\206\252\217\206\173\177\020"
	"\372\246\323\321\121\346\127\175\313\274\215\271\356\275\235\002"
	"\301\165\144\022\012\104\076\266\313\351\105\122\144\305\142\136"
	"\154\065\060\276\034\207\073\347\104\310\241\062\206\076\064\107"
	"\263\231\131\276\335\230\164\251\201\272\373\345\177\136\104\354"
	"\223\165\252\260\374\346\230\101\257\071\164\065\170\251\174\054"
	"\102\326\352\040\156\137\311\360\031\304\325\231\043\032\205\267"
	"\217\060\147\214\026\000\315\305\072\101\372\262\352\167\337\055"
	"\116\311\115\274\050\027\254\102\334\202\333\377\234\141\266\053"
	"\221\036\270\247\036\205\154\131\307\147\014\262\336\353\340\054"
	"\265\056\351\336\105\226\040\042\031\374\041\265\135\327\341\356"
	"\366\231\225\025\037\001\156\347\150\172\231\107\145\172\163\032"
	"\250\135\371\355\363\031\017\014\025\061\302\162\011\244\140\377"
	"\076\366\024\135\367\203\104\140\375\336\247\143\131\033\175\001"
	"\171\166\357\154\220\377\171\246\060\074\031\072\340\171\071\036"
	"\160\116\174\150\321\301\310\317\240\160\062\371\214\260\373\005"
	"\047\352\162\267\351\354\136\032\050\167\124\011\361\215\050\141"
	"\334\245\311\256\146\222\175\007\002\260\001\216\140\374\223\210"
	"\346\006\100\320\362\236\352\033\025\076\044\006\314\115\150\251"
	"\362\061\127\131\303\325\140\306\205\141\124\346\135\350\156\104"
	"\357\256\024\341\114\376\374\142\075\041\150\011\156\321\263\141"
	"\002\012\272\306\337\033\214\145\174\341\113\332\312\272\037\271"
	"\150\063\233\265\062\227\027\160\271\200\172\047\121\055\210\123"
	"\067\103\032\027\136\246\175\333\210\311\265\123\203\325\014\353"
	"\011\247\240\074\077\270\254\370\070\046\040\211\123\251\335\213"
	"\354\367\243\112\236\040\045\046\351\333\171\155\260\206\130\272"
	"\056\371\366\155\262\242\146\352\311\206\164\035\057\121\250\033"
	"\110\114\146\347\155\213\015\127\147\207\304\030\016\035\322\074"
	"\027\310\252\311\153\020\264\064\227\050\121\306\171\372\342\302"
	"\107\110\251\264\324\267\013\073\076\320\124\114\356\046\211\005"
	"\357\063\317\132\103\203\216\332\253\340\241\045\333\203\347\042"
	"\235\306\030\117\045\176\061\323\131\165\255\102\363\364\116\337"
	"\336\010\154\345\245\336\203\245\321\337\332\176\335\012\107\035"
	"\115\306\140\017\025\213\362\374\067\331\211\073\170\044\044\170"
	"\202\271\166\210\260\352\126\022\215\022\000\117\301\312\351\334"
	"\307\275\026\127\225\161\064\372\057\344\066\020\144\157\252\372"
	"\025\357\335\352\236\113\011\000\204\057\266\347\224\121\071\123"
	"\124\111\331\163\134\367\041\155\044\037\364\076\210\357\213\137"
	"\225\245\126\060\205\264\061\174\153\374\214\364\053\307\122\140"
	"\001\247\372\240\325\020\160\273\040\252\101\322\346\142\175\106"
	"\023\163\161\307\221\037\164\143\000\266\121\173\357\244\162\213"
	"\157\005\035\160\266\024\076\100\146\377\377\176\122\245\153\171"
	"\025\112\154\212\112\242\147\017\206\037\176\167\070\175\243\030"
	"\215\341\202\202\227\076\204\213\303\220\343\247\103\226\123\204"
	"\333\345\356\115\143\234\367\251\225\340\041\224\041\062\107\304"
	"\165\036\063\050\025\242\236\170\320\200\105\145\122\075\152\110"
	"\120\072\244\254\157\367\313\234\160\253\043\022\246\140\157\037"
	"\253\341\003\332\254\025\366\262\240\136\217\322\230\365\110\307"
	"\251\144\011\114\373\030\222\136\102\155\357\161\340\153\057\351"
	"\334\043\267\371\104\227\242\175\034\231\317\065\173\041\075\000"
	"\115\276\063\364\374\004\243\205\012\312\012\052\355\354\154\347"
	"\175\311\322\335\266\350\006\245\222\270\012\110\014\174\302\333"
	"\221\154\132\052\276\252\170\240\154\362\065\102\204\367\106\062"
	"\235\243\025\035\012\311\022\104\375\070\056\236\373\000\302\163"
	"\162\022\145\010\267\275\175\027\165\227\373\065\220\061\161\027"
	"\045\244\370\033\202\054\010\351\324\065\111\300\034\027\146\010"
	"\326\176\341\032\122\343\256\162\200\374\267\052\153\274\217\043"
	"\251\063\053\155\367\135\374\275\312\375\227\036\120\000\074\117"
	"\261\266\157\260\160\132\044\050\223\320\373\301\200\105\052\031"
	"\047\137\222\275\167\012\035\246\021\145\342\170\160\205\130\077"
	"\042\024\225\077\234\013\323\152\070\215\232\155\042\054\044\042"
	"\034\267\175\305\103\042\301\031\002\267\115\365\365\352\207\266"
	"\007\214\126\026\007\160\166\122\223\056\073\061\136\113\327\022"
	"\162\250\243\156\223\333\010\034\322\312\125\115\042\142\161\044"
	"\046\120\124\033\367\275\303\234\232\235\230\364\071\223\154\073"
	"\050\023\340\144\367\044\353\175\200\234\052\026\251\014\210\316"
	"\351\030\166\337\273\036\074\345\264\316\053\031\031\121\211\064"
	"\366\224\253\132\074\071\215\100\027\020\032\111\360\371\345\147"
	"\003\345\022\042\347\207\000\105\203\365\270\075\237\235\010\273"
	"\134\127\107\054\177\244\215\211\000\342\350\244\135\250\022\067"
	"\360\273\216\173\311\076\036\006\210\016\344\301\012\304\201\113"
	"\300\222\071\116\232\123\322\153\343\244\273\010\211\166\232\047"
	"\326\277\207\150\135\306\266\176\050\000\205\014\334\234\060\246"
	"\051\302\152\240\325\166\330\146\344\374\076\311\275\132\243\172"
	"\216\226\325\016\070\205\016\076\270\150\254\342\312\360\374\243"
	"\274\374\021\245\020\155\132\221\053\372\133\204\061\034\346\073"
	"\366\124\136\377\064\003\155\202\245\277\107\305\377\221\253\040"
	"\025\242\330\240\137\107\214\350\006\357\003\273\246\102\311\176"
	"\345\056\326\217\141\350\131\044\271\277\063\327\353\360\136\252"
	"\205\046\171\076\317\343\017\361\103\377\137\224\271\221\333\376"
	"\070\224\055\372\152\313\120\273\027\272\036\046\346\244\226\244"
	"\221\332\174\061\274\270\011\061\170\025\150\262\254\151\103\256"
	"\267\256\134\233\056\075\004\200\270\016\226\306\030\115\205\232"
	"\026\366\124\347\014\133\335\327\020\051\060\102\361\350\004\273"
	"\134\305\071\141\220\343\002\020\237\264\310\152\263\226\177\101"
	"\315\152\025\070\145\240\246\230\213\277\174\242\226\321\123\171"
	"\315\124\111\341\215\276\205\154\330\356\170\112\363\155\111\315"
	"\312\122\234\052\071\254\353\102\114\347\330\320\024\336\030\231"
	"\214\065\023\263\352\076\315\140\005\101\131\055\370\356\367\052"
	"\317\104\055\122\174\353\003\047\301\276\216\360\107\214\075\115"
	"\010\220\254\010\376\230\061\131\113\263\025\146\311\365\101\361"
	"\147\055\050\165\130\226\046\162\123\214\320\144\131\171\223\327"
	"\041\000\325\015\235\220\363\156\174\200\330\246\301\112\232\333"
	"\217\153\352\141\306\255\040\242\222\133\107\244\227\377\303\146"
	"\317\103\215\041\320\215\331\142\125\004\374\125\203\172\112\200"
	"\215\260\217\105\306\357\205\260\205\322\106\106\322\110\071\352"
	"\030\375\226\077\325\221\376\362\071\042\336\224\045\066\216\334"
	"\100\312\312\211\372\177\332\136\362\341\041\360\050\217\171\361"
	"\116\332\376\014\122\017\237\021\331\121\145\174\031\120\172\000"
	"\056\351\376\141\236\114\151\340\274\344\140\023\040\242\247\272"
	"\332\173\137\344\017\251\323\124\136\126\037\016\333\174\212\324"
	"\011\077\375\153\206\225\003\331\243\275\352\236\323\076\076\217"
	"\236\022\330\172\046\325\012\177\016\261\134\102\331\243\134\121"
	"\015\274\311\273\053\171\076\170\215\041\125\333\240\342\170\207"
	"\105\254\156\364\202\202\077\125\011\355\351\260\021\057\324\131"
	"\103\036\137\026\132\303\173\162\311\260\237\076\137\102\313\351"
	"\370\376\017\125\352\331\110\201\042\003\103\163\131\265\362\324"
	"\024\272\023\035\146\104\076\147\053\315\234\153\265\146\040\127"
	"\127\004\077\200\146\250\024\050\255\220\372\320\204\016\301\033"
	"\147\312\333\310\142\362\353\125\015\314\201\315\151\333\144\237"
	"\332\270\142\247\137\057\177\275\300\322\344\153\025\344\070\214"
	"\337\022\032\305\217\064\246\211\300\203\167\062\100\063\147\345"
	"\164\172\164\036\176\343\267\031\161\112\167\174\246\014\202\035"
	"\347\303\343\311\342\016\376\061\121\005\301\065\332\314\167\304"
	"\064\004\226\207\032\365\324\257\012\177\344\352\212\002\106\237"
	"\307\164\350\302\310\155\026\004\213\311\262\121\046\311\043\241"
	"\275\346\301\023\005\330\357\317\155\067\127\210\016\055\177\001"
	"\122\274\201\012\050\344\104\046\043\160\343\012\323\103\142\330"
	"\166\034\144\104\353\303\152\021\260\147\271\030\230\100\004\145"
	"\372\047\324\227\113\076\243\204\272\066\206\107\242\040\077\264"
	"\376\352\145\014\032\065\127\276\031\200\104\351\257\265\233\263"
	"\015\217\266\104\353\252\000\027\175\251\227\032\250\165\041\250"
	"\111\357\350\271\361\152\137\265\020\206\023\336\212\251\033\154"
	"\103\071\143\065\035\111\203\271\340\077\327\240\336\004\227\336"
	"\214\164\241\101\014\071\034\075\033\354\317\270\266\040\373\327"
	"\346\224\023\212\205\266\035\100\232\343\367\003\100\263\376\261"
	"\352\273\062\144\075\131\106\373\214\067\304\133\152\361\054\132"
	"\075\131\305\060\044\347\214\235\064\032\032\111\304\134\221\025"
	"\016\276\262\036\145\131\306\214\241\261\132\245\115\136\170\224"
	"\160\167\160\326\015\124\225\147\120\313\325\125\176\371\112\175"
	"\032\203\155\115\004\123\232\357\127\265\067\143\367\305\246\211"
	"\225\046\157\160\302\000\331\306\330\076\157\166\310\022\041\135"
	"\330\271\360\212\073\213\201\143\363\376\311\115\070\131\055\130"
	"\355\216\276\230\323\007\261\256\175\157\204\354\164\142\352\205"
	"\215\001\336\126\247\006\355\341\151\262\353\121\154\367\347\325"
	"\011\237\311\272\055\271\021\211\234\022\253\266\353\315\060\023"
	"\347\334\365\346\154\005\251\262\157\167\246\033\306\350\326\377"
	"\271\114\362\270\247\231\252\327\263\013\052\344\244\362\210\307"
	"\012\246\107\073\025\001\063\156\324\234\370\131\075\130\303\265"
	"\001\210\202\200\366\163\013\341\155\024\060\332\205\024\106\062"
	"\266\367\303\226\014\231\060\236\026\341\265\240\302\100\355\120"
	"\254\134\172\304\251\177\342\263\234\070\271\221\132\033\366\361"
	"\060\031\251\373\052\123\316\321\367\332\077\253\134\260\212\227"
	"\227\060\004\304\263\356\326\270\111\347\302\143\141\174\303\203"
	"\273\231\056\373\374\223\040\172\243\260\074\113\107\247\005\242"
	"\061\122\267\231\070\035\203\332\333\333\304\144\212\067\254\343"
	"\145\020\025\111\304\372\337\077\143\044\140\230\037\112\100\133"
	"\205\273\340\060\003\116\150\342\145\061\205\207\056\043\333\022"
	"\177\146\233\316\373\311\325\016\347\175\245\217\240\250\030\306"
	"\075\050\354\365\105\033\254\073\341\300\334\216\244\154\310\311"
	"\065\072\206\353\136\017\110\125\046\046\353\162\115\105\151\102"
	"\262\126\101\104\051\104\304\342\012\325\130\352\164\356\005\303"
	"\226\037\343\050\253\350\015\255\340\126\327\154\202\122\160\267"
	"\227\250\342\164\375\145\152\175\206\136\033\052\143\243\176\312"
	"\120\145\040\325\107\072\253\202\250\324\110\271\073\160\047\371"
	"\156\125\025\207\360\000\211\336\114\051\073\324\000\100\030\177"
	"\357\161\346\131\210\155\302\274\320\107\276\303\013\262\116\042"
	"\077\026\303\311\034\135\241\330\026\253\337\062\070\360\070\130"
	"\363\344\034\142\252\043\136\225\372\367\201\120\103\373\333\265"
	"\016\112\146\043\223\015\354\250\143\044\006\021\136\161\220\314"
	"\350\130\134\302\131\211\120\141\016\347\001\212\210\251\165\063"
	"\000\263\367\112\040\135\170\231\315\051\047\272\277\131\056\341"
	"\344\364\135\260\216\101\141\302\152\351\134\007\311\126\337\310"
	"\175\307\060\110\366\304\142\061\245\263\273\270\017\212\012\374"
	"\226\264\214\106\207\017\032\101\236\041\376\213\155\270\337\267"
	"\323\145\337\055\364\020\166\356\122\370\336\344\275\314\244\222"
	"\156\150\150\142\345\067\023\130\366\205\244\205\226\066\306\322"
	"\024\027\066\007\370\335\374\315\250\071\045\137\355\217\057\210"
	"\355\244\305\105\361\114\056\157\002\047\120\301\235\051\265\257"
	"\203\177\170\110\155\155\242\120\007\022\324\130\243\057\105\025"
	"\064\261\117\315\304\263\154\016\344\366\367\311\242\332\007\115"
	"\266\030\314\213\236\343\233\013\274\222\200\250\240\152\251\050"
	"\231\171\037\044\210\077\020\144\044\151\121\047\053\261\356\205"
	"\155\303\122\225\003\155\073\042\034\024\363\362\340\300\064\002"
	"\235\235\301\316\274\365\177\250\022\357\303\255\244\301\333\372"
	"\366\011\004\052\160\262\136\302\256\331\351\075\257\076\341\162"
	"\266\327\153\231\035\067\214\203\220\136\240\171\101\161\010\362"
	"\060\375\266\052\212\213\231\326\215\077\154\375\100\007\010\352"
	"\023\255\107\335\107\304\206\300\165\013\251\062\026\014\114\202"
	"\066\235\220\205\126\116\304\002\154\315\317\146\345\360\174\316"
	"\366\256\002\006\151\340\070\337\305\016\260\025\244\115\373\333"
	"\240\275\266\117\227\254\054\247\172\107\241\113\332\323\137\127"
	"\211\077\200\240\047\350\122\216\232\136\044\251\036\016\121\363"
	"\335\101\051\130\060\162\322\300\066\133\345\014\242\105\144\151"
	"\056\203\206\353\012\277\267\253\054\056\355\215\273\064\353\301"
	"\023\350\355\124\212\277\026\377\324\333\123\200\353\250\235\352"
	"\011\010\132\015\072\157\352\054\223\051\034\114\024\021\313\246"
	"\231\041\231\126\167\162\017\105\260\145\270\173\144\047\270\235"
	"\335\153\247\000\347\267\312\344\157\055\013\032\247\365\010\243"
	"\001\326\011\134\314\113\320\052\042\366\142\331\206\253\117\036"
	"\271\264\027\334\157\200\001\332\164\011\232\362\235\055\122\056"
	"\073\000\273\240\002\126\276\025\110\162\026\075\007\225\206\151"
	"\341\374\316\023\210\146\040\063\356\066\346\170\107\143\224\340"
	"\236\257\216\375\126\360\163\250\111\071\374\346\251\250\242\225"
	"\266\275\333\214\136\062\320\314\143\162\264\056\125\317\335\300"
	"\275\226\232\200\016\264\345\313\076\126\260\336\365\355\243\051"
	"\323\251\344\306\165\274\105\200\260\306\106\020\212\154\356\105"
	"\077\125\247\041\102\241\354\100\276\200\020\126\131\237\065\345"
	"\135\046\233\103\077\276\325\037\134\152\215\154\136\026\225\166"
	"\045\145\016\342\374\310\157\102\146\031\171\143\202\352\131\214"
	"\163\062\030\054\047\067\041\132\060\035\065\356\315\341\030\054"
	"\335\340\055\347\236\033\250\367\341\251\311\061\110\353\172\154"
	"\261\111\341\244\074\375\027\206\234\323\132\342\067\027\157\003"
	"\112\153\312\337\045\254\160\027\140\211\030\251\022\257\030\216"
	"\263\231\136\215\306\141\054\347\173\354\054\345\242\316\327\232"
	"\351\155\352\051\317\035\177\215\047\040\335\327\364\177\041\265"
	"\057\050\067\153\242\013\056\367\372\066\217\355\240\374\166\337"
	"\206\063\224\231\370\321\204\367\353\163\076\230\045\346\377\037"
	"\127\117\300\242\367\334\007\013\231\051\264\237\231\226\200\376"
	"\273\304\072\336\104\221\175\160\214\362\122\163\352\277\130\346"
	"\131\340\171\201\272\026\115\250\010\136\343\156\212\160\020\114"
	"\053\307\304\013\142\125\342\117\006\237\020\270\004\225\260\120"
	"\200\152\212\216\001\003\230\161\220\052\064\217\127\166\061\106"
	"\135\073\347\233\235\136\067\350\111\354\265\153\323\010\305\205"
	"\010\070\233\337\255\356\365\144\123\155\105\273\263\354\025\265"
	"\143\232\330\100\100\255\155\020\060\013\131\045\261\340\332\215"
	"\312\314\060\227\171\236\374\163\373\043\172\054\162\072\044\045"
	"\110\273\262\133\076\316\067\073\004\142\113\275\202\244\360\266"
	"\170\324\342\001\206\164\263\262\062\063\226\236\370\155\133\225"
	"\371\307\101\007\377\073\326\302\176\200\060\346\221\073\302\126"
	"\007\162\315\146\030\043\111\073\342\235\316\102\173\120\147\316"
	"\335\222\207\346\154\120\247\251\043\114\352\264\156\144\165\213"
	"\077\057\213\377\316\022\037\252\067\166\123\324\202\057\347\322"
	"\275\026\321\125\257\254\304\333\026\236\117\353\333\140\131\155"
	"\325\204\307\335\362\105\240\361\315\366\011\114\045\247\046\156"
	"\355\316\153\176\232\161\173\300\337\156\317\070\273\051\020\242"
	"\200\215\046\235\302\033\014\301\052\113\027\363\362\022\321\011"
	"\263\351\042\211\345\017\317\323\106\221\212\076\360\244\004\165"
	"\002\176\266\002\261\326\342\224\117\142\107\277\205\272\033\266"
	"\260\335\050\305\167\033\050\227\161\040\017\200\153\102\013\060"
	"\015\302\351\235\001\123\074\176\337\230\274\057\233\245\032\162"
	"\053\051\066\237\351\163\336\056\340\335\332\351\373\266\010\143"
	"\261\162\365\034\274\136\352\222\051\316\205\167\040\044\177\125"
	"\206\300\242\320\347\351\112\040\202\376\350\341\254\120\107\352"
	"\075\163\230\123\076\376\273\070\014\004\331\277\126\257\253\156"
	"\303\066\156\026\037\306\332\177\241\052\001\261\036\077\121\263"
	"\070\374\206\312\010\023\130\072\014\247\270\134\355\130\040\141"
	"\124\124\300\212\015\026\113\121\331\144\150\374\252\042\017\201"
	"\001\133\311\231\071\033\217\301\035\053\130\275\314\252\144\163"
	"\363\353\061\334\365\367\302\174\034\053\362\333\212\157\017\204"
	"\142\335\236\217\047\033\207\215\177\355\312\365\354\206\212\371"
	"\256\034\071\305\150\134\102\376\041\330\165\006\144\312\153\264"
	"\305\173\005\270\154\222\125\050\014\321\157\344\077\321\001\007"
	"\231\173\061\033\302\367\322\377\132\107\015\337\033\071\361\364"
	"\304\333\100\070\100\177\104\144\366\346\121\256\154\247\155\272"
	"\167\332\110\340\336\320\357\017\365\207\136\302\304\352\146\326"
	"\060\077\167\242\014\046\204\032\142\343\275\365\353\144\134\343"
	"\357\325\254\322\246\367\117\241\257\100\066\122\235\210\112\167"
	"\164\311\130\325\360\261\325\020\334\053\331\335\145\277\141\204"
	"\035\055\267\253\357\276\002\174\000\264\316\057\006\100\120\112"
	"\025\155\021\347\122\016\161\317\057\225\367\014\311\324\056\076"
	"\275\377\373\120\344\131\371\351\256\145\024\032\265\073\175\010"
	"\115\236\330\045\262\320\007\032\132\375\017\017\136\371\037\326"
	"\315\225\176\377\172\321\174\054\367\050\151\273\256\203\166\313"
	"\265\145\363\365\326\270\361\306\221\251\071\150\045\054\364\205"
	"\242\144\130\140\245\076\357\016\175\315\207\273\151\075\016\203"
	"\005\246\227\044\257\230\266\013\211\144\133\013\245\202\063\104"
	"\273\150\245\005\237\171\260\150\067\253\313\032\112\230\364\056"
	"\133\047\172\206\255\316\310\120\317\064\333\354\157\031\062\375"
	"\346\203\307\037\127\074\254\175\147\177\242\355\235\323\353\017"
	"\335\210\225\273\122\304\042\107\107\043\234\234\320\017\113\240"
	"\035\030\000\230\211\142\153\307\316\370\032\332\225\217\045\311"
	"\301\057\013\012\056\376\137\035\300\017\314\117\356\073\116\257"
	"\373\362\334\021\355\242\305\037\244\116\010\165\214\041\076\322"
	"\127\000\166\375\004\022\025\206\022\307\252\363\260\347\314\171"
	"\000\133\304\232\124\366\315\000\242\212\302\055\154\174\264\226"
	"\101\221\167\157\261\060\201\264\003\316\255\313\327\120\221\067"
	"\074\377\116\202\221\161\167\014\265\333\214\360\035\316\266\301"
	"\024\232\256\327\273\263\272\326\374\223\353\331\262\323\333\000"
	"\035\116\151\177\254\175\242\375\174\312\024\340\373\016\147\127"
	"\105\276\163\237\006\031\125\341\322\123\111\246\021\114\241\272"
	"\013\233\002\357\202\135\076\273\370\252\067\276\001\126\125\232"
	"\036\274\160\156\063\365\133\265\176\262\051\216\235\052\224\242"
	"\360\054\363\204\376\376\060\075\052\034\255\074\135\072\247\300"
	"\230\201\154\173\323\032\004\217\117\311\257\005\350\016\001\302"
	"\202\063\252\365\011\072\114\077\211\225\031\203\037\221\352\150"
	"\377\237\001\011\142\171\133\314\141\144\322\145\115\275\137\214"
	"\262\111\143\135\047\160\374\105\172\342\307\156\373\246\235\162"
	"\257\204\252\121\206\025\020\346\270\127\265\272\175\042\322\140"
	"\253\147\035\304\304\325\252\374\202\350\341\116\271\234\064\277"
	"\222\165\156\102\070\115\227\302\232\301\217\040\222\377\245\300"
	"\155\122\104\044\163\355\057\257\357\010\307\237\075\312\167\006"
	"\271\306\240\031\304\213\235\003\020\020\374\044\074\162\353\103"
	"\170\140\050\071\303\220\266\275\104\256\223\375\345\147\236\045"
	"\037\156\020\056\353\302\056\327\033\162\202\334\216\163\001\323"
	"\224\120\046\303\045\201\031\331\264\037\051\146\322\023\232\302"
	"\135\053\347\025\304\037\204\214\043\144\312\175\373\124\041\365"
	"\074\362\353\137\121\255\116\130\204\163\215\105\137\104\354\156"
	"\000\217\361\044\327\305\311\316\020\362\235\346\213\316\253\213"
	"\315\034\042\361\031\242\315\137\261\132\303\365\302\216\055\312"
	"\057\136\004\146\140\271\320\344\306\245\342\370\122\230\301\074"
	"\251\274\126\263\354\035\204\363\001\352\062\235\202\064\140\021"
	"\107\367\320\174\126\206\360\062\365\307\135\050\357\015\022\155"
	"\204\113\077\067\131\157\012\325\053\365\313\375\172\225\210\076"
	"\306\300\372\133\103\274\311\223\103\322\043\324\172\171\122\361"
	"\270\317\356\265\323\015\256\024\153\330\025\324\136\241\151\107"
	"\023\334\121\132\356\234\102\020\017\274\137\105\023\134\131\156"
	"\141\000\233\134\174\357\130\373\137\023\021\022\231\110\256\253"
	"\147\344\307\035\172\303\146\267\301\266\336\333\141\155\037\324"
	"\301\224\330\012\372\231\104\344\120\014\042\013\053\254\313\227"
	"\230\351\373\027\147\362\123\140\027\111\344\027\265\040\357\354"
	"\146\075\067\260\250\103\164\353\250\242\075\337\347\140\075\214"
	"\303\331\352\252\101\033\345\176\144\136\003\324\377\251\022\141"
	"\020\135\252\225\237\120\346\341\311\033\030\064\005\216\135\056"
	"\032\376\321\054\250\164\347\144\341\011\075\161\131\355\363\264"
	"\020\342\167\251\114\347\005\211\353\110\124\152\157\301\311\067"
	"\165\237\376\027\236\163\153\360\354\232\042\033\373\234\271\064"
	"\067\351\043\106\115\250\142\340\107\146\023\037\100\067\350\165"
	"\205\304\371\161\213\250\300\130\242\247\367\062\173\240\076\265"
	"\310\024\110\157\142\002\275\173\151\275\342\027\162\052\312\004"
	"\271\222\113\373\034\145\224\377\111\017\364\265\013\151\100\261"
	"\166\272\136\055\062\266\332\242\311\136\176\350\245\342\047\355"
	"\243\273\333\357\232\354\226\255\113\072\163\276\251\102\102\114"
	"\336\151\150\010\320\314\042\271\311\042\267\031\307\117\232\022"
	"\373\144\277\265\026\030\220\315\056\204\204\242\015\277\363\133"
	"\356\053\241\335\021\260\311\367\056\244\312\375\255\272\246\145"
	"\011\013\103\253\166\222\204\137\174\306\104\266\041\104\346\342"
	"\032\140\304\155\336\135\161\031\321\212\202\036\170\062\062\356"
	"\045\076\075\223\346\306\246\250\076\273\052\137\067\074\320\052"
	"\171\057\253\042\320\330\317\353\232\252\063\206\334\162\233\036"
	"\127\246\113\320\333\200\227\251\222\313\061\055\166\372\141\200"
	"\251\227\134\304\325\161\161\220\334\035\301\070\327\104\045\121"
	"\020\330\331\216\105\175\206\174\240\362\365\011\146\257\015\024"
	"\360\152\001\135\161\023\217\015\204\102\153\267\327\155\172\105"
	"\307\125\150\221\003\155\201\321\045\055\273\002\143\325\222\136"
	"\155\234\254\014\376\231\334\354\376\247\343\223\076\062\132\203"
	"\205\142\304\225\272\204\252\320\266\035\142\000\350\152\300\047"
	"\211\136\135\101\124\146\072\175\125\054\321\140\143\275\367\201"
	"\360\035\355\130\215\257\022\167\223\160\034\323\026\150\146\201"
	"\061\144\010\373\257\122\335\371\370\017\300\111\272\262\030\001"
	"\060\065\362\020\315\312\147\273\321\243\302\273\302\044\355\003"
	"\347\123\125\001\330\311\037\116\143\007\154\216\065\162\231\355"
	"\225\347\302\014\044\314\030\331\160\267\314\046\114\166\376\053"
	"\211\324\242\176\047\345\167\046\003\316\037\234\035\133\210\212"
	"\003\040\017\203\152\036\071\014\316\175\122\266\375\032\044\377"
	"\126\212\252\015\220\167\302\101\303\272\023\072\263\037\370\153"
	"\047\302\035\061\142\371\327\177\263\372\004\211\374\345\075\125"
	"\376\142\127\210\011\124\012\051\105\337\132\217\132\211\206\334"
	"\354\315\020\362\257\156\045\126\202\175\134\035\106\165\130\350"
	"\163\304\052\026\323\367\225\043\107\320\072\340\261\175\032\056"
	"\227\217\313\174\345\022\152\052\071\121\160\077\105\164\061\156"
	"\074\310\353\331\305\236\204\263\362\167\065\350\257\321\167\361"
	"\325\224\206\153\322\256\116\340\113\170\020\036\015\216\236\226"
	"\311\254\310\363\316\102\077\225\346\065\140\124\006\262\262\041"
	"\251\346\347\242\051\327\371\315\377\071\043\332\224\072\125\233"
	"\160\305\150\264\313\105\341\162\365\375\353\267\210\312\002\076"
	"\367\372\153\130\002\370\051\374\334\135\307\363\224\127\100\130"
	"\323\333\224\034\003\370\110\307\212\001\163\052\225\206\336\064"
	"\204\161\365\302\231\245\376\044\130\321\062\033\005\303\330\014"
	"\325\240\134\070\172\257\273\177\261\031\214\010\216\216\132\032"
	"\233\163\051\243\231\372\267\251\163\361\167\130\024\236\045\350"
	"\233\051\060\234\157\143\346\217\105\017\175\031\056\365\073\336"
	"\361\154\065\064\370\104\061\310\355\234\320\160\341\124\147\043"
	"\370\207\366\103\324\353\055\006\072\014\306\231\006\250\055\173"
	"\151\141\012\331\206\104\336\377\230\046\200\041\165\247\074\060"
	"\130\376\000\011\247\270\311\137\013\232\021\220\262\270\221\024"
	"\042\230\306\260\224\256\251\273\075\333\100\140\053\255\327\325"
	"\346\323\350\111\354\335\005\303\075\357\237\021\152\050\020\245"
	"\300\351\075\026\106\047\207\054\340\030\122\212\152\006\302\122"
	"\056\042\175\150\267\304\214\073\213\366\263\100\275\042\012\140"
	"\131\141\231\033\001\304\101\326\151\360\240\362\121\102\213\251"
	"\114\136\244\101\251\153\323\045\370\113\355\002\026\206\044\316"
	"\351\031\022\330\245\060\273\340\373\110\124\345\070\126\017\003"
	"\272\125\030\146\267\302\033\176\301\113\172\345\227\245\013\041"
	"\201\225\120\217\354\026\123\311\053\155\310\032\054\151\025\211"
	"\003\076\247\034\241\234\174\045\063\377\326\204\302\045\056\336"
	"\051\076\360\204\302\050\136\012\201\045\101\126\335\020\223\131"
	"\276\376\357\022\242\254\070\072\203\205\125\322\300\221\077\066"
	"\261\064\104\054\032\133\346\124\202\026\232\272\310\235\103\343"
	"\020\126\361\330\213\363\230\342\327\067\321\063\203\362\173\135"
	"\265\353\246\164\350\227\263\104\270\325\027\342\337\103\303\100"
	"\251\356\153\346\307\113\060\246\217\214\151\033\153\120\134\350"
	"\147\066\035\257\006\157\264\111\222\036\236\333\123\217\206\323"
	"\240\242\116\144\172\237\040\214\344\261\272\135\105\204\347\365"
	"\332\352\011\315\066\141\104\164\247\110\373\341\015\026\012\152"
	"\342\201\371\255\221\032\076\006\030\206\016\311\007\273\161\033"
	"\104\351\204\240\044\356\077\355\240\306\337\117\367\027\312\017"
	"\211\066\174\131\023\341\234\154\055\034\302\210\251\230\311\252"
	"\361\016\114\256\073\233\207\205\156\062\350\366\163\244\301\224"
	"\020\242\125\114\202\365\012\150\106\321\311\027\245\201\377\155"
	"\275\216\243\344\145\143\304\007\000\020\337\316\246\110\071\265"
	"\236\222\027\313\340\177\050\151\153\203\303\355\012\102\041\265"
	"\222\134\152\032\155\361\317\317\324\107\142\377\243\173\322\007"
	"\371\112\170\215\213\143\263\246\255\117\032\044\102\333\321\142"
	"\334\135\117\165\067\004\171\113\026\032\313\372\151\352\347\214"
	"\246\234\313\260\233\123\311\046\124\150\354\027\341\330\255\323"
	"\377\305\367\003\131\215\024\231\000\202\323\252\303\341\075\270"
	"\140\361\201\376\025\334\261\335\322\104\355\071\104\150\172\305"
	"\027\301\256\346\347\250\177\171\330\147\204\215\060\270\071\073"
	"\260\075\210\176\370\172\265\064\250\115\230\212\067\315\372\203"
	"\044\333\270\367\200\352\142\235\012\374\261\060\001\213\055\352"
	"\131\270\226\333\326\300\255\117\072\336\370\146\010\257\020\026"
	"\031\257\172\162\012\143\030\306\317\375\332\066\354\105\165\211"
	"\364\270\146\015\212\367\307\136\265\215\111\116\204\074\232\155"
	"\306\242\042\365\201\006\333\377\202\247\076\071\363\364\021\366"
	"\127\250\251\133\252\037\354\241\331\100\105\334\030\361\322\330"
	"\240\367\137\046\236\046\042\000\177\172\266\173\005\064\057\046"
	"\027\066\104\210\002\371\362\030\364\207\267\330\277\374\007\134"
	"\310\371\353\331\246\230\347\001\135\035\274\273\253\242\074\124"
	"\355\161\047\337\140\060\004\031\274\161\312\353\067\107\373\316"
	"\172\122\060\202\117\227\024\334\033\104\307\270\170\222\044\137"
	"\304\170\364\074\331\137\172\206\377\357\251\221\263\374\026\145"
	"\170\256\076\220\330\124\110\360\332\057\335\122\120\327\266\251"
	"\275\116\102\161\175\347\011\023\113\074\177\316\041\065\335\142"
	"\241\235\071\324\155\300\230\074\203\026\101\153\103\250\173\366"
	"\106\144\254\252\327\141\360\015\111\321\261\152\165\122\257\105"
	"\332\315\135\223\250\376\254\310\346\002\026\000\267\370\005\361"
	"\126\314\157\267\107\324\356\201\253\031\333\057\255\255\015\113"
	"\147\124\131\177\136\012\044\041\377\032\141\300\051\011\120\155"
	"\363\341\362\226\114\163\246\003\126\311\042\302\130\210\042\352"
	"\252\131\314\041\121\035\305\002\064\044\061\333\307\043\311\366"
	"\313\347\347\260\375\067\007\001\353\141\206\127\224\040\165\352"
	"\365\117\230\060\056\062\013\147\266\033\245\124\302\312\220\255"
	"\374\126\176\305\253\305\244\374\233\052\377\330\014\071\101\037"
	"\061\227\215\044\065\304\251\271\114\277\320\214\113\046\136\047"
	"\106\334\053\341\105\326\365\167\334\376\114\350\047\210\166\104"
	"\043\035\242\113\246\241\357\013\012\040\274\045\067\133\072\345"
	"\263\336\111\146\377\260\254\145\342\244\313\305\027\151\060\244"
	"\115\204\167\110\011\363\116\226\006\321\274\214\167\270\365\376"
	"\112\055\227\303\263\043\004\317\277\245\020\001\067\020\227\105"
	"\176\047\137\154\274\257\304\350\206\030\245\136\114\312\302\154"
	"\001\313\025\223\173\125\006\135\011\225\376\255\133\352\366\131"
	"\144\001\164\031\210\061\143\152\215\341\066\216\114\370\236\337"
	"\051\113\326\224\222\055\362\127\253\153\202\012\104\340\314\221"
	"\326\240\110\342\334\207\262\060\323\241\126\135\246\106\220\165"
	"\240\324\371\057\256\245\020\120\312\353\323\262\015\237\103\344"
	"\100\213\306\034\022\171\115\346\032\243\104\301\352\324\067\212"
	"\250\060\272\127\325\312\247\240\265\173\123\303\033\226\247\133"
	"\042\156\170\065\347\305\033\002\151\137\303\123\064\372\336\335"
	"\053\230\064\001\143\334\242\030\127\365\334\163\213\203\317\256"
	"\361\107\343\331\015\377\333\167\137\237\313\223\232\251\160\305"
	"\102\245\307\245\202\151\276\331\136\232\115\352\036\034\230\017"
	"\144\174\350\161\173\304\350\332\143\263\156\376\135\337\304\237"
	"\204\213\105\006\365\003\340\124\236\055\076\274\112\327\314\256"
	"\123\264\037\317\171\010\251\335\274\030\333\031\367\237\271\174"
	"\053\377\203\040\003\143\164\241\221\263\136\333\213\052\211\337"
	"\337\251\256\130\261\130\066\156\160\021\210\150\261\102\344\334"
	"\101\147\374\104\313\161\346\135\044\104\071\257\156\303\216\116"
	"\154\075\246\036\225\334\214\006\356\024\156\237\126\123\174\230"
	"\273\170\334\206\351\303\344\016\007\035\275\166\340\114\304\115"
	"\211\153\153\037\110\370\045\067\014\224\326\143\347\123\373\242"
	"\313\330\051\265\233\016\304\242\053\202\031\014\316\336\131\130"
	"\112\305\170\222\275\235\312\312\062\241\055\031\364\051\274\300"
	"\001\346\166\234\364\072\077\040\274\130\054\213\066\206\344\201"
	"\114\134\024\011\372\336\324\055\177\001\106\163\052\003\063\053"
	"\351\252\310\335\344\007\376\241\137\052\055\226\261\021\027\375"
	"\156\053\007\151\012\333\226\211\335\335\375\007\340\061\063\312"
	"\333\373\250\300\002\246\141\142\320\216\371\202\240\021\177\016"
	"\075\207\167\107\142\015\321\077\352\316\107\313\377\173\225\333"
	"\167\075\233\172\343\374\335\264\213\326\066\053\347\266\071\044"
	"\075\261\154\240\277\075\340\251\013\050\165\013\243\012\346\033"
	"\110\202\225\053\176\162\340\011\111\026\064\060\315\156\125\012"
	"\037\301\253\336\377\213\210\012\264\376\026\127\011\375\163\121"
	"\177\010\175\375\173\135\007\304\163\074\365\100\253\113\113\313"
	"\015\366\252\014\202\063\027\066\061\055\216\072\052\001\214\251"
	"\012\011\247\205\146\257\112\332\353"
#define      shll_z	10
#define      shll	((&data[7729]))
	"\164\110\026\126\140\355\063\130\361\025\213"
#define      tst1_z	22
#define      tst1	((&data[7742]))
	"\136\014\357\207\027\333\113\252\133\225\136\075\214\057\201\027"
	"\303\303\243\267\106\207\011\050\244\340\077"
#define      opts_z	1
#define      opts	((&data[7767]))
	"\060"
#define      msg1_z	65
#define      msg1	((&data[7779]))
	"\023\247\066\275\261\100\144\067\246\023\202\335\201\031\204\035"
	"\371\166\153\007\170\370\263\341\124\204\324\256\035\310\372\235"
	"\071\243\366\246\240\141\212\070\366\075\043\215\150\336\001\276"
	"\115\120\227\124\252\154\011\010\371\064\345\152\202\174\310\350"
	"\030\244\012\301\052\142\262\201\330\307\135\217\201\377\302\234"
	"\226\115\004\370\346\142\004"
#define      chk1_z	22
#define      chk1	((&data[7856]))
	"\106\115\323\203\012\326\355\375\110\335\230\302\354\271\213\351"
	"\250\000\037\021\050\264\361\132"
#define      rlax_z	1
#define      rlax	((&data[7879]))
	"\237"
#define      msg2_z	19
#define      msg2	((&data[7881]))
	"\225\217\320\205\105\172\037\063\237\031\346\074\124\214\143\054"
	"\107\161\164\306\000\132\326"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
