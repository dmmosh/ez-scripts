#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f git-all.sh -o git-all 
#endif

static  char data [] = 
#define      tst2_z	19
#define      tst2	((&data[2]))
	"\106\260\162\170\112\265\347\003\201\143\034\260\245\276\151\216"
	"\004\330\261\202\206"
#define      chk1_z	22
#define      chk1	((&data[21]))
	"\015\142\000\342\156\214\312\314\240\260\274\223\270\034\152\202"
	"\050\217\145\074\276\355\060\344\117\054"
#define      chk2_z	19
#define      chk2	((&data[50]))
	"\041\144\245\137\306\371\327\367\025\202\212\017\355\302\253\046"
	"\317\051\113\111\017\362\242\053"
#define      tst1_z	22
#define      tst1	((&data[76]))
	"\342\305\167\022\313\142\165\161\010\100\215\164\121\341\311\203"
	"\142\374\343\252\144\225\131\121\101\107\152\254"
#define      pswd_z	256
#define      pswd	((&data[105]))
	"\146\044\322\026\263\366\226\344\166\202\024\202\317\005\111\103"
	"\056\342\210\245\350\345\112\327\200\317\022\040\167\376\003\002"
	"\071\174\116\155\212\344\121\001\146\146\203\066\154\315\171\232"
	"\260\002\077\230\347\212\157\150\131\202\210\321\200\213\323\272"
	"\010\041\050\223\005\172\224\154\340\030\242\115\345\034\347\225"
	"\036\047\055\006\262\235\156\013\037\367\335\240\202\260\133\213"
	"\322\203\036\330\375\263\104\336\313\347\054\260\004\024\106\043"
	"\073\164\051\355\021\230\371\060\217\327\320\022\210\053\236\132"
	"\257\274\062\255\157\167\214\073\136\270\354\143\314\062\206\010"
	"\246\260\366\267\110\357\350\330\307\271\353\117\345\211\251\224"
	"\106\334\101\266\123\315\361\262\205\335\025\122\017\233\132\266"
	"\113\120\156\224\100\126\155\007\017\131\126\364\343\000\211\051"
	"\334\312\340\060\230\321\342\036\256\370\160\276\223\313\164\337"
	"\033\343\164\133\071\342\142\111\073\271\076\037\271\307\111\226"
	"\222\051\306\052\372\251\111\251\241\272\150\065\205\335\025\240"
	"\300\211\374\371\154\137\103\250\031\201\307\323\110\020\151\332"
	"\072\060\005\065\331\117\333\343\332\053\020\270\346\235\331\112"
	"\102\174\166\273\147\263\235\055\052\257\370\326\233\022\142\001"
	"\066\064\030\352\052\363\316\004\037"
#define      msg1_z	65
#define      msg1	((&data[408]))
	"\174\226\120\277\023\307\172\172\172\030\247\245\166\037\034\321"
	"\127\037\121\322\074\072\237\246\323\245\331\102\212\142\156\072"
	"\312\053\111\263\242\136\313\167\005\324\300\342\250\315\120\332"
	"\073\150\177\252\047\251\243\206\232\156\136\056\112\304\026\263"
	"\177\022\021\177\136\070\016\173\004\373\014\046\033"
#define      opts_z	1
#define      opts	((&data[473]))
	"\263"
#define      xecc_z	15
#define      xecc	((&data[476]))
	"\144\351\137\262\137\170\102\005\023\114\101\067\060\137\322\272"
	"\344\022\174\324"
#define      shll_z	10
#define      shll	((&data[495]))
	"\101\141\162\261\062\301\160\162\313\050\056\217"
#define      msg2_z	19
#define      msg2	((&data[510]))
	"\376\225\346\275\124\121\032\054\066\167\133\171\133\137\225\120"
	"\306\062\012\116\123\230\240\250\256"
#define      inlo_z	3
#define      inlo	((&data[531]))
	"\246\365\347"
#define      lsto_z	1
#define      lsto	((&data[534]))
	"\067"
#define      date_z	1
#define      date	((&data[535]))
	"\116"
#define      rlax_z	1
#define      rlax	((&data[536]))
	"\320"
#define      text_z	6146
#define      text	((&data[575]))
	"\134\332\167\314\175\271\134\376\267\361\375\114\330\272\365\206"
	"\362\027\257\103\342\176\133\114\310\325\151\361\265\160\054\021"
	"\112\244\335\307\136\072\106\341\363\171\344\053\260\107\130\300"
	"\323\262\266\055\177\242\055\325\263\271\167\030\004\101\232\267"
	"\123\054\120\116\354\311\360\252\332\363\264\255\163\112\145\050"
	"\336\017\016\261\125\314\032\265\010\313\333\007\374\336\244\377"
	"\253\137\220\315\077\034\025\375\204\262\367\267\157\354\265\310"
	"\026\242\321\153\302\130\343\102\314\333\215\204\314\064\142\136"
	"\342\212\221\070\314\045\057\134\360\261\037\126\341\331\376\000"
	"\125\074\344\076\212\363\321\122\160\053\151\356\250\202\303\133"
	"\137\026\327\277\172\126\231\305\003\015\141\247\350\207\303\342"
	"\077\343\057\236\375\227\037\314\253\001\071\143\054\226\346\207"
	"\275\263\341\212\225\014\241\005\366\325\147\266\303\175\273\026"
	"\204\066\376\342\272\130\155\134\106\151\167\040\300\121\224\074"
	"\231\245\070\347\167\100\077\063\137\161\275\347\173\175\277\101"
	"\227\255\170\012\325\355\314\352\212\344\024\247\173\011\361\172"
	"\116\112\040\165\222\026\064\204\001\215\171\327\321\057\246\333"
	"\274\205\034\250\301\323\003\257\341\063\375\371\166\144\311\270"
	"\365\146\136\065\171\276\266\362\326\302\107\210\206\346\000\350"
	"\070\312\263\100\357\327\177\125\370\275\137\075\263\303\330\146"
	"\337\177\120\363\224\122\127\057\370\033\101\147\157\144\274\310"
	"\064\372\110\265\013\111\326\121\135\344\256\152\165\173\255\225"
	"\262\025\237\020\005\200\075\116\327\165\176\350\362\360\216\173"
	"\111\017\217\207\306\362\261\115\253\120\005\375\060\377\237\165"
	"\153\251\064\246\121\260\304\044\025\202\236\131\316\106\326\203"
	"\307\264\311\122\322\231\246\312\142\113\335\024\240\156\354\232"
	"\273\335\040\332\365\303\224\175\143\273\211\145\044\271\176\322"
	"\255\120\367\100\310\254\007\315\054\260\232\215\157\256\127\305"
	"\270\363\065\335\304\115\147\150\254\107\341\215\227\276\131\235"
	"\021\133\112\340\262\177\274\356\203\101\203\013\147\333\273\103"
	"\275\243\062\021\312\103\354\324\300\254\206\356\175\132\224\114"
	"\334\012\071\223\305\335\345\160\132\112\334\240\070\306\262\100"
	"\256\156\136\363\312\111\047\176\002\065\104\365\347\346\151\020"
	"\131\070\360\325\112\365\330\204\105\242\341\142\036\256\106\266"
	"\354\304\373\374\137\145\106\001\312\370\020\104\265\362\033\230"
	"\376\063\220\113\064\034\170\207\170\330\332\210\212\355\100\202"
	"\305\032\002\043\177\024\127\206\016\172\116\372\260\100\137\152"
	"\036\304\065\350\257\212\007\177\233\331\036\215\240\375\271\143"
	"\353\164\315\100\131\254\035\350\122\234\021\333\262\000\200\045"
	"\215\334\340\176\075\165\071\247\235\242\111\163\157\014\233\157"
	"\176\031\105\171\227\151\152\360\204\337\150\010\357\000\220\154"
	"\003\007\040\366\024\213\107\163\247\371\012\056\135\255\333\024"
	"\274\177\126\273\260\361\006\201\347\151\207\345\322\171\132\001"
	"\266\011\060\121\015\236\272\323\302\200\321\361\231\341\006\010"
	"\367\174\210\312\015\344\236\346\105\114\273\014\234\104\264\274"
	"\016\244\305\217\014\247\154\012\061\101\332\237\010\020\345\334"
	"\372\267\052\273\271\002\056\374\356\350\304\130\052\206\344\024"
	"\041\215\135\276\256\126\257\370\203\335\067\000\242\302\371\274"
	"\261\254\047\105\270\110\257\254\325\352\355\374\373\325\173\127"
	"\147\267\103\203\052\074\242\315\366\232\270\103\143\334\360\042"
	"\176\167\233\373\145\043\300\111\112\215\352\365\152\140\263\166"
	"\225\001\032\125\107\035\153\244\116\253\135\000\331\002\015\173"
	"\350\015\202\065\136\163\345\100\350\366\307\066\142\174\303\205"
	"\266\225\055\111\342\027\060\021\314\240\062\216\316\335\005\360"
	"\016\114\050\372\205\340\145\354\315\065\241\377\266\122\177\133"
	"\310\271\375\364\337\314\116\074\371\016\247\316\173\104\036\013"
	"\057\117\225\362\211\022\064\203\273\170\253\300\343\142\062\137"
	"\012\304\145\260\001\356\344\157\047\154\224\064\316\364\100\136"
	"\054\171\315\151\057\132\226\335\173\234\143\137\023\327\170\162"
	"\064\053\162\161\136\332\131\077\355\276\300\013\102\344\257\363"
	"\113\056\167\272\041\300\020\121\145\112\236\137\226\017\350\243"
	"\055\076\113\045\034\346\105\070\230\002\337\161\136\324\201\066"
	"\312\350\032\106\175\203\314\165\075\330\255\252\163\241\126\006"
	"\203\223\361\162\363\177\205\353\001\105\312\224\301\310\270\150"
	"\246\256\020\033\126\130\012\053\126\054\327\160\056\200\135\254"
	"\200\252\205\166\256\275\031\212\151\305\301\302\327\235\211\231"
	"\310\272\101\350\116\276\123\237\374\264\111\307\216\014\113\355"
	"\222\302\076\151\023\340\256\121\260\072\225\171\157\252\076\057"
	"\356\300\171\156\276\331\326\104\274\276\214\211\175\064\171\316"
	"\077\222\105\046\243\335\123\060\000\036\373\156\113\203\155\042"
	"\073\103\372\011\141\166\247\222\061\255\307\206\164\166\243\231"
	"\044\132\110\057\063\075\022\160\206\127\345\375\227\177\210\037"
	"\371\372\037\062\154\241\102\020\341\147\067\140\251\127\011\152"
	"\003\042\031\235\314\354\321\302\237\036\235\043\077\257\020\251"
	"\062\010\130\050\306\143\166\357\235\237\160\235\260\163\205\114"
	"\145\333\017\000\042\251\014\174\104\165\120\307\163\133\231\242"
	"\063\302\162\114\103\004\150\025\013\105\221\052\261\273\253\015"
	"\166\116\337\224\167\223\361\272\076\265\246\265\014\153\111\230"
	"\150\036\142\147\201\216\146\050\344\266\345\115\101\100\110\352"
	"\312\317\226\023\274\045\045\372\317\226\237\120\276\337\361\327"
	"\051\204\047\267\114\263\112\015\061\206\333\126\047\113\307\116"
	"\047\222\274\043\316\072\042\355\360\023\275\053\076\333\340\117"
	"\143\304\323\354\157\121\050\107\235\016\373\043\310\221\242\236"
	"\251\246\361\003\102\313\046\334\237\324\233\344\024\175\166\060"
	"\015\273\361\203\255\171\017\263\251\225\325\355\002\333\016\123"
	"\170\340\264\355\017\035\364\341\077\137\073\166\266\124\026\060"
	"\213\024\170\271\205\021\231\354\107\220\337\000\005\320\076\233"
	"\265\341\116\037\100\311\235\103\321\164\163\100\035\170\256\332"
	"\170\240\230\167\072\333\247\114\232\023\227\214\264\144\050\304"
	"\131\307\057\201\126\053\134\075\005\026\356\045\065\073\140\206"
	"\265\235\321\001\106\045\127\157\102\042\334\312\000\320\273\076"
	"\333\233\007\230\161\275\147\232\051\111\235\044\253\135\045\034"
	"\136\210\263\222\015\376\310\073\042\142\325\337\305\167\307\175"
	"\025\013\033\227\021\006\177\331\020\356\365\305\323\276\206\154"
	"\355\055\041\002\131\126\032\100\144\120\233\136\345\336\317\376"
	"\170\366\012\124\357\166\075\261\231\133\117\272\164\111\317\065"
	"\307\203\077\344\234\161\237\076\167\014\336\247\235\065\364\143"
	"\070\366\147\312\173\020\134\106\351\270\166\062\051\106\163\220"
	"\143\160\361\204\175\373\155\120\016\334\054\305\040\334\115\317"
	"\232\320\203\343\242\243\360\133\206\223\332\226\215\025\252\035"
	"\166\175\335\277\027\023\363\062\015\177\234\026\221\370\326\145"
	"\372\155\270\135\076\136\205\052\223\357\045\211\302\010\373\203"
	"\351\112\240\273\263\216\165\105\157\040\051\000\014\137\231\375"
	"\105\157\312\143\250\173\353\075\072\343\314\026\140\244\336\372"
	"\074\254\157\004\026\232\206\356\103\034\307\040\003\150\041\210"
	"\227\365\022\242\075\043\345\051\106\037\141\347\245\057\021\160"
	"\135\310\310\351\016\376\336\275\351\021\036\157\254\203\153\041"
	"\145\347\357\100\054\220\045\115\056\240\370\320\374\162\173\126"
	"\162\145\242\213\121\073\034\064\030\342\315\205\215\333\342\253"
	"\322\107\316\065\373\305\133\132\111\237\144\240\340\042\051\321"
	"\271\336\346\342\100\304\170\204\234\242\376\220\207\114\342\325"
	"\370\322\332\354\107\347\135\213\354\213\156\165\104\203\172\105"
	"\107\242\051\113\150\350\006\057\105\034\302\144\066\017\321\317"
	"\011\206\141\371\247\133\335\176\203\026\201\223\204\077\146\300"
	"\145\224\230\016\342\356\001\250\237\205\160\000\060\310\376\255"
	"\162\333\207\334\276\047\262\047\375\273\220\130\077\240\040\137"
	"\126\310\265\232\133\342\074\225\246\126\215\057\271\272\341\333"
	"\362\144\066\063\074\123\346\077\057\256\260\007\015\077\330\255"
	"\030\214\124\016\202\125\011\126\327\011\275\132\143\360\332\017"
	"\063\343\016\232\004\026\366\354\226\257\340\302\351\357\116\107"
	"\220\140\062\226\110\333\305\315\032\132\255\201\352\164\346\352"
	"\364\172\366\321\176\345\164\144\316\333\217\030\366\124\202\214"
	"\034\173\203\275\220\136\111\357\245\016\123\062\327\121\012\245"
	"\071\327\320\115\131\256\171\300\257\312\032\304\056\352\022\122"
	"\154\027\257\373\116\203\015\344\340\163\336\064\350\027\245\226"
	"\237\214\375\204\370\356\236\145\270\072\004\100\040\366\116\204"
	"\164\161\131\106\034\307\002\040\063\106\027\233\155\165\142\236"
	"\171\341\013\071\041\063\332\144\013\236\261\376\330\157\367\301"
	"\135\101\027\021\343\065\202\266\326\375\037\131\107\007\156\153"
	"\306\363\130\310\124\252\076\140\267\354\012\272\330\105\132\326"
	"\271\244\200\056\236\227\315\211\076\327\375\205\277\125\045\074"
	"\225\077\374\001\230\120\021\272\314\001\332\061\354\176\067\317"
	"\325\235\212\167\060\115\255\131\156\105\027\060\120\005\216\135"
	"\210\030\074\176\242\376\363\116\066\116\221\173\105\050\166\312"
	"\121\071\261\054\151\067\313\047\327\306\105\260\100\214\071\052"
	"\102\144\133\222\355\341\303\311\045\275\334\375\202\223\321\354"
	"\113\101\141\014\233\003\377\222\037\272\044\215\016\003\262\027"
	"\206\105\172\267\244\335\165\113\067\340\010\335\171\214\233\147"
	"\253\075\363\254\327\074\316\132\034\374\201\207\247\067\323\375"
	"\155\074\031\307\077\041\372\234\274\320\207\336\172\067\245\317"
	"\067\071\230\304\272\021\345\245\035\235\116\226\121\015\154\174"
	"\056\233\076\106\102\136\010\332\202\264\154\103\001\333\146\264"
	"\266\262\063\345\246\321\157\327\027\362\217\270\045\272\174\363"
	"\310\015\367\351\004\130\061\343\324\241\062\150\014\112\203\252"
	"\256\173\201\142\135\261\371\244\075\065\153\246\243\341\046\374"
	"\177\121\347\101\211\172\344\260\176\122\211\003\271\244\327\270"
	"\331\276\070\034\171\066\277\107\135\222\010\157\311\117\107\044"
	"\241\072\122\235\134\153\177\002\144\122\007\275\303\034\366\156"
	"\341\167\217\371\006\072\227\215\271\241\145\020\137\135\355\140"
	"\174\063\313\116\151\040\270\133\222\262\202\212\256\150\315\342"
	"\113\115\103\364\253\111\273\122\246\207\305\164\043\354\164\105"
	"\374\334\317\120\014\036\004\231\042\256\022\203\241\001\343\231"
	"\146\324\377\055\124\107\324\231\177\314\305\337\365\123\232\221"
	"\321\216\303\361\176\051\002\160\206\230\037\112\057\021\074\275"
	"\045\026\331\051\175\255\206\043\226\135\102\371\224\227\157\301"
	"\005\203\104\156\071\026\062\173\375\265\360\007\346\340\055\034"
	"\356\370\125\130\243\242\374\360\054\251\331\001\252\145\244\173"
	"\376\334\250\010\111\344\176\324\334\144\116\151\252\111\012\055"
	"\274\145\142\031\273\167\005\352\054\034\024\070\255\262\244\320"
	"\302\162\177\274\025\310\155\035\304\262\305\205\044\331\271\305"
	"\365\132\117\013\254\351\020\165\376\266\375\335\213\115\341\377"
	"\257\045\017\213\315\347\132\005\220\006\161\153\016\130\255\360"
	"\267\317\014\130\351\045\314\203\364\307\304\123\220\163\000\366"
	"\372\040\245\231\366\121\061\214\013\301\066\232\362\233\046\367"
	"\231\302\152\147\342\216\032\046\112\055\155\132\110\345\377\000"
	"\266\272\165\374\352\100\263\041\161\126\305\110\234\110\254\225"
	"\167\067\056\202\354\315\266\332\340\211\103\177\371\214\262\044"
	"\070\135\326\153\240\006\334\321\362\137\203\253\161\363\302\043"
	"\211\170\253\241\374\374\325\071\270\055\232\324\027\222\330\351"
	"\007\226\167\121\351\122\203\107\303\055\050\275\162\172\127\360"
	"\264\101\231\244\036\157\321\016\332\115\036\304\011\135\336\356"
	"\125\010\261\223\172\130\252\124\132\012\241\125\023\122\041\065"
	"\261\066\077\124\275\303\257\330\373\160\367\321\151\065\212\117"
	"\340\151\203\361\101\012\006\274\351\206\245\217\007\153\075\113"
	"\161\023\124\064\204\372\000\166\040\056\036\303\336\161\334\263"
	"\100\350\053\320\175\052\127\170\021\340\370\161\233\174\276\013"
	"\137\043\076\233\006\027\072\062\266\170\217\034\035\132\364\101"
	"\271\050\017\363\051\215\007\376\265\001\220\235\056\022\357\070"
	"\167\221\255\133\302\102\101\242\037\150\154\167\105\012\123\350"
	"\070\275\340\032\165\235\161\314\202\065\136\112\212\147\123\074"
	"\227\154\064\070\347\373\320\221\367\224\124\170\120\077\230\247"
	"\262\213\253\375\104\161\164\316\314\135\217\374\315\226\063\007"
	"\105\274\275\203\262\023\212\315\066\036\131\067\227\377\131\253"
	"\011\230\170\026\107\350\002\023\145\231\255\131\120\237\213\311"
	"\100\302\112\316\261\056\322\155\210\364\117\026\347\010\275\234"
	"\014\314\302\360\154\154\343\062\216\327\026\052\343\146\111\012"
	"\125\332\135\122\144\331\311\045\351\024\225\006\261\142\261\155"
	"\014\010\223\232\077\162\252\142\156\361\376\163\315\235\334\127"
	"\346\016\335\102\205\022\053\075\307\150\020\111\124\276\112\205"
	"\000\051\062\221\023\232\276\235\314\260\204\200\233\100\366\213"
	"\050\374\151\022\056\354\076\130\063\055\257\376\305\064\377\103"
	"\072\111\234\364\366\065\026\315\045\065\246\307\363\067\145\113"
	"\026\054\113\036\331\110\375\217\034\240\361\340\306\012\347\062"
	"\037\064\216\332\256\257\314\072\237\127\222\125\235\253\053\136"
	"\132\047\245\375\162\151\330\171\130\327\240\075\072\272\266\226"
	"\366\251\157\071\066\074\216\053\365\251\202\375\374\260\205\144"
	"\203\215\013\017\141\047\171\301\215\225\343\130\301\351\177\352"
	"\060\023\003\167\262\342\343\334\331\104\223\276\270\050\143\142"
	"\026\075\307\171\271\206\071\354\061\073\336\352\200\371\047\234"
	"\156\225\016\103\063\113\226\253\110\322\036\211\055\150\263\233"
	"\113\213\176\051\271\155\200\355\241\023\321\011\055\211\207\017"
	"\142\361\102\343\336\030\345\124\233\113\374\060\365\276\252\235"
	"\210\364\221\222\261\262\337\106\017\312\265\277\265\360\032\307"
	"\333\130\037\064\175\070\162\342\256\327\276\277\124\212\355\227"
	"\002\106\156\035\212\050\145\137\110\213\363\235\240\122\025\101"
	"\112\024\123\165\003\103\260\254\020\117\046\103\302\221\327\256"
	"\375\244\151\146\132\061\204\035\050\046\351\334\331\172\027\362"
	"\267\301\371\325\005\134\014\336\156\074\072\131\274\002\112\130"
	"\341\014\124\071\035\243\013\306\225\246\136\012\174\324\314\215"
	"\252\203\372\217\146\017\003\256\065\107\074\070\270\067\237\172"
	"\061\235\031\102\370\070\300\366\315\154\277\356\331\053\337\152"
	"\227\017\252\276\161\305\354\053\260\275\200\232\241\142\000\361"
	"\135\152\350\016\210\333\370\060\034\032\164\260\244\322\207\227"
	"\030\110\230\027\340\322\225\230\031\236\317\053\362\012\044\315"
	"\055\021\307\134\312\307\001\373\256\330\220\243\127\346\070\100"
	"\034\043\051\123\073\232\043\046\166\134\171\041\222\073\220\276"
	"\275\207\072\327\021\311\033\316\176\011\024\003\227\141\257\237"
	"\357\344\076\133\134\146\262\121\041\304\121\027\226\377\013\235"
	"\123\246\316\147\331\134\035\241\020\072\246\120\125\171\142\045"
	"\300\135\020\035\054\263\240\016\311\117\264\232\230\157\342\361"
	"\134\075\356\015\307\140\160\016\055\260\242\000\312\350\260\136"
	"\337\256\102\014\262\350\106\333\354\314\156\304\261\312\353\176"
	"\100\375\124\231\244\133\063\311\313\323\222\276\027\033\120\237"
	"\111\260\163\265\166\227\125\335\157\331\346\360\260\257\372\033"
	"\260\115\121\252\023\371\152\123\001\231\347\315\361\206\110\107"
	"\035\062\074\134\066\270\061\326\371\055\133\306\025\257\377\142"
	"\272\275\355\014\276\272\256\333\072\253\216\154\243\306\306\275"
	"\123\042\265\206\156\347\367\131\136\242\201\014\012\305\315\071"
	"\042\342\014\277\310\314\063\046\335\230\046\231\377\251\303\040"
	"\221\267\355\015\203\207\210\242\135\054\311\355\235\001\363\140"
	"\371\377\042\116\355\002\132\364\051\010\362\273\154\034\365\117"
	"\042\221\207\367\126\120\366\323\062\033\362\354\224\303\363\212"
	"\146\137\037\305\226\131\205\326\254\303\025\311\071\365\166\372"
	"\057\351\364\027\247\277\070\362\014\362\104\340\254\204\217\172"
	"\166\160\002\317\070\167\276\327\357\037\236\337\172\130\037\174"
	"\215\374\301\162\161\074\002\365\154\124\261\375\046\341\140\125"
	"\133\202\040\214\242\307\240\212\246\057\317\276\145\046\026\076"
	"\020\326\073\307\226\166\054\357\306\271\307\065\145\367\354\064"
	"\147\070\303\056\055\213\117\223\104\364\330\201\275\351\326\204"
	"\223\164\245\360\230\135\042\207\015\207\364\012\052\023\051\271"
	"\306\201\155\173\134\121\110\133\344\266\077\274\346\021\054\313"
	"\223\211\156\066\370\361\157\104\310\062\064\027\027\324\255\020"
	"\270\067\230\040\110\126\336\241\122\072\346\313\120\077\276\257"
	"\336\117\041\144\300\372\217\172\163\061\173\315\003\207\155\102"
	"\341\100\347\342\157\257\032\201\040\225\174\123\111\002\002\034"
	"\131\135\205\102\347\021\067\040\361\107\347\133\174\247\303\363"
	"\054\105\360\120\241\223\160\250\172\121\121\240\323\350\213\233"
	"\366\251\155\310\375\327\101\302\051\133\025\217\334\036\300\070"
	"\045\020\245\345\341\073\365\345\175\374\211\345\365\205\261\016"
	"\144\020\147\255\356\303\041\016\031\377\366\274\366\162\334\075"
	"\270\362\167\176\063\372\244\364\301\103\076\221\215\337\277\126"
	"\043\046\130\310\321\320\007\104\320\027\171\336\305\235\067\217"
	"\357\162\246\116\143\006\313\157\322\051\202\151\175\133\130\206"
	"\264\064\314\353\240\054\170\121\050\011\077\313\166\077\000\376"
	"\177\133\142\235\301\025\151\163\160\142\146\225\264\105\363\115"
	"\051\131\133\030\323\250\033\254\002\013\004\345\363\130\315\240"
	"\236\076\157\001\241\031\374\343\223\065\146\266\222\236\130\143"
	"\225\142\344\256\143\014\265\167\343\117\340\135\027\040\034\321"
	"\051\320\235\124\011\066\016\341\355\047\351\236\054\332\247\237"
	"\024\351\136\127\312\045\011\210\024\121\231\125\376\201\037\346"
	"\331\211\346\074\243\022\326\315\332\261\171\146\106\136\162\270"
	"\157\170\051\353\035\104\160\070\363\163\257\143\013\111\036\044"
	"\236\215\010\254\301\214\325\142\036\376\247\025\255\361\354\231"
	"\206\114\166\273\016\374\033\041\362\256\316\222\324\043\303\327"
	"\072\064\052\175\335\343\031\120\214\034\123\260\344\253\047\303"
	"\066\256\036\321\071\276\356\177\373\346\061\001\133\267\030\172"
	"\056\254\054\232\123\046\025\047\336\276\233\131\275\260\172\005"
	"\043\222\060\375\120\144\347\112\274\056\360\317\025\325\207\213"
	"\147\240\262\011\035\156\007\211\106\340\222\132\244\010\156\004"
	"\044\374\322\160\244\364\004\244\160\173\163\361\313\157\354\060"
	"\163\130\111\262\030\221\356\200\162\105\327\242\262\033\320\254"
	"\146\325\210\053\336\045\047\210\274\154\041\353\057\004\060\064"
	"\365\210\016\201\020\370\032\071\270\017\116\201\164\365\166\176"
	"\160\173\205\021\052\312\113\215\235\331\042\061\356\020\337\170"
	"\300\333\200\243\207\052\203\002\250\260\126\202\044\374\031\250"
	"\101\054\274\373\335\165\164\322\316\151\264\272\217\175\046\041"
	"\172\127\340\347\032\255\245\315\037\076\246\254\012\001\257\255"
	"\140\050\017\140\373\071\254\277\231\102\260\161\153\316\026\200"
	"\116\363\154\113\046\355\366\025\176\366\223\071\173\136\007\273"
	"\127\027\357\311\351\013\112\115\331\104\252\117\251\320\366\212"
	"\371\106\044\314\217\374\070\216\113\165\323\206\215\011\023\016"
	"\241\171\076\234\226\035\000\364\175\117\370\342\306\041\152\274"
	"\343\064\140\302\145\317\015\256\166\025\236\202\153\146\071\173"
	"\305\300\206\165\347\351\363\236\224\266\307\243\204\113\027\372"
	"\243\371\202\166\021\230\206\012\214\124\042\125\254\133\200\256"
	"\042\106\117\245\050\205\214\040\046\263\003\165\300\305\277\072"
	"\045\360\045\173\070\075\323\071\243\135\262\274\376\265\023\255"
	"\310\177\121\225\304\063\312\302\051\306\243\133\201\025\235\131"
	"\065\071\215\212\305\217\140\173\053\220\116\030\333\352\325\202"
	"\123\045\271\102\356\350\251\263\016\260\214\161\371\235\261\203"
	"\166\163\046\337\031\373\005\306\244\057\231\265\002\130\332\113"
	"\131\040\017\253\375\045\134\021\343\132\056\224\074\033\301\317"
	"\354\125\017\102\102\011\221\040\347\105\361\352\340\312\213\277"
	"\324\250\070\246\166\304\050\062\072\355\042\267\232\166\047\137"
	"\030\000\273\121\113\037\160\304\032\063\055\324\262\121\310\063"
	"\150\165\204\065\141\344\326\004\021\231\060\155\271\217\233\156"
	"\163\325\112\076\364\371\315\301\100\330\215\362\220\370\027\163"
	"\053\223\241\034\313\032\333\100\035\122\277\371\070\170\253\062"
	"\236\270\303\032\333\325\230\243\164\021\006\132\311\065\337\073"
	"\256\077\122\221\171\033\315\063\177\245\234\121\310\255\374\307"
	"\042\005\236\015\011\216\365\026\103\170\107\344\232\201\051\273"
	"\376\302\172\053\375\357\146\213\041\241\321\074\014\033\364\004"
	"\043\240\030\356\037\134\044\072\355\107\027\020\044\035\077\363"
	"\072\017\065\221\321\346\214\322\156\161\022\201\203\150\040\171"
	"\324\277\333\030\125\310\367\064\133\162\366\224\131\313\160\314"
	"\356\224\041\116\276\025\006\215\216\100\233\364\314\114\132\270"
	"\230\117\371\054\263\225\075\101\112\306\146\044\111\232\151\011"
	"\143\114\330\252\103\011\251\266\376\230\271\266\034\337\312\310"
	"\054\352\272\321\042\112\365\254\367\326\122\130\104\047\300\177"
	"\161\363\013\107\041\213\361\316\307\170\057\342\113\046\177\064"
	"\312\125\065\165\276\361\032\235\171\343\233\034\071\275\127\117"
	"\072\124\075\301\017\251\374\335\105\231\375\123\376\054\345\203"
	"\050\134\265\133\023\336\106\375\201\270\023\046\203\165\274\105"
	"\021\301\133\242\273\366\215\115\141\103\366\233\017\116\241\073"
	"\052\231\106\221\242\051\334\355\176\026\053\321\150\247\345\237"
	"\111\070\301\355\161\133\310\167\147\231\017\067\150\210\024\016"
	"\153\255\117\072\120\111\220\353\235\124\262\046\257\107\277\304"
	"\235\350\042\127\156\212\115\224\073\345\040\173\122\344\172\272"
	"\124\234\042\305\262\032\357\137\154\145\002\216\173\010\122\061"
	"\054\254\167\042\322\111\362\376\055\133\030\124\342\212\266\245"
	"\006\136\315\077\003\032\327\227\365\260\206\122\050\103\154\302"
	"\120\206\063\026\026\154\060\030\320\361\370\217\052\144\232\335"
	"\362\307\165\203\100\262\152\273\161\334\156\373\110\217\365\040"
	"\132\025\006\133\174\054\017\375\242\034\227\354\101\154\071\030"
	"\353\127\130\064\334\127\364\372\312\045\002\255\144\311\105\376"
	"\327\336\230\250\216\117\165\333\307\134\022\265\213\036\107\157"
	"\230\140\325\300\210\244\163\124\147\174\033\346\237\030\342\054"
	"\360\373\276\016\042\052\343\055\365\377\016\355\000\350\014\305"
	"\130\244\240\172\223\310\252\355\207\241\031\012\072\142\060\165"
	"\127\136\015\334\351\273\234\306\321\226\076\215\147\202\123\036"
	"\047\216\201\133\307\263\177\206\054\331\357\170\033\212\065\205"
	"\363\055\251\034\260\322\153\037\111\053\053\364\362\230\074\215"
	"\165\313\015\044\172\162\043\244\004\131\147\064\233\230\332\071"
	"\222\107\014\312\203\314\130\054\244\032\040\232\352\204\200\375"
	"\377\360\275\065\330\140\125\352\310\050\144\304\032\370\333\025"
	"\366\345\260\140\203\062\101\140\307\007\121\041\250\051\116\011"
	"\076\311\357\254\144\144\013\343\326\150\352\057\066\275\103\333"
	"\245\316\200\376\274\227\063\145\222\327\137\041\346\107\176\001"
	"\146\042\164\064\037\177\034\060\174\072\316\300\344\226\030\017"
	"\341\175\077\266\255\011\054\060\266\076\357\007\207\074\262\342"
	"\243\375\334\006\356\062\237\220\343\305\014\313\315\216\255\272"
	"\006\042\073\343\232\310\242\315\274\251\220\003\255\115\124\307"
	"\267\234\041\247\041\172\131\215\002\102\123\006\306\173\043\300"
	"\150\331\025\131\100\215\154\276\147\027\003\303\363\234\037\206"
	"\127\062\134\334\011\215\143\021\230\074\162\332\036\255\162\157"
	"\363\331\202\254\105\306\061\310\037\146\072\053\251\063\204\154"
	"\314\327\103\111\207\254\077\165\214\324\027\003\151\037\356\050"
	"\276\062\104\332\033\017\312\256\174\352\050\126\031\014\354\135"
	"\266\066\337\035\212\167\064\053\002\135\254\325\202\322\266\120"
	"\262\157\271\023\345\030\337\112\316\240\240\150\270\272\353\044"
	"\174\147\172\147\151\115\065\016\134\321\070\175\016\236\057\337"
	"\120\046\010\011\205\242\103\147\217\072\043\000\022\216\121\264"
	"\050\004\347\343\034\263\130\266\227\073\150\156\320\271\027\244"
	"\247\017\315\217\311\064\074\001\325\365\107\132\265\106\161\055"
	"\067\152\104\330\112\052\262\305\355\056\217\307\163\362\170\330"
	"\077\052\355\114\250\371\067\237\037\131\045\120\340\021\246\047"
	"\166\313\074\221\102\010\015\164\071\136\013\017\343\030\350\076"
	"\136\154\000\325\156\323\166\354\067\054\202\044\225\101\175\156"
	"\261\305\075\012\006\147\011\163\241\247\033\056\027\245\016\274"
	"\025\256\127\356\334\245\260\247\051\155\125\231\370\130\103\234"
	"\326\002\024\010\103\030\032\001\062\317\156\043\361\045\206\205"
	"\001\210\053\372\015\112\346\307\265\045\257\233\371\323\315\212"
	"\324\262\223\243\170\015\142\070\175\256\135\034\166\042\030\317"
	"\177\023\101\057\306\217\374\356\004\157\376\164\027\132\323\101"
	"\175\255\356\230\061\077\004\227\143\344\014\373\074\113\130\054"
	"\113\046\356\107\215\117\131\173\015\246\256\314\043\202\127\132"
	"\054\015\006\272\320\236\057\313\147\043\140\316\352\325\205\356"
	"\023\232\343\074\203\067\325\065\043\321\022\167\001\074\301\311"
	"\013\377\056\214\260\346\210\040\355\072\303\105\254\314\216\157"
	"\342\211\304\251\113\142\010\317\372\245\000\174\020\132\222\154"
	"\253\162\164\157\340\076\105\265\014\330\006\224\147\315\316\370"
	"\145\022\233\072\032\135\065\120\355\377\131\322\013\013\110\354"
	"\030\330\077\324\075\317\000\237\234\272\373\255\111\304\253\075"
	"\001\224\107\007\220\020\346\362\205\064\250\357\136\354\067\106"
	"\232\352\106\316\367\310\071\252\364\371\135\067\376\313\321\143"
	"\005\317\073\114\021\327\133\250\353\242\032\014\273\325\033\257"
	"\176\370\354\112\162\134\157\250\006\062\335\014\161\357\205\343"
	"\105\222\246\032\067\253\074\312\066\361\170\253\225\137\002\133"
	"\126\276\377\160\003\354\312\006\061\201\030\110\173\227\275\272"
	"\315\225\344\211\070\146\200\262\346\235\240\232\125\025\231\104"
	"\042\076\167\004\152\263\061\214\133\263\043\377\304\370\120\304"
	"\243\316\235\032\132\030\246\260\251\225\372\166\114\364\052\162"
	"\157\305\244\162\355\026\154\272\375\317\067\242\131\346\200\071"
	"\374\131\205\352\274\237\036\247\135\310\205\307\311\234\173\353"
	"\237\130\325\306\237\000\053\233\124\365\160\121\005\002\027\062"
	"\147\327\075\131\204\147\226\311\170\037\254\367\372\133\336\236"
	"\364\362\147\347\332\013\051\063\306\025\054\303\142\004\176\127"
	"\213\161\157\073\264\121\271\017\236\202\345\010\163\232\170\240"
	"\254\302\105\212\212\244\304\121\271\360\025\034\365\223\164\200"
	"\005\343\273\272\065\165\311\323\367\257\334\153\112\124\013\366"
	"\027\121\200\241\365\105\362\257\065\010\314\052\233\100\253\241"
	"\043\147\133\131\334\045\055\323\324\011\076\036\135\112\025\164"
	"\234\225\026\221\332\011\101\020\021\015\073\255\115\346\116\161"
	"\116\251\312\052\316\367\375\243\000\074\302\136\206\327\322\042"
	"\155\351\264\110\362\366\130\003\003\224\261\121\173\377\303\311"
	"\251\215\363\170\205\361\033\206\055\335\344\263\264\267\326\042"
	"\240\212\152\222\200\302\226\204\127\107\326\322\107\231\233\360"
	"\047\216\151\254\200\204\063\255\142\027\140\027\316\067\071\157"
	"\301\243\002\102\146\231\307\276\340\235\220\050\066\054\031\135"
	"\273\202\012\073\007\075\350\151\125\110\201\044\177\272\223\101"
	"\136\225\204\305\056\113\203\017\351\024\070\037\100\121\175\373"
	"\323\207\066\332\305\036\104\032\147\305\076\347\200\321\051\337"
	"\147\255\245\226\371\051\246\342\075\336\002\176\057\200\171\003"
	"\010\260\335\315\316\041\350\066\347\046\035\147\370\107\106\140"
	"\364\354\367\356\025\235\321\122\173\324\320\253\124\112\256\134"
	"\372\214\052\311\256\022\377\225\071\035\375\062\144\104\222\131"
	"\060\211\107\105\047\031\230\243\355\151\116\102\263\375\237\255"
	"\211\311\166\070\334\166\315\026\223\312\110\367\017\332\121\077"
	"\144\230\205\213\262\035\056\237\206\175\342"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
