#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f /home/wetsock/coding/ez-scripts/git-all/git-all.sh -o /usr/bin/git-all 
#endif

static  char data [] = 
#define      inlo_z	3
#define      inlo	((&data[0]))
	"\330\272\053"
#define      chk1_z	22
#define      chk1	((&data[4]))
	"\350\017\336\254\072\232\350\315\376\114\010\345\100\144\233\373"
	"\364\171\301\044\225\077\023\130"
#define      chk2_z	19
#define      chk2	((&data[27]))
	"\341\215\205\362\222\067\126\341\373\236\155\037\315\035\060\362"
	"\330\207\143"
#define      lsto_z	1
#define      lsto	((&data[46]))
	"\344"
#define      msg2_z	19
#define      msg2	((&data[47]))
	"\136\376\264\107\226\066\270\334\335\364\034\141\126\153\317\211"
	"\145\264\370\062\353\242\151"
#define      pswd_z	256
#define      pswd	((&data[127]))
	"\056\251\237\247\354\163\120\066\260\270\314\376\356\265\126\337"
	"\316\163\115\042\237\350\117\221\033\072\064\204\077\027\321\156"
	"\301\161\025\256\344\146\344\224\036\261\223\015\146\351\354\064"
	"\135\071\127\374\042\246\216\075\340\254\123\116\063\112\104\374"
	"\066\231\254\062\251\116\151\335\201\027\013\073\156\204\044\040"
	"\107\050\227\002\276\160\132\363\034\256\102\120\370\207\115\057"
	"\040\371\141\311\107\313\247\311\343\262\004\121\066\050\162\175"
	"\121\011\177\020\172\332\004\227\210\107\347\201\316\065\260\356"
	"\057\022\270\167\335\137\100\300\021\104\022\107\155\204\305\276"
	"\216\105\317\010\037\323\237\247\032\207\051\350\274\332\327\353"
	"\354\217\143\311\356\243\211\000\350\234\110\125\040\015\024\256"
	"\122\343\267\161\266\126\031\321\336\103\271\233\035\221\207\011"
	"\040\352\322\017\215\134\017\165\370\127\313\031\145\337\310\267"
	"\302\177\051\170\326\103\111\264\206\003\117\244\225\326\255\266"
	"\300\200\305\116\334\325\303\325\055\216\357\222\156\267\111\060"
	"\067\163\251\015\266\363\301\075\367\021\341\214\350\216\102\251"
	"\017\010\367\354\335\273\302\012\112\261\234\270\150\346\350\237"
	"\132\221\255\021\204\157\116\174\200\060\010\151\277\112\022\316"
	"\123\011\272\060\304\174\073\016\056\330\307\226\277\257\066\031"
	"\101\343\052\306\122\170\102\323\250\302\302\037\332\223\216\234"
	"\004\244\112\350\012\057\175\051\340\020\066\107"
#define      msg1_z	65
#define      msg1	((&data[404]))
	"\127\135\361\064\130\216\167\373\322\311\231\337\305\203\046\024"
	"\177\306\300\056\163\330\262\127\211\240\310\116\225\152\000\271"
	"\257\353\277\333\110\123\030\030\302\225\037\345\157\172\136\115"
	"\154\037\065\076\161\251\171\040\110\144\303\344\115\103\040\101"
	"\364\272\117\323\124\200\171\342\276\132\245"
#define      tst1_z	22
#define      tst1	((&data[479]))
	"\024\010\264\174\365\375\313\047\315\302\005\350\141\033\102\373"
	"\332\067\243\021\326\103\334\254\034\030\254"
#define      rlax_z	1
#define      rlax	((&data[504]))
	"\160"
#define      opts_z	1
#define      opts	((&data[505]))
	"\047"
#define      text_z	6277
#define      text	((&data[1386]))
	"\276\211\072\072\341\230\015\066\030\207\031\326\341\277\126\133"
	"\077\152\143\133\203\017\302\205\306\130\004\247\317\223\276\215"
	"\035\370\310\377\220\325\066\250\135\117\177\076\016\326\231\115"
	"\100\374\251\304\014\153\111\323\304\115\172\223\341\070\041\377"
	"\061\352\377\302\300\065\152\035\204\352\133\223\300\364\340\001"
	"\361\211\305\376\365\017\321\271\135\114\115\076\205\157\076\266"
	"\131\075\170\031\162\343\066\367\315\222\212\215\206\153\216\170"
	"\365\124\166\352\143\110\244\300\225\362\377\032\142\075\321\273"
	"\173\111\325\356\055\014\345\373\236\160\210\045\333\027\236\320"
	"\153\024\273\317\135\140\217\362\122\217\015\264\315\336\160\110"
	"\050\106\067\126\122\034\121\361\215\332\026\150\361\265\071\135"
	"\311\365\054\047\126\274\032\250\114\050\135\031\006\316\141\057"
	"\024\231\205\147\265\327\130\103\261\157\254\243\044\346\000\356"
	"\333\055\025\061\352\060\332\066\130\070\117\137\006\261\216\033"
	"\112\024\202\000\353\332\103\235\111\357\100\155\325\100\134\261"
	"\156\161\343\130\242\275\217\372\366\336\131\375\220\350\030\332"
	"\374\233\333\350\165\036\205\277\016\305\055\344\006\211\226\165"
	"\373\171\316\235\067\135\227\055\073\361\053\314\332\103\246\327"
	"\336\202\277\124\241\105\023\257\013\101\224\022\312\052\207\305"
	"\244\125\143\333\262\372\011\356\354\064\272\306\170\141\235\127"
	"\343\135\254\204\242\300\064\256\001\311\300\314\364\107\221\230"
	"\235\364\164\120\357\175\076\334\262\370\243\053\132\100\203\075"
	"\236\060\302\100\360\367\357\362\300\257\276\265\367\120\115\224"
	"\105\301\344\065\077\043\021\362\034\264\036\166\365\242\264\223"
	"\322\167\324\303\156\303\265\057\163\164\344\152\305\061\377\012"
	"\363\344\100\063\007\121\045\043\006\104\232\374\346\116\220\271"
	"\305\145\175\064\050\063\143\234\247\107\006\154\171\006\167\154"
	"\352\267\240\361\011\306\025\020\012\257\014\361\376\235\253\304"
	"\002\050\370\053\133\133\307\002\243\316\157\034\324\347\211\276"
	"\237\051\260\250\357\305\271\372\165\305\353\163\142\226\070\145"
	"\277\060\220\032\214\127\035\057\045\215\114\371\164\325\267\023"
	"\376\147\274\356\055\165\350\242\072\324\026\235\153\116\002\052"
	"\177\223\104\013\352\141\072\017\356\206\010\143\134\300\166\133"
	"\050\062\111\126\247\062\371\342\006\017\200\161\136\203\233\335"
	"\026\340\351\001\101\043\020\060\252\031\223\007\332\012\142\002"
	"\075\253\131\345\336\122\307\344\142\110\126\301\314\362\237\343"
	"\322\210\344\024\254\364\105\127\016\331\136\350\343\300\353\040"
	"\154\104\005\112\226\315\056\371\026\205\272\342\167\131\305\112"
	"\341\251\136\215\236\244\344\254\175\102\224\140\003\177\201\157"
	"\304\206\271\133\124\350\124\152\155\016\115\344\147\022\057\111"
	"\274\215\327\132\061\274\007\257\377\233\017\002\033\220\161\337"
	"\027\052\072\154\022\217\326\177\235\043\144\005\066\223\117\362"
	"\041\046\115\123\342\124\002\341\360\022\343\013\243\125\353\273"
	"\177\046\047\222\265\376\021\123\042\166\131\130\012\250\113\053"
	"\317\231\177\261\355\202\223\335\224\167\351\067\314\324\362\114"
	"\373\031\336\261\030\360\004\072\147\136\223\161\006\336\235\325"
	"\167\035\207\145\237\033\102\063\222\054\152\137\001\135\254\374"
	"\167\213\255\217\173\262\311\342\021\134\124\027\073\362\355\262"
	"\017\165\027\256\220\132\341\043\206\114\203\207\251\057\204\040"
	"\272\062\260\066\345\172\031\366\326\156\015\022\140\373\305\157"
	"\161\335\035\002\067\377\046\276\113\251\106\364\331\312\025\224"
	"\374\306\313\341\100\345\327\026\123\345\051\263\341\356\043\123"
	"\313\100\125\002\100\173\301\213\045\007\200\377\321\226\223\316"
	"\134\137\260\234\104\210\263\227\156\334\113\117\312\156\242\225"
	"\257\370\230\357\163\131\172\230\140\373\230\062\221\053\000\355"
	"\035\370\120\353\177\062\374\204\001\160\132\377\011\005\334\256"
	"\021\217\366\125\270\205\115\234\272\261\115\060\102\243\354\306"
	"\136\311\145\116\077\012\143\120\105\265\002\241\001\177\341\271"
	"\344\172\100\326\373\324\311\036\334\251\302\271\025\311\014\243"
	"\314\373\141\072\267\016\344\253\150\350\024\230\142\307\003\361"
	"\135\220\255\116\201\100\070\330\254\150\354\357\360\067\254\354"
	"\002\340\247\104\023\216\332\101\172\010\037\060\017\154\070\274"
	"\253\032\075\060\210\206\307\303\235\136\320\377\136\351\306\236"
	"\034\151\132\033\065\357\014\030\311\167\346\350\056\305\356\203"
	"\310\212\316\266\075\356\010\123\322\242\035\032\026\340\170\365"
	"\316\134\072\261\012\200\260\306\350\332\273\260\376\137\317\153"
	"\131\315\033\172\253\264\162\036\033\252\270\144\065\046\235\266"
	"\044\303\061\217\263\164\311\107\110\020\100\136\144\361\205\335"
	"\036\334\156\012\173\311\351\151\361\101\216\272\364\160\254\170"
	"\260\212\111\040\333\005\164\143\042\225\336\033\023\256\235\207"
	"\362\136\101\353\121\002\010\151\354\131\140\115\045\052\061\042"
	"\274\064\340\263\157\204\377\152\100\254\216\232\013\115\224\041"
	"\135\174\273\312\154\374\365\253\076\147\303\047\213\175\341\344"
	"\002\170\166\250\001\227\367\355\125\016\033\171\051\032\126\254"
	"\161\010\307\220\351\145\366\240\164\062\164\042\143\017\150\337"
	"\070\273\167\075\270\124\135\021\053\165\225\325\017\054\173\110"
	"\211\202\257\170\273\146\252\250\223\123\077\237\055\312\362\307"
	"\052\204\023\030\203\030\260\143\227\255\272\345\065\340\011\235"
	"\275\276\233\040\253\066\244\227\220\042\167\004\241\243\144\303"
	"\176\253\312\373\302\226\261\257\337\363\002\126\226\146\155\265"
	"\101\170\061\277\170\151\247\250\215\330\335\377\246\374\243\014"
	"\115\023\307\005\140\371\242\004\003\346\122\371\265\143\344\222"
	"\050\006\335\012\134\142\271\022\322\124\331\364\042\112\275\022"
	"\256\365\166\072\124\340\367\065\261\347\301\106\177\135\135\041"
	"\134\042\032\121\036\176\110\110\045\001\075\024\002\126\073\353"
	"\155\272\353\115\066\301\330\255\064\223\150\207\015\325\000\165"
	"\132\003\004\104\223\032\046\327\200\163\324\337\011\357\210\013"
	"\210\220\347\215\325\143\052\377\047\031\070\321\332\170\372\071"
	"\007\015\065\316\342\122\152\123\147\260\265\136\115\234\261\163"
	"\307\045\157\264\346\104\273\050\300\124\055\167\155\225\010\361"
	"\107\310\073\001\152\021\316\046\062\117\252\321\261\013\116\117"
	"\210\312\162\212\117\352\031\256\126\040\225\074\234\330\104\315"
	"\135\021\301\221\140\237\242\007\370\325\217\174\260\306\312\354"
	"\150\154\027\255\046\220\350\226\332\012\354\224\237\225\255\040"
	"\205\120\260\304\015\361\376\133\217\016\254\311\012\156\067\075"
	"\206\215\045\170\313\123\210\070\373\257\225\016\357\200\357\117"
	"\011\017\151\262\230\076\237\021\301\363\330\221\244\145\006\103"
	"\351\067\032\055\110\356\126\376\061\317\314\004\254\001\164\135"
	"\303\234\306\027\354\352\070\356\164\206\162\001\035\212\176\312"
	"\242\210\321\374\230\102\076\052\212\371\164\204\134\107\336\222"
	"\046\370\333\243\101\320\372\360\314\022\106\061\356\242\123\205"
	"\122\160\227\102\014\163\104\301\360\150\251\000\024\237\311\022"
	"\367\315\365\022\224\011\175\013\230\355\245\040\110\244\247\222"
	"\054\026\144\014\036\033\073\120\340\255\301\014\170\230\076\002"
	"\140\165\135\344\162\353\217\307\013\072\060\272\052\264\217\307"
	"\205\021\276\302\320\127\357\166\270\243\053\277\340\134\351\240"
	"\035\120\110\157\113\304\243\340\266\271\347\177\155\065\365\047"
	"\034\106\365\006\015\131\260\174\354\150\020\320\156\255\355\110"
	"\142\060\245\117\117\261\244\051\363\103\373\062\135\003\275\172"
	"\173\264\330\365\134\041\222\215\062\004\317\345\250\176\023\261"
	"\040\015\214\370\320\347\061\371\047\072\221\050\274\153\164\034"
	"\206\216\174\161\121\151\134\074\256\374\144\024\331\046\112\240"
	"\025\161\050\240\016\153\370\376\241\023\171\107\244\057\117\140"
	"\131\042\035\146\270\376\171\127\362\350\101\373\040\122\300\134"
	"\367\362\024\221\162\250\342\307\000\344\145\331\266\302\206\354"
	"\240\340\071\274\372\107\070\046\363\077\151\251\001\377\227\056"
	"\157\122\130\335\106\052\044\332\131\013\056\063\303\352\100\171"
	"\306\131\166\251\326\076\024\036\302\357\017\305\037\160\370\321"
	"\020\120\060\001\056\032\321\342\007\364\004\277\245\115\372\355"
	"\003\017\377\246\336\044\044\107\302\367\343\060\155\313\102\360"
	"\176\217\351\055\156\334\373\334\135\305\144\225\345\257\010\361"
	"\103\163\223\105\221\200\172\320\131\346\352\050\325\260\247\141"
	"\210\204\174\330\234\071\033\111\245\320\152\001\156\301\102\057"
	"\015\063\165\011\043\270\224\152\177\116\041\031\157\366\001\205"
	"\003\166\271\005\330\240\071\321\267\064\230\226\111\311\021\301"
	"\211\236\133\151\210\070\320\310\206\251\142\056\173\312\231\053"
	"\165\075\255\145\013\327\002\237\253\367\130\215\133\104\347\257"
	"\064\367\146\314\236\032\313\046\127\133\353\012\277\305\074\005"
	"\242\263\030\123\302\270\240\370\004\273\014\046\075\375\004\071"
	"\325\321\377\206\112\241\226\337\034\130\016\126\325\347\242\216"
	"\006\250\340\151\001\132\002\267\347\051\316\353\127\235\244\373"
	"\341\344\364\146\050\146\326\232\350\147\175\232\131\267\261\212"
	"\015\152\264\241\147\235\271\022\353\065\124\305\037\320\313\067"
	"\252\144\153\103\032\204\336\255\026\135\344\026\226\162\165\314"
	"\077\025\025\170\327\216\160\305\044\017\173\205\327\116\021\165"
	"\224\324\270\120\204\233\004\362\345\340\227\107\051\255\110\034"
	"\364\020\162\032\342\052\223\274\163\216\350\134\343\073\271\211"
	"\057\333\233\077\265\056\075\002\352\172\254\020\110\344\311\247"
	"\126\142\313\173\304\053\203\365\153\110\350\364\250\250\121\215"
	"\354\254\310\204\261\066\015\132\353\162\312\324\200\040\247\023"
	"\173\274\322\167\332\330\271\224\210\156\213\250\041\105\075\025"
	"\067\010\235\370\051\251\274\020\042\244\213\362\343\034\103\262"
	"\310\213\014\201\361\254\325\255\227\002\173\100\072\376\070\127"
	"\137\137\001\357\233\012\372\164\177\226\006\155\216\212\030\057"
	"\076\116\157\231\303\355\256\376\232\254\213\307\046\053\227\133"
	"\157\253\147\027\330\102\017\122\362\127\364\044\313\123\244\333"
	"\125\236\333\242\263\314\320\155\225\104\277\167\346\357\160\005"
	"\176\275\207\130\054\043\051\173\271\137\025\245\330\175\070\162"
	"\150\300\013\315\137\057\010\331\177\376\172\337\013\003\062\310"
	"\251\025\206\127\240\325\106\071\266\334\353\325\125\373\160\266"
	"\203\140\123\002\035\062\074\171\052\033\333\066\135\346\020\206"
	"\255\344\045\064\255\315\157\053\035\166\316\215\263\211\072\156"
	"\070\127\103\201\165\064\276\025\070\234\011\117\045\203\173\271"
	"\035\046\365\246\116\311\142\366\124\311\040\072\256\342\247\232"
	"\177\267\155\373\321\147\137\067\365\050\236\216\304\341\223\167"
	"\121\345\311\344\124\255\003\124\217\031\131\374\011\373\157\320"
	"\260\021\224\223\027\110\372\363\363\231\374\202\366\150\163\136"
	"\354\357\076\134\145\013\043\111\050\035\042\373\142\232\002\056"
	"\014\231\004\260\166\012\122\245\105\172\357\365\370\346\317\204"
	"\370\350\313\064\373\015\132\044\012\155\024\175\075\154\262\326"
	"\261\205\133\223\267\323\033\200\210\353\250\254\110\156\321\232"
	"\146\267\215\167\111\223\375\145\230\047\200\020\225\073\136\030"
	"\347\223\353\025\216\162\200\131\034\363\313\177\000\171\164\271"
	"\335\275\362\211\115\131\111\045\220\246\043\000\223\314\334\347"
	"\253\356\145\151\220\336\336\206\244\112\236\233\101\140\115\213"
	"\013\317\164\370\367\245\110\320\026\162\103\166\020\272\021\217"
	"\223\122\055\071\305\124\222\256\273\034\213\035\105\003\343\206"
	"\134\021\256\121\325\364\173\360\152\125\070\267\220\075\207\203"
	"\032\046\164\142\002\220\174\300\311\012\262\230\310\021\164\164"
	"\023\276\012\360\043\120\024\215\340\016\277\274\107\212\107\356"
	"\177\046\212\334\356\364\351\256\074\162\140\135\260\147\242\227"
	"\264\165\366\240\362\361\264\043\010\037\145\154\127\207\131\373"
	"\205\031\317\036\246\314\344\126\325\110\017\070\045\165\275\360"
	"\055\205\370\176\325\016\325\034\320\241\050\270\220\256\112\107"
	"\022\055\375\105\101\227\100\000\137\303\072\143\145\231\340\342"
	"\263\035\214\353\125\250\227\314\207\007\256\300\066\117\363\117"
	"\250\317\353\163\240\135\073\262\277\373\273\232\153\035\267\115"
	"\006\137\316\351\345\070\023\277\135\122\025\025\125\112\043\271"
	"\177\034\320\070\172\211\011\072\200\314\067\200\163\123\247\230"
	"\072\234\061\005\147\342\205\322\375\134\176\265\320\103\131\373"
	"\255\044\200\245\323\164\364\141\141\217\106\300\154\232\235\172"
	"\344\146\221\050\251\270\013\205\052\010\173\277\141\237\133\114"
	"\236\001\256\325\267\255\231\246\276\304\340\362\206\361\177\364"
	"\311\150\207\364\125\110\062\146\001\036\156\337\244\104\114\366"
	"\014\060\270\374\310\204\325\134\061\044\311\111\035\272\215\256"
	"\113\256\176\373\210\123\362\077\245\163\006\146\031\361\057\174"
	"\101\055\243\037\177\331\044\327\034\104\151\200\357\311\247\135"
	"\065\007\132\105\215\340\042\361\216\046\141\124\361\127\132\310"
	"\027\233\143\104\117\063\373\251\271\114\250\134\137\263\275\371"
	"\213\132\023\213\342\233\010\375\145\325\142\365\154\014\125\102"
	"\006\321\072\277\215\105\041\235\006\044\144\145\224\354\000\110"
	"\312\211\047\227\331\161\130\026\344\173\010\342\005\311\066\371"
	"\204\015\132\374\367\367\231\141\243\160\144\074\257\222\226\262"
	"\176\367\002\307\174\001\101\052\317\142\046\377\270\144\232\001"
	"\232\172\305\374\266\170\131\213\303\150\254\356\371\300\301\277"
	"\305\027\001\061\235\364\347\337\124\140\316\220\076\224\114\126"
	"\334\033\302\020\214\274\100\264\267\122\133\067\073\344\232\364"
	"\261\012\072\350\337\031\057\325\214\056\130\015\230\261\004\345"
	"\163\036\131\151\204\326\072\176\166\273\251\111\265\155\247\174"
	"\335\362\055\126\360\053\056\052\165\127\175\341\371\351\113\313"
	"\053\012\362\371\146\255\002\137\160\221\365\155\001\236\121\206"
	"\222\116\146\175\302\245\250\345\302\266\322\055\330\204\064\071"
	"\011\226\245\165\007\216\333\057\025\262\132\066\201\022\337\032"
	"\244\163\135\044\343\124\167\347\136\130\305\211\172\221\243\305"
	"\303\137\052\227\060\351\176\074\217\213\063\272\176\337\112\030"
	"\344\150\140\345\220\051\157\320\052\003\176\127\004\234\100\106"
	"\373\377\226\207\370\124\323\366\174\071\141\360\353\137\022\210"
	"\102\041\047\246\350\225\321\101\022\277\200\176\000\237\331\020"
	"\342\275\363\347\236\032\257\247\145\274\206\240\252\265\142\023"
	"\251\234\063\264\313\113\312\331\212\333\003\225\341\145\341\360"
	"\143\220\147\237\113\375\014\272\166\022\121\371\254\166\332\007"
	"\102\220\056\120\221\325\000\040\105\353\140\070\036\106\146\013"
	"\317\107\001\265\127\236\130\253\113\122\273\130\033\011\074\177"
	"\365\365\345\124\237\174\352\201\333\120\350\172\260\100\232\006"
	"\361\250\041\246\265\340\117\210\362\326\164\137\063\335\143\056"
	"\102\330\245\064\012\123\105\066\337\261\052\002\041\204\214\323"
	"\117\221\255\026\340\032\072\130\221\061\011\164\004\122\211\361"
	"\163\320\260\102\133\346\246\374\335\357\222\321\222\304\375\174"
	"\132\356\321\256\051\011\057\356\261\007\224\271\102\221\213\257"
	"\312\313\040\064\201\360\210\304\223\346\367\354\362\214\171\250"
	"\364\303\221\200\007\032\361\366\337\056\012\135\300\232\243\373"
	"\006\326\145\141\236\175\153\340\074\226\023\204\357\312\003\316"
	"\067\316\140\174\302\314\356\375\313\225\233\345\265\263\001\307"
	"\076\335\030\062\332\117\163\211\370\350\167\324\241\306\150\105"
	"\047\327\174\303\133\045\152\375\351\112\312\076\144\366\130\273"
	"\360\326\320\250\330\273\122\355\001\034\121\307\216\233\006\044"
	"\354\032\120\243\246\263\213\360\103\125\123\205\077\350\030\337"
	"\267\012\116\365\276\254\027\301\176\261\203\144\040\132\324\041"
	"\320\161\150\232\103\160\033\115\003\052\075\063\312\351\217\147"
	"\160\130\101\246\031\254\224\173\371\344\133\264\263\321\112\141"
	"\006\012\175\230\110\004\304\377\374\106\062\123\362\170\071\376"
	"\146\375\011\067\016\156\344\322\106\273\023\101\362\046\144\073"
	"\375\047\164\130\032\354\052\306\122\130\133\316\352\336\266\052"
	"\104\311\051\343\341\054\152\246\123\101\012\047\050\215\375\137"
	"\246\173\075\300\271\147\175\266\074\115\156\121\115\110\317\346"
	"\161\064\241\304\116\033\361\301\340\237\140\027\052\156\342\025"
	"\002\046\377\264\147\251\053\076\103\237\052\056\065\233\076\363"
	"\024\236\117\233\131\033\030\111\314\057\360\066\034\331\157\124"
	"\153\367\031\067\316\020\306\151\045\041\324\122\353\261\233\341"
	"\102\317\063\014\134\231\271\075\043\321\104\123\222\215\140\373"
	"\350\112\250\127\370\324\212\117\176\126\251\072\326\354\165\245"
	"\103\224\354\235\073\030\235\121\251\155\230\024\041\060\362\112"
	"\143\347\243\037\204\013\224\367\252\140\103\352\364\266\164\213"
	"\360\316\177\266\123\034\013\314\056\050\077\226\151\375\245\233"
	"\203\054\234\025\155\204\363\073\102\331\004\127\234\222\226\240"
	"\005\220\077\363\127\001\331\125\156\154\002\242\137\001\313\032"
	"\065\320\220\047\346\017\036\063\125\304\114\056\007\171\265\261"
	"\012\207\161\120\161\215\032\215\205\371\232\105\341\024\020\041"
	"\012\272\121\364\121\055\264\336\264\076\264\006\053\220\062\170"
	"\236\155\122\164\047\025\247\005\043\362\336\162\341\253\234\231"
	"\104\253\250\214\116\027\353\041\111\133\167\230\224\143\276\222"
	"\375\203\205\372\132\222\237\340\123\334\307\036\216\312\374\350"
	"\276\225\212\060\167\200\150\251\356\060\332\157\234\074\060\210"
	"\115\212\022\367\061\241\101\321\247\027\000\154\141\001\320\010"
	"\344\277\164\244\232\224\225\105\077\112\203\157\324\262\331\200"
	"\002\234\273\001\222\241\232\207\165\071\252\260\371\336\102\367"
	"\007\037\234\151\270\222\232\266\161\162\322\263\045\341\177\172"
	"\325\002\077\041\004\273\173\002\345\264\130\156\156\005\250\126"
	"\236\131\274\005\332\151\107\304\142\331\206\137\075\225\104\365"
	"\051\116\357\236\252\072\105\265\240\306\163\026\363\142\260\313"
	"\126\133\003\001\347\256\004\373\220\171\037\131\233\332\002\232"
	"\246\112\315\207\313\364\033\005\066\212\334\031\025\111\302\013"
	"\047\000\232\113\272\165\071\271\017\001\131\011\204\064\310\257"
	"\032\045\314\177\104\210\313\352\114\364\023\070\011\207\361\374"
	"\060\033\156\144\242\065\031\377\213\131\046\262\246\346\062\261"
	"\136\046\000\101\130\207\100\210\224\176\130\172\153\050\156\356"
	"\015\076\232\024\353\375\070\301\343\346\314\121\034\271\127\157"
	"\026\000\261\141\331\160\260\357\342\136\321\334\066\235\020\320"
	"\304\311\336\345\250\213\113\012\374\130\310\325\013\227\162\225"
	"\301\264\272\044\307\323\337\212\221\177\066\066\274\260\372\227"
	"\110\324\134\240\214\211\043\302\072\370\223\242\306\216\314\050"
	"\373\162\141\224\040\120\123\121\304\122\002\165\037\024\103\114"
	"\322\322\220\163\344\237\204\341\157\234\322\020\330\036\043\315"
	"\106\237\120\341\344\331\205\236\175\055\101\103\044\100\027\151"
	"\166\064\253\247\012\260\303\303\051\276\227\103\253\164\254\160"
	"\143\215\211\266\100\146\060\027\161\243\345\263\232\205\111\337"
	"\306\044\134\043\307\160\276\054\303\366\153\035\006\005\170\304"
	"\157\225\066\326\170\356\031\357\007\142\370\362\262\063\010\365"
	"\125\277\152\174\362\063\132\051\011\156\300\152\102\061\340\326"
	"\217\063\147\066\277\245\371\040\367\172\032\306\017\044\257\166"
	"\076\142\324\225\161\073\262\173\063\272\161\040\250\360\213\171"
	"\044\034\065\234\137\366\202\061\073\237\142\270\263\054\355\234"
	"\214\135\317\275\006\207\061\317\260\123\051\354\036\363\232\274"
	"\361\000\374\254\212\046\365\211\035\216\353\024\006\037\154\302"
	"\156\344\345\222\045\220\242\000\336\025\112\224\026\171\330\355"
	"\210\334\246\047\206\370\360\006\175\233\050\372\315\317\043\035"
	"\060\133\220\242\353\041\306\272\141\206\377\226\243\047\033\002"
	"\275\354\103\340\332\330\204\263\320\260\351\274\116\320\045\343"
	"\214\034\141\377\004\054\200\143\044\271\364\164\325\207\263\053"
	"\322\173\251\350\363\106\141\044\343\375\365\025\350\035\074\177"
	"\224\051\175\100\166\155\136\236\161\204\033\276\030\133\307\245"
	"\255\117\221\155\325\361\262\070\172\265\076\005\205\200\340\315"
	"\372\224\077\214\032\174\054\201\220\222\076\156\066\265\104\065"
	"\125\107\216\225\167\121\224\003\301\247\037\332\003\020\337\071"
	"\117\332\242\322\116\223\040\043\316\304\370\061\375\003\010\017"
	"\261\177\256\354\174\327\277\325\316\103\155\305\275\306\201\247"
	"\307\326\161\250\034\233\015\200\232\326\203\345\162\170\262\345"
	"\062\270\145\274\334\222\107\042\136\255\257\041\021\327\257\112"
	"\120\343\035\357\213\324\035\121\065\141\255\173\237\276\032\251"
	"\177\200\264\171\045\117\343\007\256\166\157\053\276\120\060\353"
	"\116\341\312\063\373\363\115\027\077\226\001\201\111\232\043\212"
	"\127\370\102\352\137\240\104\331\133\044\372\065\376\003\074\053"
	"\110\170\247\253\332\074\036\037\257\302\360\216\053\067\377\023"
	"\172\363\125\165\132\146\345\052\135\114\045\212\125\323\176\003"
	"\373\115\151\065\323\140\371\274\041\115\224\023\376\311\337\265"
	"\073\245\204\315\023\055\010\323\127\157\216\256\045\203\307\067"
	"\355\134\340\364\042\312\337\332\133\152\031\015\040\265\201\342"
	"\012\043\366\257\232\277\201\063\157\137\335\105\231\060\176\356"
	"\074\162\052\306\270\253\217\225\030\014\276\077\115\266\224\225"
	"\050\036\076\067\132\141\025\267\203\335\000\304\241\201\167\262"
	"\311\200\020\052\224\246\322\255\075\261\247\046\033\275\232\136"
	"\142\367\201\317\345\025\006\306\071\326\276\356\036\242\346\215"
	"\152\334\152\112\010\171\100\105\076\377\300\304\276\150\027\257"
	"\137\327\226\065\162\016\354\232\132\232\327\372\143\070\205\364"
	"\125\213\273\320\236\127\161\160\262\170\346\005\120\107\211\343"
	"\000\330\020\117\027\161\154\366\340\344\114\370\035\153\276\262"
	"\314\071\255\215\272\135\355\041\057\110\042\131\210\373\170\064"
	"\213\074\016\336\216\265\332\127\307\123\047\254\205\272\376\261"
	"\061\075\321\135\234\257\144\222\201\254\370\170\152\310\137\307"
	"\200\340\375\143\034\135\170\016\010\164\031\037\371\335\223\243"
	"\343\130\016\330\333\121\137\142\235\147\166\136\046\102\314\027"
	"\371\375\300\310\175\201\344\210\233\373\006\354\052\355\262\065"
	"\243\346\021\363\011\137\265\305\351\125\163\015\141\064\162\231"
	"\067\063\043\306\347\241\223\105\060\106\021\321\270\271\020\037"
	"\023\233\337\212\270\302\173\342\302\266\334\245\002\205\250\076"
	"\043\233\052\310\254\347\024\151\361\043\325\310\066\061\140\023"
	"\371\214\335\170\006\366\164\347\363\255\155\234\305\031\172\126"
	"\363\214\120\002\364\342\135\112\207\164\217\202\261\130\021\145"
	"\117\077\171\304\025\364\365\020\274\217\362\356\113\331\377\107"
	"\142\106\354\235\242\127\117\342\170\034\244\337\136\304\035\075"
	"\243\131\147\057\272\357\147\344\337\075\112\001\354\031\161\303"
	"\104\244\317\023\103\055\232\031\263\362\370\357\004\125\053\247"
	"\363\376\126\312\113\171\211\236\263\043\117\342\342\051\104\075"
	"\216\126\056\022\306\320\147\017\252\127\001\157\376\315\257\302"
	"\215\335\074\165\225\222\240\320\366\200\072\256\005\257\201\017"
	"\317\113\200\350\375\142\276\165\144\156\331\176\040\237\000\234"
	"\105\142\135\301\062\134\253\314\135\361\053\256\137\171\164\253"
	"\332\206\356\224\134\360\035\211\001\055\104\112\116\216\344\123"
	"\030\227\051\331\375\141\220\172\122\036\141\371\223\326\067\311"
	"\072\273\136\047\143\076\315\234\062\070\151\013\275\352\115\243"
	"\332\053\361\006\331\364\173\350\002\111\147\113\324\010\222\374"
	"\326\223\253\070\067\155\312\015\342\330\166\346\356\344\017\254"
	"\142\073\036\136\367\034\007\342\157\210\062\063\375\370\041\042"
	"\122\272\370\035\320\013\031\235\271\332\266\230\262\362\140\157"
	"\343\275\272\105\066\276\206\362\236\372\251\271\103\372\034\136"
	"\305\136\305\302\002\243\120\317\113\073\142\214\072\002\106\222"
	"\173\332\146\114\221\003\364\367\255\306\166\247\231\324\106\153"
	"\206\341\065\044\010\015\276\115\202\144\134\247\002\177\340\121"
	"\122\143\025\022\046\167\370\147\345\262\335\063\032\275\022\056"
	"\130\133\323\210\057\357\045\100\306\257\303\277\246\250\335\332"
	"\365\114\224\140\235\345\273\320\147\056\016\054\120\170\014\277"
	"\230\121\220\134\111\361\012\032\104\330\125\066\017\077\255\165"
	"\067\266\275\102\003\152\131\350\265\063\056\264\241\176\220\041"
	"\025\313\175\102\374\310\023\233\147\272\035\155\336\132\377\114"
	"\200\116\161\374\346\202\002\342\033\070\065\343\371\032\001\374"
	"\145\061\342\267\050\316\052\304\036\230\162\161\277\136\334\263"
	"\211\305\212\145\227\311\362\246\307\033\001\304\150\030\333\257"
	"\343\061\036\065\254\323\213\231\152\275\231\026\304\037\372\075"
	"\203\016\116\031\201\301\052\151\147\103\030\375\261\271\356\042"
	"\020\031\264\353\065\222\213\013\375\146\210\122\222\164\376\105"
	"\137\304\350\231\071\230\156\203\265\313\065\221\106\162\212\345"
	"\076\204\371\267\304\250\165\302\344\042\075\014\371\344\073\326"
	"\200\063\067\120\262\044\034\021\353\252\177\156\343\242\377\135"
	"\353\345\027\156\137\342\076\114\006\237\235\156\317\347\012\051"
	"\005\301\212\234\050\122\173\107\174\316\060\216\111\175\277\110"
	"\055\217\354\303\055\077\150\352\361\241\012\222\322\152\137\244"
	"\013\230\044\002\256\054\224\015\274\025\321\176\161\104\127\154"
	"\051\167\204\345\127\315\000\155\154\300\316\371\114\244\341\101"
	"\124\353\130\274\034\375\047\245\343\366\077\224\225\144\106\001"
	"\047\262\301\237\105\041\121\025\303\132\265\233\131\321\203\207"
	"\271\112\241\035\021\322\041\162\057\326\267\342\220\157\330\200"
	"\223\273\201\255\123\242\061\124\166\214\104\055\105\303\240\130"
	"\200\370\316\215\143\306\360\122\274\041\321\140\345\003\167\135"
	"\134\026\301\137\132\113\014\273\112\147\222\064\152\352\277\367"
	"\223\373\020\333\327\323\006\253\025\014\050\216\061\260\266\371"
	"\143\353\121\377\210\112\153\014\042\251\331\003\073\027\030\366"
	"\256\104\005\131\332\321\254\175\356\214\212\004\204\251\326\100"
	"\067\274\005\356\117\271\106\046\050\156\216\241\275\351\001\342"
	"\057\156\163\325\344\203\137\304\073\122\312\277\216\120\356\141"
	"\332\066\065\047\145\227\331\063\252\114\012\354\113\153\316\144"
	"\052\025\246\032\050\061\146\324\246\077\343\275\160\127\100\155"
	"\030\210\304\033\035\156\013\070\313\206\056\101\326\303\075\060"
	"\242\031\263\230\075\111\175\045\367\106\026\253\374\364\333\370"
	"\066\242\021\101\162\114\077\242\065\044\062\104\267\336\161\133"
	"\026\164\012\233\162\020\340\075\022\357\354\263\023\146\214\372"
	"\100\301\160\357\375\222\320\024\075\225\367\314\372\017\365\255"
	"\147\053\270\166\041\043\026\224\076\353\355\371\036\324\315\145"
	"\062\350\347\033\344\344\163\016\224\000\171\144\145\256\375\265"
	"\331\162\344\274\323\110\012\104\016\320\076\246\301\076\365\224"
	"\040\124\367\244\074\322\025\143\037\115\372\230\052\241\245\331"
	"\215\005\013\256\022\124\164\046\347\366\006\042\051\166\263\140"
	"\300\237\154\363\041\301\331\240\361\120\225\156\354\126\153\173"
	"\107\225\333\010\361\046\312\031\200\354\252\234\243\041\171\125"
	"\216\226\362\241\374\147\003\072\250\371\326\061\304\246\106\204"
	"\351\055\214\255\330\262\357\160\333\263\242\174\121\145\114\230"
	"\151\161\117\342\322\317\205\205\062\306\225\137\245\026\021\231"
	"\142\211\063\276\017\253\353\041\044\326\072\135\075\030\140\154"
	"\066\162\274\216\222\360\034\060\115\320\312\323\001\034\110\223"
	"\276\252\320\323\047\005\071\211\175\071\060\172\077\346\263\162"
	"\207\133\350\242\002\255\354\103\146\014\341\062\365\274\010\370"
	"\113\025\173\372\316\145\215\306\020\337\124\100\113\253\112\277"
	"\147\116\006\236\275\024\211\263\011\134\016\051\122\073\031\213"
	"\374\115\276\264\155\345\115\006\324\053\356\172\115\007\066\101"
	"\264\020\335\361\236\066\325\304\253\026\162\131\175\073\166\327"
	"\266\146\334\363\250\251\362\063\315\304\012\024\102\064\242\252"
	"\340\043\147\103\024\100\216\047\330\352\351\325\173\002\234\203"
	"\341\315\110\357\011\354\360\135\273\245\013\055\170\363\264\001"
	"\310\021\170\306\165\057\274\276\007\237\206\206\374\336\127\003"
	"\265\306\036\206\056\361\200\264\100\256\356\022\247\141\301\363"
	"\225\132\150\125\312\230\032\054\015\050\042\003\377\213\174\071"
	"\271\160\261\303\224\366\117\176\112\345\123\227\115\214\201\364"
	"\131\165\334\320\250\147\345\130\022\051\254\160\051\057\153\205"
	"\142\101\253\360\160\326\260\235\073\204\107\254\134\243\274\000"
	"\172\220\224\103\053\033\305\165\030\232\136\302\351\032\312\247"
	"\357\306\206\363\323\030\103\363\355\330\324\314\365\323\243\174"
	"\154\351\067\271\162\061\262\073\214\273\024\105\364\361\366\037"
	"\002\142\040\272\072\050\130\253\043\170\167\306\254\062\272\240"
	"\113\326\166\156\224\257\370\375\057\252\027\240\146\373\311\311"
	"\265\104\006\345\170\206\333\333\032\023\242\132\242\313\146\364"
	"\265\340\137\007\342\106\173\136\066\214\072\020\374\122\305\341"
	"\054\253\247\113\300\334\370\302\037\156\213\206\000\365\032\165"
	"\326\213\060\113\371\011\116\056\276\320\134\062\307\222\202\140"
	"\271\252\053\337\234\070\070\161\276\002\061\274\057\361\077\375"
	"\162\306\033\041\255\374\216\305\234\114\374\131\043\016\035\260"
	"\025\321\324\124\373\171\347\021\205\117\363\046\022\200\042\261"
	"\103\232\105\216\076\154\150\045\163\104\046\344\171\027\135\327"
	"\335\175\335\367\265\366\014\226\212\235\266\107\153\144\232\200"
	"\143\303\160\132\226\057\141\354\037\232\274\134\332\033\326\327"
	"\377\347\213\106\122\227\271\050\124\115\050\130\355\153\212\151"
	"\132\254\016\140\203\200\076\376\201\203\344\001\334\235\221\160"
	"\055\210\103\056\321\025\336\020\245\134\006\325\066\155\126\042"
	"\135\276\115\256\046\223\205\317\227\007\271\370\302\302\053\201"
	"\115\270\115\000\217\155\074\000\235\267\337\230\327\073\006\041"
	"\253\163\372\167\113\000\075\120\154\175\257\155\000\057\233\307"
	"\210\015\333\114\013\214\205\273\260\067\141\063\330\362\325\344"
	"\306\236\005\351\107\162\022\301\267\271\167\331\337\262\342\120"
	"\343\313\146\343\354\165\070\160\162\135\324\303\313\164\231\063"
	"\014\344\260\364\170\220\354\017\211\021\320\360\256\115\213\210"
	"\047\304\103\010\305\073\272\064\224\106\040\140\365\031\271\177"
	"\175\022\223\174\245\353\034\257\310\173\040\051\271\317\220\333"
	"\177\367\135\226\214\027\266\153\332\033\176\170\161\215\010\060"
	"\256\217\051\057\044\221\123\131\120\216\325\314\004\225\376\230"
	"\253\040\205\326\017\111\221\026\327\171\235\007\030\200\035\123"
	"\334\136\111\122\071\051\067\246\360\236\007\116\320\176\100\276"
	"\364\103\010\051\016\327\222\001\271\255\116\227\027\227\306\144"
	"\201\111\274\305\354\017\104\050\374\223\350\040\126\336\105\131"
	"\021\007\110\044\303\063\175\011\037\374\230\272\150\014\163\150"
	"\320\311\017\005\327\213\261\211\317\071\074\147\247\031\262\367"
	"\343\041\231\170\320\221\020\277\005\152\072\236\312\065\066\375"
	"\307\142\375\264\355\256\076\275\350\173\045\217\224\330\206\167"
	"\371\040\360\312\262\001\212\267\153\304\126\066\372\214\063\301"
	"\357\061\166\334\340\264\232\310\057\277\127\303\227\336\073\221"
	"\376\053\133\261\055\345\151\230\252\277\317\244\114\002\146\073"
	"\063\334\030\024\221\262\334\301\162\064\204\012\023\300\233\022"
	"\354\366\303\031\334\054\261\206\354\201\053\070\203\222\163\267"
	"\157\213\313\000\076\250\301\260\334\106\272\357\006\125\002\362"
	"\114"
#define      tst2_z	19
#define      tst2	((&data[7803]))
	"\376\177\200\073\235\363\344\106\243\105\325\354\234\274\316\326"
	"\027\374\336"
#define      date_z	1
#define      date	((&data[7822]))
	"\372"
#define      shll_z	10
#define      shll	((&data[7823]))
	"\042\251\332\042\045\133\265\004\263\047\026\302"
#define      xecc_z	15
#define      xecc	((&data[7837]))
	"\334\025\151\162\350\152\331\204\124\121\133\027\132\063\256\075"
	"\047\105"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
