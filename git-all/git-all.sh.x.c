#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -rf ./git-all.sh 
#endif

static  char data [] = 
#define      msg2_z	19
#define      msg2	((&data[4]))
	"\152\316\365\125\000\231\171\376\043\273\100\030\162\276\024\035"
	"\167\327\104\317\137\111\276"
#define      msg1_z	65
#define      msg1	((&data[24]))
	"\362\220\277\004\103\102\204\263\222\262\237\120\142\064\036\377"
	"\160\124\355\334\355\332\306\022\215\131\173\115\351\015\150\134"
	"\015\210\117\272\037\271\034\105\030\235\205\071\201\131\207\017"
	"\356\120\217\372\170\046\015\213\024\100\102\014\164\113\074\333"
	"\326\165\174\251\357\072"
#define      date_z	1
#define      date	((&data[93]))
	"\062"
#define      tst2_z	19
#define      tst2	((&data[94]))
	"\235\210\113\142\211\256\002\006\372\214\126\164\001\240\136\135"
	"\352\331\124\350\356"
#define      xecc_z	15
#define      xecc	((&data[117]))
	"\236\322\022\003\230\234\065\020\014\173\331\222\072\025\227\357"
	"\067"
#define      tst1_z	22
#define      tst1	((&data[136]))
	"\040\264\161\213\376\367\051\026\157\263\371\261\137\010\277\124"
	"\102\222\147\115\303\143\031\100\152\217\203\146"
#define      chk2_z	19
#define      chk2	((&data[163]))
	"\035\224\001\277\046\374\254\356\031\307\320\200\176\017\024\025"
	"\013\232\046\030\106\015\307\203"
#define      shll_z	10
#define      shll	((&data[186]))
	"\317\303\017\161\145\011\240\216\233\072\345\120\170"
#define      lsto_z	1
#define      lsto	((&data[197]))
	"\263"
#define      text_z	6286
#define      text	((&data[472]))
	"\154\376\352\047\133\013\334\314\226\137\062\167\001\267\225\226"
	"\270\134\032\364\067\217\303\373\007\054\247\156\372\324\335\146"
	"\323\310\215\056\323\151\372\152\311\055\341\312\345\166\141\235"
	"\322\173\222\012\012\126\006\022\202\256\200\174\202\136\342\126"
	"\047\160\204\372\332\177\145\243\255\106\156\222\275\317\057\220"
	"\113\302\232\125\030\241\150\232\117\350\026\322\107\371\050\156"
	"\151\255\151\104\054\316\347\331\025\126\153\322\046\233\142\161"
	"\135\375\307\165\237\057\020\356\030\047\300\140\040\351\316\212"
	"\226\070\317\303\007\266\235\034\015\010\357\063\244\122\245\002"
	"\120\154\170\357\234\210\335\265\257\236\025\320\207\343\133\036"
	"\034\052\341\043\341\176\100\356\207\057\042\054\201\307\056\321"
	"\064\246\301\320\057\236\205\337\075\232\257\304\176\013\343\233"
	"\066\304\276\027\103\376\006\313\055\050\367\257\360\045\201\044"
	"\314\102\365\373\341\172\333\036\025\213\343\224\226\306\057\314"
	"\213\356\344\316\354\352\232\032\023\221\312\003\267\113\050\203"
	"\216\035\177\157\230\132\216\256\345\161\102\174\070\162\110\303"
	"\140\055\222\114\027\054\147\052\276\061\056\165\175\126\371\013"
	"\163\170\374\346\153\075\132\257\050\361\376\034\137\336\320\222"
	"\341\277\365\303\165\175\053\232\036\373\275\070\247\337\041\256"
	"\050\164\337\241\342\173\113\216\275\224\066\120\222\146\170\013"
	"\222\120\005\015\345\267\354\133\324\010\216\110\222\353\051\106"
	"\157\261\362\361\000\037\204\060\256\133\121\030\064\240\370\002"
	"\217\233\052\120\243\322\026\372\075\147\063\130\367\353\031\302"
	"\244\116\250\116\051\377\064\102\145\357\253\267\172\316\105\132"
	"\311\267\343\030\365\011\203\054\116\027\041\164\062\225\344\235"
	"\205\350\140\255\147\025\137\207\275\021\014\142\035\023\262\257"
	"\146\157\143\315\355\244\261\142\323\220\134\175\376\037\356\057"
	"\207\156\167\025\011\046\214\325\221\334\133\225\213\300\166\216"
	"\040\127\322\321\105\242\170\002\061\061\013\023\106\014\006\021"
	"\005\122\203\160\040\072\363\211\145\272\345\111\120\103\342\212"
	"\356\262\316\200\316\123\267\310\221\275\333\200\001\344\023\171"
	"\103\042\266\104\377\061\232\041\035\175\321\376\106\136\071\242"
	"\021\311\126\244\025\346\360\206\032\001\204\232\032\147\120\250"
	"\227\040\063\203\060\055\257\152\143\010\367\341\167\277\316\222"
	"\177\036\216\067\202\025\203\102\172\105\321\224\132\006\107\115"
	"\270\160\157\244\305\112\131\372\016\234\011\302\015\211\154\225"
	"\125\070\107\036\274\027\121\170\141\200\335\160\012\161\124\176"
	"\231\123\173\355\356\247\246\336\015\240\226\352\154\222\276\014"
	"\300\245\135\326\022\346\010\161\005\131\213\201\312\177\074\100"
	"\025\161\353\366\104\335\257\147\322\010\051\203\101\140\205\342"
	"\234\343\076\301\227\161\205\125\323\103\157\333\247\004\252\200"
	"\026\076\215\005\326\357\041\160\216\261\162\054\304\103\304\076"
	"\033\057\060\352\063\360\340\263\261\064\143\136\210\105\300\312"
	"\373\371\276\137\244\202\203\104\073\067\326\357\121\244\061\060"
	"\255\172\034\064\345\051\110\064\251\316\074\274\011\245\255\077"
	"\053\170\343\070\373\311\112\253\360\152\274\356\270\204\011\005"
	"\135\351\053\063\243\143\372\067\315\207\204\144\006\142\334\244"
	"\056\323\122\055\326\007\104\023\335\022\064\215\110\043\245\167"
	"\205\274\112\336\327\307\077\350\111\261\335\270\025\107\154\260"
	"\223\355\170\355\261\017\304\120\377\150\065\340\002\012\037\143"
	"\264\132\374\175\174\300\032\124\112\317\262\362\356\264\106\304"
	"\032\056\347\206\104\135\255\322\060\176\233\354\126\040\231\350"
	"\256\226\271\354\264\241\006\330\120\164\327\162\325\214\253\021"
	"\234\016\013\336\303\166\327\062\272\223\321\365\022\134\365\267"
	"\137\032\032\031\303\206\236\360\035\146\034\243\166\102\160\375"
	"\214\377\162\136\122\226\255\250\065\061\255\300\013\124\043\301"
	"\345\340\337\022\145\266\010\007\274\265\056\302\101\051\274\317"
	"\250\174\215\320\220\322\271\246\235\177\150\311\224\252\240\152"
	"\247\264\034\264\062\024\262\013\355\204\224\121\164\262\071\241"
	"\172\163\364\156\026\237\172\165\357\160\063\213\260\270\240\066"
	"\260\074\306\125\273\366\310\102\166\145\304\147\136\046\266\061"
	"\210\360\050\156\227\121\264\350\100\057\105\011\023\042\262\260"
	"\150\213\222\072\057\253\261\066\355\076\223\110\122\025\100\023"
	"\314\203\363\202\177\062\265\013\120\127\305\367\106\023\202\107"
	"\305\317\011\042\024\355\364\251\066\035\201\213\046\010\251\266"
	"\176\065\312\222\264\213\241\144\323\006\064\316\375\134\371\237"
	"\233\052\201\164\123\315\252\162\101\126\117\100\246\237\070\123"
	"\131\203\311\376\171\331\373\372\241\003\154\364\246\216\155\160"
	"\254\322\225\160\375\010\007\256\245\026\274\335\327\307\357\246"
	"\372\030\232\337\156\047\157\332\006\025\202\013\230\363\347\304"
	"\067\152\106\033\061\330\012\031\140\050\047\230\176\046\374\022"
	"\005\041\207\250\317\013\052\271\276\300\365\215\314\207\137\254"
	"\372\205\311\313\320\310\332\273\020\011\357\060\330\241\130\121"
	"\161\271\171\153\307\252\252\112\363\332\037\017\312\050\200\074"
	"\275\222\010\324\075\373\326\077\022\332\072\123\256\120\210\254"
	"\302\132\134\263\120\331\034\204\337\325\176\002\001\027\221\015"
	"\202\250\260\361\246\300\157\010\314\255\303\251\120\130\032\073"
	"\047\211\311\106\116\140\011\064\247\334\003\103\206\325\233\275"
	"\026\313\352\144\116\212\352\347\274\237\213\357\065\112\120\042"
	"\035\230\056\326\245\211\211\264\062\157\015\103\066\231\252\254"
	"\157\014\156\246\157\076\277\174\370\352\120\065\311\243\137\245"
	"\030\334\157\150\253\346\017\332\176\213\102\117\345\371\312\013"
	"\146\317\243\112\027\304\226\002\314\237\225\066\062\140\115\230"
	"\317\045\346\127\337\353\122\271\321\356\346\115\357\256\115\357"
	"\333\373\322\143\003\140\365\153\215\020\203\242\210\176\123\265"
	"\044\117\162\275\147\015\367\212\150\230\233\204\355\131\116\275"
	"\250\375\037\215\120\347\120\357\052\006\252\372\172\250\052\153"
	"\334\065\247\061\363\327\254\125\244\122\362\272\103\054\041\364"
	"\210\250\073\037\276\002\143\155\363\050\376\326\034\361\211\040"
	"\203\153\360\005\373\267\015\265\014\224\177\167\371\236\350\062"
	"\277\005\040\074\221\106\224\247\223\061\144\344\040\364\052\202"
	"\142\235\076\065\276\260\142\360\051\101\161\013\335\237\233\005"
	"\325\336\250\101\313\367\340\052\130\332\170\151\075\003\323\266"
	"\212\064\266\145\172\220\122\107\214\323\256\157\325\011\017\064"
	"\374\332\212\102\256\240\060\305\062\354\010\110\256\050\260\304"
	"\270\361\134\123\102\114\030\267\157\341\350\007\246\244\260\021"
	"\171\014\042\165\063\070\264\137\022\311\345\064\106\203\336\020"
	"\343\333\070\201\310\225\051\263\310\312\107\227\167\161\132\017"
	"\361\315\220\041\017\111\036\203\334\377\153\274\003\121\057\046"
	"\014\314\174\155\121\157\364\243\255\240\245\017\134\130\363\017"
	"\355\027\105\301\242\366\233\111\272\252\300\102\136\246\061\040"
	"\221\213\133\344\374\147\310\055\334\142\371\137\311\273\310\251"
	"\061\064\240\265\111\211\017\022\173\132\232\344\145\126\012\170"
	"\046\056\037\061\304\324\242\010\044\211\365\153\360\027\243\355"
	"\377\030\120\113\030\052\022\211\244\121\107\234\011\061\360\136"
	"\307\204\371\177\233\114\132\200\337\361\063\324\261\275\341\110"
	"\154\330\156\075\322\247\370\006\056\015\023\157\213\177\051\063"
	"\205\311\146\010\346\027\250\203\020\104\314\242\311\035\217\067"
	"\374\257\362\017\176\020\241\116\063\164\124\257\124\073\261\367"
	"\100\041\166\125\177\342\020\217\263\354\336\245\225\016\364\101"
	"\156\036\061\150\010\302\063\172\121\070\077\057\074\306\301\060"
	"\120\124\220\103\174\375\021\274\276\330\123\010\377\253\266\050"
	"\376\007\011\124\375\316\313\357\215\343\064\065\334\130\226\141"
	"\301\001\026\113\003\260\257\142\330\145\167\104\253\033\033\044"
	"\213\124\154\024\250\364\012\334\175\147\215\033\105\342\114\330"
	"\211\216\234\224\060\211\214\272\254\200\272\147\345\376\210\353"
	"\012\311\375\165\021\172\056\062\154\147\363\373\211\342\147\044"
	"\072\024\356\214\264\031\342\111\226\160\111\141\366\327\234\107"
	"\060\337\170\104\175\235\066\074\376\177\326\122\262\046\120\060"
	"\242\060\155\252\275\035\363\047\336\125\231\130\261\132\007\037"
	"\135\106\214\333\060\366\366\014\022\125\103\172\157\123\031\171"
	"\207\035\200\060\015\105\112\217\214\151\311\030\231\326\155\131"
	"\100\366\254\121\311\152\211\046\005\041\255\332\125\037\045\060"
	"\167\320\050\215\064\163\156\150\215\347\333\306\026\141\252\121"
	"\133\256\312\016\305\201\366\111\011\044\176\276\227\204\100\250"
	"\111\166\352\145\231\225\176\142\265\242\173\245\103\056\275\045"
	"\206\334\230\066\226\354\077\173\375\321\011\356\144\377\070\352"
	"\047\230\206\176\165\127\021\236\055\130\364\137\006\045\071\076"
	"\230\262\004\341\353\153\175\031\257\253\007\000\275\274\263\004"
	"\212\100\155\255\260\177\007\262\222\272\142\135\052\234\323\243"
	"\141\121\322\303\335\132\043\016\351\223\372\021\167\144\262\370"
	"\101\064\157\306\132\063\100\121\034\215\042\275\167\131\310\260"
	"\043\013\040\005\207\355\047\015\367\072\111\303\117\320\322\213"
	"\350\316\242\017\333\027\110\165\171\353\120\145\275\323\156\124"
	"\117\173\300\320\244\171\025\227\054\110\375\222\143\052\164\271"
	"\167\220\325\212\350\320\026\377\077\112\203\006\041\224\315\020"
	"\011\131\157\372\304\203\205\324\217\131\075\345\213\357\113\166"
	"\224\377\062\123\024\224\107\315\236\242\376\200\303\326\043\115"
	"\173\367\262\247\226\205\134\163\112\053\165\125\177\057\202\260"
	"\357\060\230\212\301\224\216\301\235\076\241\010\042\132\314\062"
	"\106\242\033\233\020\366\147\271\265\333\233\214\004\123\315\075"
	"\260\364\150\340\346\122\112\131\106\215\024\014\222\345\302\262"
	"\313\153\310\377\256\100\235\333\072\156\306\327\365\056\265\230"
	"\357\355\101\216\243\012\374\302\057\327\355\246\224\121\232\166"
	"\250\266\153\155\142\132\200\107\362\263\112\036\134\336\161\024"
	"\151\347\004\243\051\340\054\140\063\037\163\163\051\114\066\373"
	"\011\313\116\173\042\237\305\003\142\141\056\071\140\006\207\273"
	"\322\274\246\116\134\030\076\150\202\313\111\251\365\224\217\125"
	"\040\255\153\037\337\123\322\031\354\351\323\043\261\042\366\345"
	"\347\136\331\055\324\025\237\241\044\073\374\132\160\113\271\205"
	"\151\307\110\052\112\102\210\117\217\127\060\027\176\146\032\336"
	"\017\246\366\211\376\052\101\117\267\002\244\150\075\256\003\206"
	"\317\016\335\344\142\375\045\000\010\356\306\152\227\127\103\007"
	"\167\042\245\053\136\300\133\271\262\102\011\101\112\250\323\264"
	"\022\304\146\174\274\033\177\060\250\103\047\030\036\211\036\267"
	"\317\343\252\331\212\231\222\345\130\040\252\232\115\077\204\353"
	"\143\217\103\010\173\246\333\114\055\123\203\203\003\137\173\352"
	"\103\223\366\151\204\301\361\000\334\307\014\126\157\345\100\223"
	"\306\237\107\327\373\277\352\000\351\157\355\211\207\160\030\203"
	"\023\131\306\120\053\216\130\350\117\170\351\311\103\304\263\023"
	"\025\376\225\135\371\336\275\301\001\243\227\361\044\100\166\255"
	"\145\357\044\141\170\307\115\272\337\346\312\375\003\065\230\300"
	"\043\306\067\316\322\107\267\163\110\123\374\327\134\135\232\267"
	"\322\145\251\177\354\042\174\323\142\163\005\267\026\322\211\271"
	"\231\213\322\336\263\243\364\027\221\242\250\027\256\311\263\166"
	"\124\252\051\322\042\007\065\311\246\210\173\131\324\001\255\102"
	"\022\061\207\001\214\005\177\156\171\374\231\055\077\112\223\277"
	"\270\022\223\243\161\174\134\105\013\130\242\220\077\127\230\175"
	"\141\024\313\277\013\272\353\075\061\131\102\163\054\360\017\261"
	"\327\155\217\153\150\020\147\353\306\115\025\351\320\354\351\100"
	"\157\270\343\025\317\212\174\044\347\076\143\120\176\001\317\016"
	"\202\157\033\175\353\220\063\307\250\004\267\045\146\264\110\066"
	"\374\126\110\253\257\220\062\061\074\065\226\235\050\273\167\141"
	"\215\210\332\275\045\103\352\305\207\274\204\246\344\202\041\164"
	"\020\042\152\331\372\071\124\157\337\112\007\222\355\147\155\001"
	"\030\174\236\172\004\375\147\056\123\352\311\246\221\327\346\152"
	"\003\214\142\037\147\337\371\040\051\144\101\021\255\350\162\257"
	"\076\053\307\021\051\323\316\176\144\113\272\340\262\164\303\342"
	"\114\015\201\160\134\036\025\310\175\220\365\136\323\363\235\366"
	"\346\250\226\371\155\013\273\101\330\133\342\021\022\142\141\370"
	"\212\075\134\143\004\055\373\117\122\055\172\160\116\133\277\103"
	"\060\033\367\224\300\361\263\307\227\001\323\156\174\165\123\203"
	"\213\153\127\031\105\127\206\262\065\322\201\130\317\101\076\366"
	"\010\050\334\016\144\243\222\247\115\054\366\077\056\206\161\330"
	"\144\350\006\211\226\233\174\104\241\005\303\335\136\166\216\004"
	"\052\244\344\073\313\315\054\173\042\114\054\061\075\013\171\150"
	"\377\256\051\374\371\270\027\247\146\120\366\347\031\103\352\240"
	"\240\104\123\005\221\271\164\026\164\175\215\100\051\145\071\276"
	"\234\150\002\376\176\200\156\236\350\076\175\071\173\016\063\314"
	"\337\316\355\036\066\316\052\201\203\274\012\241\260\376\070\137"
	"\164\265\012\172\205\114\156\146\115\116\216\116\340\043\014\144"
	"\343\357\367\016\037\361\235\052\121\147\201\363\231\235\117\050"
	"\001\267\240\153\250\012\270\110\026\303\322\356\373\276\100\334"
	"\325\073\250\217\026\232\162\114\204\143\123\055\315\046\325\074"
	"\362\056\057\022\162\166\267\234\257\114\243\111\365\354\137\372"
	"\376\132\256\310\255\204\107\200\220\244\325\312\262\024\163\252"
	"\134\351\305\356\104\053\076\236\303\213\337\346\171\143\345\157"
	"\051\340\316\152\116\041\110\115\354\174\133\334\270\076\363\277"
	"\054\267\060\251\015\251\175\074\214\354\171\047\115\314\115\067"
	"\370\325\362\165\327\001\100\307\310\257\036\024\231\023\173\240"
	"\253\351\175\163\166\226\261\366\335\143\340\052\055\337\144\052"
	"\002\274\260\346\144\264\141\005\101\007\044\026\000\062\335\156"
	"\241\222\355\035\146\130\207\114\075\151\243\126\220\011\334\373"
	"\024\121\306\222\205\347\031\044\001\360\164\331\331\017\336\273"
	"\276\077\132\202\246\203\201\120\060\355\156\355\104\110\101\204"
	"\011\276\024\375\364\264\105\342\313\352\023\142\006\120\315\133"
	"\372\366\315\322\226\363\116\024\024\140\026\170\374\227\243\032"
	"\355\136\015\161\367\374\127\021\043\073\050\312\275\120\333\003"
	"\256\152\046\256\264\122\126\254\256\023\030\070\254\142\073\277"
	"\204\053\310\253\156\321\266\243\020\232\224\362\303\316\163\166"
	"\246\300\327\131\165\361\325\374\152\136\243\234\144\157\037\223"
	"\044\244\064\154\032\170\321\043\117\135\253\344\150\032\065\112"
	"\252\001\260\355\365\227\102\244\144\266\150\140\143\153\343\333"
	"\205\165\264\113\071\160\101\160\327\034\245\137\210\235\307\245"
	"\142\254\330\101\171\312\016\033\272\332\046\223\101\323\275\020"
	"\216\244\044\371\102\243\033\307\244\047\255\367\237\066\010\006"
	"\000\357\151\251\212\112\363\350\116\355\207\141\132\052\040\010"
	"\120\224\304\336\034\332\326\347\155\111\275\347\024\234\071\356"
	"\144\203\174\346\356\271\325\232\014\170\302\247\053\150\212\121"
	"\156\323\167\247\222\060\360\056\350\165\156\065\056\225\267\350"
	"\176\267\036\072\016\143\111\302\021\011\245\221\042\340\300\203"
	"\052\047\323\100\111\241\256\015\072\323\373\260\071\304\167\176"
	"\074\111\300\155\324\371\143\326\016\323\320\063\072\063\174\113"
	"\357\177\360\374\060\120\210\054\103\251\130\245\036\203\310\002"
	"\062\062\007\317\123\201\022\203\203\307\026\247\163\110\150\327"
	"\234\156\346\243\205\250\363\152\307\370\155\364\136\116\242\044"
	"\202\214\242\112\061\330\124\026\277\221\241\077\156\014\147\311"
	"\136\304\124\143\063\332\062\330\265\056\175\104\226\240\023\111"
	"\236\053\177\077\366\037\211\026\203\347\172\227\073\161\047\261"
	"\122\123\341\013\102\115\074\040\102\316\110\335\205\071\050\007"
	"\210\307\215\134\150\134\326\057\342\375\045\203\013\165\305\222"
	"\040\371\036\346\116\076\072\063\067\076\335\042\231\216\357\210"
	"\017\143\353\356\167\064\342\246\237\355\342\024\213\162\053\132"
	"\273\156\340\061\351\370\133\350\335\231\111\336\326\316\017\306"
	"\304\056\336\154\121\100\111\321\231\217\062\074\037\124\234\273"
	"\101\227\332\055\163\074\175\012\143\231\010\111\073\262\157\254"
	"\260\332\012\235\113\325\177\101\317\200\142\321\066\245\305\171"
	"\010\047\350\255\216\102\306\342\371\037\006\222\030\206\014\167"
	"\110\045\170\021\252\070\351\362\377\374\072\050\130\253\014\033"
	"\300\377\235\313\241\356\373\326\225\366\341\123\037\025\227\143"
	"\303\007\330\151\056\076\136\151\240\225\064\111\201\340\175\123"
	"\366\065\242\042\325\072\136\304\203\046\121\362\027\156\347\053"
	"\271\030\066\063\105\143\210\111\237\331\206\270\005\000\144\077"
	"\376\046\046\347\165\356\275\114\073\130\345\152\370\371\025\013"
	"\157\232\043\012\240\051\162\342\306\113\353\113\136\135\277\154"
	"\071\103\334\226\063\311\223\247\374\365\302\342\135\110\344\120"
	"\223\063\202\316\211\233\132\351\105\262\160\374\031\236\330\347"
	"\336\340\162\014\032\100\260\252\213\016\045\225\134\017\066\060"
	"\127\326\110\072\204\250\334\314\163\033\160\166\031\326\165\330"
	"\057\024\313\025\362\140\115\365\365\133\174\011\141\017\175\220"
	"\220\263\060\263\300\154\375\076\345\376\045\173\311\343\134\024"
	"\333\246\266\034\260\364\342\167\144\042\113\233\313\377\336\154"
	"\343\223\054\236\340\346\006\063\374\176\351\172\100\147\262\007"
	"\132\231\262\334\045\063\142\244\045\176\011\375\204\051\265\136"
	"\270\203\322\352\340\345\205\157\221\246\001\027\203\132\107\257"
	"\216\261\140\140\221\203\225\255\346\303\334\043\275\321\160\115"
	"\365\324\056\120\153\332\074\303\246\154\351\143\134\215\066\256"
	"\074\150\304\122\204\000\232\346\341\337\051\332\067\074\326\320"
	"\014\206\162\232\246\167\336\155\170\007\346\013\116\051\216\050"
	"\177\235\176\304\232\364\153\112\046\137\122\252\163\243\154\113"
	"\274\334\322\201\272\301\143\311\371\357\013\176\154\053\247\043"
	"\253\364\230\043\372\345\217\214\317\215\277\316\105\147\014\127"
	"\222\315\236\241\024\376\002\155\353\204\010\133\001\120\357\343"
	"\115\115\233\366\134\335\323\362\360\157\312\220\021\141\122\244"
	"\172\350\060\155\317\130\135\102\311\007\026\071\121\220\225\246"
	"\112\276\276\267\202\235\147\305\245\215\140\366\246\141\373\061"
	"\067\112\075\221\031\046\213\313\150\143\275\176\224\245\022\321"
	"\145\266\031\123\100\106\337\121\253\362\210\006\165\033\011\247"
	"\346\363\130\077\073\376\027\037\011\023\151\175\324\077\322\020"
	"\247\155\320\146\145\177\061\226\034\153\372\250\352\157\230\021"
	"\344\347\306\204\107\214\336\016\355\001\353\151\300\323\235\200"
	"\005\240\165\156\247\245\044\172\201\030\361\035\204\054\332\163"
	"\355\143\012\204\257\236\201\055\342\063\342\037\255\351\052\175"
	"\304\124\164\206\336\021\067\135\060\310\162\071\027\035\106\352"
	"\061\304\111\202\003\057\240\107\111\374\063\345\260\346\021\115"
	"\213\304\051\212\121\130\171\375\216\030\037\121\141\114\023\313"
	"\046\140\052\303\270\203\171\016\134\051\045\157\352\200\075\263"
	"\266\223\212\240\323\365\062\060\376\025\303\170\337\145\264\315"
	"\130\334\364\377\220\022\071\106\155\045\364\207\134\205\057\301"
	"\337\177\164\364\302\057\343\264\022\022\135\364\310\206\107\055"
	"\040\323\347\275\140\277\326\005\133\207\212\035\224\010\174\135"
	"\063\137\221\376\111\021\131\140\220\262\330\016\263\076\256\316"
	"\075\370\025\250\245\321\070\303\176\057\337\363\063\056\034\345"
	"\235\376\313\313\326\367\071\065\131\153\304\154\372\311\217\271"
	"\116\233\261\130\234\360\213\010\043\140\234\243\227\047\115\004"
	"\064\123\167\153\124\316\371\174\141\040\357\056\110\232\071\326"
	"\025\326\224\354\164\043\106\110\030\163\317\162\344\020\364\323"
	"\206\264\305\256\377\047\235\230\006\144\276\143\073\134\374\075"
	"\152\277\212\344\021\131\062\021\045\002\376\040\104\061\012\112"
	"\202\170\160\007\066\273\270\307\136\240\307\330\106\234\033\327"
	"\005\316\025\140\374\064\231\042\143\134\356\253\315\274\362\335"
	"\320\134\103\362\057\200\354\156\103\022\212\127\330\316\241\250"
	"\265\031\050\133\311\324\043\253\366\003\135\116\372\224\177\317"
	"\237\130\163\102\172\041\356\034\346\304\260\135\153\351\254\071"
	"\363\244\021\055\040\124\172\045\132\007\004\114\000\154\222\156"
	"\201\223\310\257\006\043\006\203\177\015\253\242\365\243\154\061"
	"\274\316\102\205\367\304\224\300\236\020\376\044\130\153\367\322"
	"\302\367\137\021\215\000\114\045\152\002\035\040\204\146\253\147"
	"\100\214\211\134\070\175\211\136\211\250\375\246\355\344\220\137"
	"\216\324\301\331\343\072\101\012\035\250\370\301\005\152\102\265"
	"\342\006\003\305\142\204\034\002\110\326\101\036\364\102\242\212"
	"\267\374\251\376\261\322\136\125\116\276\270\222\230\356\074\156"
	"\357\033\266\057\044\112\257\005\165\212\163\017\356\013\115\323"
	"\041\345\232\111\260\132\323\174\076\346\334\203\106\217\015\241"
	"\052\040\304\355\150\255\155\037\113\317\112\365\203\212\273\240"
	"\100\021\203\142\230\043\102\220\037\153\033\067\127\144\341\065"
	"\042\112\012\250\366\175\060\340\120\325\351\373\255\010\116\361"
	"\124\207\357\157\212\207\124\370\311\231\000\006\161\161\161\006"
	"\123\315\300\362\377\345\243\261\146\247\317\022\154\317\274\361"
	"\047\054\151\042\377\367\267\163\104\374\373\044\141\361\145\157"
	"\354\306\237\341\103\213\036\207\300\156\041\262\301\257\047\227"
	"\336\277\336\233\165\121\022\137\121\034\163\036\242\361\264\175"
	"\063\032\262\150\245\367\017\276\271\145\032\061\267\031\266\064"
	"\014\250\273\076\116\072\344\160\020\365\157\244\126\203\254\254"
	"\152\327\136\006\161\216\064\372\333\104\215\266\220\240\055\224"
	"\136\000\166\321\333\207\367\151\245\024\262\321\356\014\302\256"
	"\226\373\374\147\126\227\025\320\076\103\000\057\053\243\020\340"
	"\275\341\262\022\164\100\255\273\013\344\316\306\271\335\345\042"
	"\116\167\222\353\034\065\173\075\031\045\006\145\321\001\126\024"
	"\166\251\175\070\164\270\200\205\341\246\163\021\022\371\367\177"
	"\125\010\266\303\264\271\363\244\100\252\216\226\023\065\131\050"
	"\323\001\363\101\157\155\344\240\223\376\232\126\274\354\301\171"
	"\024\177\305\156\015\346\025\020\210\340\223\360\321\104\237\331"
	"\341\320\271\312\220\000\055\376\230\061\233\064\023\364\372\230"
	"\253\234\017\124\300\016\075\134\022\172\360\013\070\055\251\105"
	"\303\111\004\067\171\264\063\320\173\174\206\144\273\250\245\266"
	"\061\261\073\034\376\343\121\046\034\160\175\350\127\070\043\327"
	"\237\173\114\312\344\362\162\277\002\014\154\054\345\250\037\204"
	"\173\166\210\030\212\336\251\067\041\257\262\047\031\176\063\176"
	"\343\271\270\254\166\065\334\362\005\357\332\272\245\343\170\367"
	"\032\152\226\054\247\315\215\161\133\110\221\313\245\071\004\130"
	"\360\371\214\266\124\333\220\366\266\240\007\375\214\034\065\014"
	"\324\231\371\215\365\203\064\321\253\040\035\040\244\133\166\372"
	"\264\306\016\044\175\144\002\277\347\117\216\361\370\146\373\053"
	"\375\121\026\367\334\342\005\145\115\141\237\065\115\273\152\056"
	"\355\031\277\170\004\076\163\030\060\141\061\371\303\057\206\144"
	"\317\342\116\240\011\217\167\357\100\007\304\227\216\363\103\004"
	"\253\342\310\214\074\304\145\005\165\323\062\174\177\327\200\273"
	"\367\213\236\176\257\034\346\140\123\336\241\364\042\272\123\131"
	"\156\220\160\262\062\213\056\106\100\074\156\306\012\142\100\022"
	"\375\035\214\313\042\365\346\305\244\014\251\251\042\116\015\130"
	"\060\072\241\321\135\044\141\257\045\160\363\070\105\227\000\375"
	"\304\313\150\045\166\011\043\367\114\052\215\014\133\003\006\062"
	"\234\266\121\231\215\046\347\244\217\137\041\247\247\165\300\011"
	"\227\057\061\224\344\130\074\070\137\043\073\037\154\221\024\350"
	"\077\230\127\211\132\237\036\134\207\160\274\054\301\035\307\367"
	"\332\241\226\042\047\061\354\375\036\124\155\232\345\374\116\130"
	"\044\124\225\245\141\036\173\377\341\232\313\141\357\337\141\167"
	"\075\243\372\163\256\356\052\007\310\262\371\070\020\033\143\314"
	"\250\300\374\003\251\273\225\356\174\070\342\145\342\047\320\147"
	"\014\250\215\161\013\325\253\116\004\054\175\306\376\261\200\164"
	"\001\210\320\175\270\360\122\024\352\134\124\242\046\047\176\064"
	"\172\061\075\056\165\367\075\225\174\232\355\370\264\243\331\035"
	"\103\131\023\112\072\165\131\110\255\004\325\303\163\130\143\004"
	"\373\220\036\010\035\370\041\062\012\245\023\122\004\224\143\312"
	"\351\020\307\352\305\163\162\144\331\222\374\156\077\124\050\366"
	"\070\143\261\352\314\376\370\220\144\241\247\102\314\320\227\034"
	"\155\331\311\102\215\162\064\300\151\060\235\215\103\301\172\105"
	"\370\361\023\020\237\155\362\234\374\217\026\337\177\002\275\047"
	"\142\077\111\336\232\260\371\312\377\253\064\174\353\215\132\202"
	"\131\310\163\044\115\135\222\036\353\374\132\303\211\261\015\103"
	"\215\147\221\227\116\267\375\223\250\344\300\265\374\104\154\374"
	"\173\010\161\022\303\115\201\271\034\103\215\051\205\070\267\026"
	"\233\247\174\165\160\155\244\002\046\207\046\155\225\022\304\103"
	"\351\075\136\021\274\112\324\316\214\072\236\135\070\240\240\204"
	"\010\277\034\334\261\126\040\015\044\127\004\146\165\313\071\273"
	"\125\225\052\026\321\314\364\031\362\373\066\035\032\264\172\073"
	"\303\366\317\051\224\171\345\003\127\241\321\033\240\242\313\000"
	"\200\136\254\241\361\076\233\106\225\214\363\005\336\022\067\174"
	"\053\173\377\322\026\246\236\325\341\312\337\207\253\053\263\342"
	"\273\005\014\347\177\214\055\220\046\346\367\272\171\135\260\172"
	"\216\067\357\024\106\354\302\043\276\236\026\174\215\014\161\035"
	"\321\136\331\006\204\263\000\264\074\212\356\366\132\364\134\135"
	"\332\327\077\253\026\142\377\077\277\342\260\065\071\017\133\013"
	"\227\217\112\002\146\064\232\002\156\166\100\272\055\360\054\225"
	"\103\124\146\355\330\060\321\211\253\130\015\001\260\302\311\113"
	"\020\324\215\136\300\003\057\253\221\117\217\201\021\243\211\136"
	"\322\246\060\147\275\254\011\357\230\362\223\357\217\251\344\200"
	"\264\205\001\216\334\004\140\073\264\166\253\012\332\307\106\121"
	"\161\210\335\371\146\065\315\244\004\130\335\005\100\016\364\212"
	"\352\311\325\065\027\051\265\311\077\274\215\062\326\324\040\351"
	"\103\342\053\163\343\045\351\055\120\154\015\214\040\341\236\134"
	"\206\115\163\023\241\171\307\151\015\113\302\266\105\243\362\151"
	"\003\202\137\273\033\300\066\202\317\277\350\106\173\233\346\221"
	"\344\321\117\177\165\132\010\176\016\153\347\346\031\110\050\373"
	"\375\010\363\142\066\062\007\330\077\251\006\225\130\302\157\050"
	"\252\344\352\267\037\153\010\163\050\373\101\356\342\032\163\235"
	"\167\035\006\150\236\032\133\201\125\237\313\275\012\055\160\213"
	"\255\231\163\273\010\257\016\056\144\363\327\221\247\214\164\274"
	"\143\100\144\310\217\231\051\352\100\116\257\176\060\015\245\372"
	"\246\120\207\145\063\113\340\255\377\327\256\145\214\104\332\171"
	"\134\007\154\020\314\174\072\217\322\336\124\053\045\303\105\251"
	"\207\021\144\205\025\361\112\371\251\207\167\155\065\206\246\332"
	"\022\202\331\354\225\161\160\125\043\364\351\204\006\353\241\051"
	"\203\057\117\102\000\216\306\032\370\145\371\034\233\231\006\134"
	"\266\122\311\070\265\126\034\020\171\333\347\147\014\136\260\206"
	"\326\213\327\142\051\303\171\204\330\346\160\015\274\363\351\027"
	"\037\341\053\351\245\226\043\070\047\335\361\233\276\263\133\045"
	"\204\005\073\025\125\073\151\364\270\165\145\244\017\056\254\266"
	"\006\044\356\033\201\150\277\352\113\234\317\357\255\167\322\241"
	"\252\070\221\137\331\165\235\245\350\211\062\142\346\071\272\000"
	"\353\243\147\054\053\222\123\002\025\147\026\131\157\360\360\103"
	"\366\000\344\136\163\162\003\172\033\147\067\032\033\173\307\331"
	"\305\072\377\121\176\160\333\067\032\035\210\250\103\115\006\037"
	"\031\307\367\252\123\356\172\200\353\021\177\064\246\370\306\130"
	"\355\130\042\044\160\240\253\025\222\030\360\231\032\047\362\160"
	"\126\024\215\141\374\355\373\001\163\306\375\250\242\037\003\007"
	"\017\064\104\371\014\266\204\003\165\205\310\324\305\040\277\155"
	"\011\304\054\116\263\133\021\013\302\162\360\152\011\313\223\275"
	"\244\271\326\343\046\061\257\017\237\351\346\122\035\220\216\162"
	"\173\013\323\011\271\270\173\374\064\263\157\175\167\317\252\012"
	"\034\302\067\204\355\366\265\033\153\062\161\144\076\344\335\271"
	"\360\260\303\252\150\076\247\235\362\026\033\152\346\306\165\002"
	"\210\255\206\165\243\074\221\016\156\002\162\254\347\117\146\327"
	"\000\051\201\150\150\051\006\132\077\042\305\045\350\072\050\161"
	"\347\257\347\213\353\170\231\132\173\014\007\142\134\156\071\134"
	"\227\273\305\000\344\314\133\044\356\040\112\327\133\162\111\103"
	"\042\061\316\016\251\150\150\045\164\160\207\321\336\301\055\166"
	"\175\363\166\141\277\321\206\256\362\320\205\116\103\317\221\145"
	"\000\137\163\252\307\334\317\074\115\126\015\053\030\073\242\225"
	"\056\031\367\355\353\175\234\335\116\041\053\221\360\275\366\361"
	"\035\152\233\345\106\152\041\223\301\057\277\331\152\142\156\231"
	"\173\145\207\146\343\043\104\061\105\160\302\066\055\271\047\112"
	"\043\302\057\152\054\121\375\355\201\275\307\353\037\065\204\233"
	"\233\013\002\176\057\106\257\164\266\161\252\344\052\321\057\116"
	"\223\137\270\300\260\266\256\061\163\165\035\223\253\242\057\106"
	"\256\061\304\335\170\164\121\056\345\374\023\020\316\102\136\141"
	"\241\026\042\122\315\321\204\100\107\241\324\362\103\003\071\361"
	"\064\376\317\254\162\041\333\130\035\357\150\353\061\307\115\323"
	"\336\160\045\253\101\251\354\211\113\301\173\216\304\265\200\371"
	"\263\120\246\046\161\202\176\217\161\347\173\243\257\311\167\215"
	"\072\235\071\173\107\046\004\222\347\200\041\253\066\242\245\351"
	"\362\114\020\144\316\216\363\100\166\157\344\045\070\133\263\162"
	"\371\354\356\100\023\363\322\372\164\364\246\252\226\113\224\210"
	"\230\244\355\147\063\341\247\252\120\214\320\211\350\203\374\341"
	"\160\353\041\203\336\364\175\123\350\044\376\176\160\222\007\010"
	"\067\364\157\153\325\027\025\046\243\345\257\213\151\254\154\331"
	"\227\215\135\166\201\333\311\151\377\307\350\157\132\357\167\222"
	"\344\347\376\272\376\023\340\241\371\220\054\143\074\231\074\324"
	"\047\232\112\250\165\024\022\165\334\373\344\066\353\134\311\317"
	"\104\307\212\102\333\153\343\324\374\020\070\071\251\164\015\320"
	"\017\127\171\205\153\214\372\110\207\337\176\162\074\110\102\200"
	"\017\315\302\353\070\246\300\065\267\370\156\140\155\174\061\174"
	"\323\253\001\077\067\374\210\277\334\006\062\030\117\165\231\137"
	"\102\134\112\173\002\012\261\271\002\037\032\157\233\114\354\157"
	"\367\355\257\057\352\067\357\306\076\041\337\215\226\170\354\331"
	"\324\066\125\327\101\006\220\103\045\253\263\301\370\237\061\360"
	"\215\340\037\167\030\016\076\126\060\035\344\306\225\321\240\151"
	"\010\365\100\111\373\321\215\041\175\100\342\165\337\023\146\154"
	"\364\205\344\014\224\042\143\305\077\110\213\325\031\054\076\042"
	"\041\177\153\034\121\371\075\317\071\040\105\030\063\253\205\047"
	"\061\151\064\305\213\227\213\313\340\026\240\371\103\336\034\144"
	"\136\207\201\260\200\277\177\272\337\304"
#define      pswd_z	256
#define      pswd	((&data[7444]))
	"\130\072\241\301\163\260\136\046\355\024\032\127\047\271\172\370"
	"\206\136\375\024\130\227\333\064\324\215\217\326\002\236\331\277"
	"\313\356\045\077\237\204\146\214\230\200\344\300\072\136\271\301"
	"\275\267\325\026\116\261\112\043\076\332\372\100\170\323\000\104"
	"\302\045\204\141\252\352\356\103\153\322\004\245\061\276\146\356"
	"\165\074\005\303\355\117\347\053\051\341\154\242\264\154\347\166"
	"\222\153\330\075\126\306\200\301\231\205\147\313\103\316\272\270"
	"\012\277\174\367\017\143\043\071\104\220\334\371\374\303\160\217"
	"\057\110\314\205\017\114\106\251\322\256\164\025\174\057\316\207"
	"\356\112\177\376\256\242\067\363\063\023\355\057\327\135\276\006"
	"\245\212\213\265\327\322\136\252\201\323\277\376\002\216\205\361"
	"\330\005\357\207\250\047\173\333\073\150\012\022\305\311\031\153"
	"\124\245\040\054\167\177\326\371\122\225\367\125\043\174\107\374"
	"\201\067\204\051\136\377\005\232\147\017\255\054\331\306\230\056"
	"\154\270\132\344\070\060\335\213\306\324\340\352\121\047\347\323"
	"\137\154\374\276\153\002\130\323\021\005\000\353\314\230\031\070"
	"\121\163\034\211\157\147\115\007\362\030\347\011\270\341\114\227"
	"\375\260\366\205\062\246\006\361\046\300\321\353\223\344\132\353"
#define      inlo_z	3
#define      inlo	((&data[7728]))
	"\014\247\033"
#define      chk1_z	22
#define      chk1	((&data[7733]))
	"\225\125\311\161\015\050\171\327\325\335\242\174\112\253\315\322"
	"\106\337\354\201\321\226\146\005\023\175\136\313\136"
#define      rlax_z	1
#define      rlax	((&data[7760]))
	"\350"
#define      opts_z	1
#define      opts	((&data[7761]))
	"\254"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
