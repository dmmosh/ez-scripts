#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f /home/wetsock/coding/ez-scripts/git-all/git-all.sh -o /usr/bin/git-all 
#endif

static  char data [] = 
#define      msg2_z	19
#define      msg2	((&data[4]))
	"\067\165\337\141\071\031\157\033\315\335\161\341\124\236\206\027"
	"\020\161\062\302\171\172\362"
#define      lsto_z	1
#define      lsto	((&data[23]))
	"\120"
#define      chk2_z	19
#define      chk2	((&data[27]))
	"\031\351\355\364\020\351\373\317\334\111\344\147\340\337\310\176"
	"\232\064\271\245\074\004\133\031"
#define      msg1_z	65
#define      msg1	((&data[52]))
	"\330\342\227\026\117\247\372\254\157\362\043\247\011\275\073\020"
	"\177\135\177\275\262\134\216\313\336\311\105\233\200\111\213\155"
	"\170\350\014\250\256\160\131\052\333\240\340\117\102\114\224\170"
	"\276\005\224\125\247\053\012\220\243\002\153\035\007\076\166\144"
	"\353\302\076\023\032\240\204\113\004"
#define      rlax_z	1
#define      rlax	((&data[121]))
	"\001"
#define      chk1_z	22
#define      chk1	((&data[122]))
	"\066\213\223\334\012\253\051\002\140\312\211\216\253\007\246\363"
	"\115\340\134\330\075\355\014\005\104\166\061"
#define      pswd_z	256
#define      pswd	((&data[176]))
	"\205\204\325\162\340\357\212\047\063\143\012\312\171\252\116\304"
	"\257\352\267\132\201\335\075\216\343\202\005\071\301\255\174\016"
	"\371\157\141\017\325\343\225\155\051\123\226\047\162\226\335\130"
	"\364\337\375\010\155\104\220\346\050\356\037\352\233\234\370\224"
	"\014\132\244\342\075\071\117\147\215\346\217\377\174\155\127\160"
	"\115\125\171\272\231\012\241\302\370\301\254\224\135\245\051\151"
	"\000\315\113\076\006\233\245\223\202\065\223\376\242\352\157\357"
	"\077\350\252\331\362\114\234\353\015\111\177\153\357\250\325\357"
	"\166\041\055\174\275\323\020\077\010\243\075\253\215\255\233\315"
	"\225\106\247\210\222\104\164\240\215\363\013\175\234\340\154\022"
	"\001\232\217\276\155\237\375\166\102\073\041\320\350\275\236\176"
	"\003\105\007\226\212\173\066\027\157\101\225\013\042\001\036\043"
	"\233\255\342\011\114\340\177\217\034\241\137\004\136\375\203\142"
	"\103\212\370\315\006\056\345\165\160\172\200\222\174\236\266\027"
	"\114\230\041\231\171\240\050\225\101\210\232\237\206\036\001\311"
	"\250\372\227\256\050\174\044\231\367\244\053\163\103\342\213\220"
	"\173\254\051\364\114\122\212\216\332\044\056\140\102\060\051\353"
	"\052\300\232\123\075\276\354\064\143\030\250\025\172\160\002\377"
	"\365\327\162\325\306\374\375\371\140\007\304\331\262\022\236\141"
	"\375\126\274\177\064\372\015\027\174\023\055\366\203\057\365\170"
	"\007\147\116\316\144\114\310\304\123\214\236\005\237\075\147\235"
	"\223\043\035\307\035\053\337"
#define      opts_z	1
#define      opts	((&data[492]))
	"\107"
#define      text_z	6277
#define      text	((&data[1682]))
	"\205\072\104\355\211\023\122\325\333\026\050\150\265\056\010\362"
	"\226\246\205\271\303\115\326\356\055\160\055\072\000\357\167\206"
	"\051\273\163\263\316\306\210\252\335\261\023\222\340\033\205\166"
	"\302\013\057\205\130\006\164\205\166\241\277\167\220\066\375\272"
	"\362\161\156\301\067\366\153\024\250\177\247\211\233\054\377\135"
	"\067\057\343\217\065\127\025\254\371\325\043\212\014\040\105\376"
	"\222\263\300\311\252\054\336\123\253\205\334\106\261\333\243\350"
	"\012\206\170\100\336\216\354\330\143\020\143\157\061\250\156\303"
	"\134\056\214\006\132\152\131\005\360\066\114\241\021\357\212\034"
	"\166\003\135\125\221\112\056\364\132\221\143\213\071\321\116\225"
	"\000\333\234\132\106\366\140\066\054\254\330\076\234\142\133\023"
	"\146\270\150\367\002\226\353\135\050\117\350\141\041\067\367\041"
	"\023\224\174\131\213\334\220\267\210\150\366\044\313\121\067\061"
	"\011\240\051\014\067\025\152\137\144\123\301\206\212\271\247\236"
	"\116\044\370\331\000\210\221\211\361\207\256\275\331\345\357\343"
	"\206\030\357\276\055\131\035\222\255\337\030\070\231\300\326\347"
	"\344\316\301\345\127\122\156\110\332\034\005\263\002\365\226\210"
	"\015\206\106\073\340\144\316\215\104\346\305\335\247\233\305\214"
	"\152\206\161\301\331\337\011\263\374\017\146\376\004\374\207\022"
	"\202\316\116\142\062\034\357\167\003\264\125\252\120\032\067\272"
	"\241\250\173\172\210\205\055\204\224\223\202\231\220\011\253\022"
	"\327\371\165\012\026\144\202\031\031\327\303\152\362\372\044\223"
	"\243\240\015\053\045\073\257\272\317\062\123\137\074\377\161\024"
	"\371\347\037\017\113\241\050\145\171\354\317\153\347\364\376\212"
	"\225\014\266\272\110\146\165\027\230\310\166\325\310\350\351\301"
	"\317\010\320\033\252\370\200\043\344\120\216\313\105\215\126\332"
	"\232\014\225\342\162\012\371\013\323\160\340\233\130\311\135\050"
	"\322\055\103\174\046\304\237\013\025\056\327\132\273\055\064\126"
	"\071\312\070\254\325\062\267\250\243\227\104\374\141\241\044\063"
	"\317\150\257\366\054\117\001\102\175\330\234\071\006\321\220\077"
	"\233\311\354\160\374\243\031\237\072\135\234\233\377\300\317\317"
	"\051\176\305\126\316\307\230\114\237\064\206\245\006\026\345\241"
	"\337\322\022\333\165\053\173\260\211\027\114\211\330\033\130\001"
	"\232\036\130\150\345\360\265\205\045\073\053\053\122\021\315\061"
	"\343\337\015\131\012\210\011\224\240\125\035\170\160\166\172\013"
	"\225\322\163\172\302\051\000\347\144\054\023\267\075\340\351\041"
	"\277\366\172\312\177\204\137\037\331\174\227\112\363\022\126\210"
	"\344\311\003\246\363\004\216\130\060\241\017\155\202\370\216\102"
	"\356\011\014\156\215\154\215\147\350\045\262\334\067\010\144\033"
	"\322\150\302\305\154\121\035\234\363\054\012\165\044\231\267\023"
	"\242\304\201\060\060\017\230\031\065\112\366\155\123\133\211\045"
	"\303\113\353\060\235\010\314\220\065\327\005\132\160\275\156\023"
	"\202\360\103\263\377\333\315\065\046\303\242\172\036\053\237\342"
	"\167\213\022\024\224\337\245\311\266\253\044\047\151\222\072\353"
	"\202\175\237\202\131\154\267\200\060\132\372\117\206\232\061\375"
	"\045\104\022\271\043\270\203\332\143\250\001\314\073\073\270\275"
	"\271\127\100\023\304\370\224\364\122\216\103\330\051\165\326\117"
	"\271\351\011\335\241\215\270\004\065\272\321\160\366\211\056\260"
	"\341\156\303\245\147\130\231\271\347\335\222\020\123\151\137\015"
	"\122\151\353\364\366\243\371\053\136\312\234\124\124\312\004\065"
	"\071\310\333\240\040\165\132\007\122\355\030\246\126\170\263\251"
	"\341\236\235\327\102\227\002\240\142\236\364\266\151\370\354\242"
	"\300\307\103\341\074\236\350\217\213\000\065\342\170\350\213\131"
	"\207\051\061\311\301\064\152\043\322\136\332\074\127\306\337\030"
	"\216\042\371\312\301\342\132\114\343\217\056\134\170\272\266\000"
	"\344\347\311\245\033\064\310\356\223\242\052\352\151\012\003\367"
	"\054\375\302\356\340\035\072\303\254\151\037\045\044\325\045\010"
	"\275\357\255\330\043\166\306\266\030\361\241\202\373\244\172\050"
	"\242\074\026\202\131\121\105\006\273\145\054\337\073\121\347\370"
	"\101\225\321\145\013\227\033\044\211\275\246\204\142\040\255\004"
	"\135\303\207\267\025\315\275\320\062\351\260\156\073\227\146\174"
	"\055\067\341\070\317\375\134\131\272\003\336\035\043\213\042\201"
	"\117\251\070\144\166\365\065\250\337\345\026\032\175\175\227\252"
	"\265\171\342\205\166\077\336\061\102\274\117\146\110\161\347\227"
	"\032\037\374\220\025\061\071\365\026\120\017\223\315\247\076\203"
	"\040\041\010\227\140\347\310\243\244\027\012\354\210\361\204\243"
	"\021\200\063\047\262\154\034\311\274\054\134\212\323\233\015\364"
	"\274\026\213\034\375\124\300\242\154\312\216\365\274\022\230\316"
	"\223\313\365\105\070\022\016\365\076\153\177\022\006\214\006\302"
	"\243\222\337\240\346\237\102\122\152\321\107\046\344\337\365\167"
	"\253\353\275\343\375\314\331\074\067\130\116\076\345\125\001\210"
	"\347\340\051\316\200\154\040\352\076\150\021\042\110\007\232\363"
	"\362\130\327\357\044\260\054\134\011\173\233\356\321\234\167\270"
	"\175\240\207\375\015\247\350\113\020\372\155\130\001\010\114\363"
	"\140\044\343\205\325\144\140\001\155\045\326\231\271\012\046\232"
	"\136\202\045\132\226\227\251\177\002\327\100\114\325\352\060\053"
	"\044\124\115\304\245\233\202\343\023\346\051\035\151\074\334\110"
	"\375\117\163\352\001\263\165\025\070\031\350\172\373\230\370\042"
	"\303\340\020\050\375\101\352\231\306\177\221\161\146\002\152\352"
	"\341\040\004\274\242\020\156\051\057\213\111\174\345\205\321\040"
	"\117\165\362\123\025\277\077\343\275\200\236\176\064\241\143\337"
	"\325\203\230\050\076\134\116\045\160\211\112\003\054\160\071\342"
	"\133\325\231\055\070\225\256\203\053\021\314\016\217\302\024\216"
	"\224\320\366\202\233\264\320\223\124\315\053\053\373\277\164\016"
	"\300\040\056\247\354\353\201\105\055\126\145\375\232\274\350\332"
	"\007\373\364\102\271\331\120\345\024\076\120\264\333\023\061\346"
	"\063\132\272\210\224\264\174\122\042\077\366\010\311\365\342\207"
	"\266\116\042\164\244\352\213\131\274\100\306\334\215\366\366\141"
	"\162\231\046\056\163\034\024\374\012\157\132\373\177\311\022\077"
	"\251\072\014\147\073\220\053\037\075\365\217\107\053\057\377\335"
	"\110\214\304\205\321\352\215\373\062\262\372\131\033\341\126\067"
	"\317\107\027\102\206\317\075\337\035\233\367\227\223\003\035\345"
	"\177\253\317\337\371\143\040\136\170\014\056\075\271\226\301\327"
	"\035\347\245\073\056\313\357\261\207\143\216\351\331\214\363\322"
	"\011\037\255\217\224\253\276\172\317\346\146\320\245\124\313\110"
	"\162\175\342\376\144\075\267\355\117\064\347\277\036\007\340\117"
	"\011\335\145\357\243\374\161\024\060\166\142\007\037\130\161\033"
	"\056\247\074\220\310\017\206\272\157\033\337\176\031\070\056\074"
	"\001\243\301\326\002\322\151\154\026\332\057\030\124\030\172\023"
	"\341\160\117\377\116\065\111\240\235\245\205\361\130\077\230\021"
	"\302\110\353\011\351\213\352\035\302\274\370\143\230\046\045\361"
	"\307\170\112\115\076\330\033\054\371\302\043\267\147\261\324\045"
	"\130\104\342\230\377\307\216\006\375\362\375\137\152\000\031\124"
	"\021\035\141\241\144\337\045\305\056\060\210\100\167\240\241\312"
	"\043\273\242\372\130\021\064\365\254\227\201\246\227\070\066\343"
	"\356\204\036\265\051\362\023\122\010\037\317\011\274\103\351\027"
	"\272\347\021\141\141\024\215\253\150\366\003\351\045\333\117\033"
	"\064\374\060\161\170\366\143\005\033\242\035\336\361\205\170\210"
	"\274\014\007\115\176\031\354\131\221\152\144\023\021\016\143\075"
	"\274\127\276\125\213\322\374\150\307\306\305\004\003\152\056\141"
	"\002\134\356\113\375\014\247\153\034\157\304\305\064\370\342\320"
	"\056\306\327\236\227\212\311\074\007\211\056\047\205\222\277\142"
	"\125\174\332\070\063\232\111\132\335\233\122\104\205\225\202\206"
	"\162\316\007\345\311\155\356\063\172\350\052\142\342\072\162\327"
	"\350\315\307\256\226\257\174\275\056\024\257\025\355\071\323\205"
	"\317\341\002\112\256\163\154\116\213\106\074\067\157\324\154\265"
	"\066\314\105\127\205\167\062\206\202\317\175\075\225\107\130\022"
	"\332\221\150\043\303\246\100\266\030\336\307\361\305\176\125\126"
	"\170\236\066\266\137\044\130\111\272\336\231\332\331\054\312\206"
	"\331\344\021\321\273\142\366\246\103\147\017\114\124\223\062\117"
	"\215\266\025\036\324\325\235\211\211\155\143\155\163\333\374\216"
	"\263\030\031\202\074\141\145\036\022\201\371\002\376\227\114\047"
	"\152\171\225\077\310\062\263\077\173\141\230\235\102\171\364\363"
	"\050\173\214\044\372\314\154\370\331\255\260\034\217\235\074\270"
	"\353\257\023\266\330\067\173\327\316\204\263\037\010\222\250\064"
	"\251\063\215\125\004\104\127\174\157\231\111\014\321\267\244\062"
	"\256\366\032\211\004\173\272\300\207\163\154\027\335\007\051\154"
	"\266\316\167\267\234\100\252\346\232\103\117\252\053\252\004\375"
	"\012\350\265\274\333\066\264\354\217\262\000\177\355\142\125\323"
	"\013\202\240\030\322\132\125\137\176\375\046\225\202\072\014\103"
	"\237\063\060\162\113\300\130\366\101\326\362\175\243\042\213\261"
	"\027\242\026\226\110\071\037\263\053\253\321\306\051\170\366\347"
	"\227\020\267\117\274\325\113\200\365\132\202\234\011\245\030\004"
	"\351\326\253\136\314\030\005\067\121\362\304\314\324\077\344\005"
	"\116\147\173\331\052\140\247\024\233\355\246\266\133\137\066\015"
	"\165\343\363\152\012\320\216\320\344\153\211\230\134\213\341\335"
	"\302\232\225\221\320\131\222\143\024\011\124\012\215\212\251\206"
	"\151\252\164\035\216\303\016\201\067\221\231\076\237\305\270\217"
	"\123\127\321\120\165\323\062\107\031\011\171\254\010\077\202\145"
	"\050\220\110\215\175\243\100\274\141\232\370\335\361\273\133\121"
	"\370\235\042\117\270\330\024\307\307\327\155\373\170\244\351\021"
	"\004\276\112\152\350\344\033\275\171\204\230\351\044\220\050\356"
	"\355\111\247\276\316\303\032\354\202\002\053\353\210\116\055\256"
	"\227\214\324\246\204\210\025\122\160\064\125\230\375\113\023\234"
	"\317\300\112\211\172\077\366\327\122\065\226\121\315\326\171\265"
	"\247\207\325\240\152\011\363\070\211\125\022\277\101\036\174\302"
	"\131\020\316\201\252\300\054\355\133\074\063\216\055\215\230\131"
	"\070\223\372\140\372\107\350\210\343\142\264\276\364\326\210\156"
	"\152\161\057\040\203\276\370\165\306\114\136\130\003\376\332\064"
	"\114\102\116\304\142\111\234\141\206\347\276\245\272\005\226\051"
	"\323\350\073\245\073\276\256\044\020\351\106\115\166\141\051\133"
	"\165\361\267\165\221\034\075\216\127\377\113\154\230\266\033\001"
	"\334\146\065\050\263\172\340\303\131\030\022\074\025\234\301\136"
	"\316\357\373\050\167\303\025\356\117\164\053\161\227\121\211\062"
	"\226\050\140\275\313\255\247\322\151\173\347\013\326\266\210\131"
	"\054\157\037\110\064\373\157\066\167\023\142\016\055\102\150\022"
	"\211\003\212\215\027\214\304\323\331\330\340\070\362\204\200\067"
	"\244\033\244\022\332\341\154\305\167\036\255\256\233\344\153\032"
	"\365\233\223\233\021\332\311\006\172\251\173\005\237\303\346\177"
	"\341\113\133\202\136\226\046\025\242\062\173\307\276\315\130\211"
	"\243\055\053\321\246\200\036\265\263\060\326\364\115\355\156\075"
	"\261\212\336\041\277\247\000\310\316\164\375\303\202\124\261\053"
	"\332\213\264\211\065\236\061\227\250\247\113\260\252\334\165\003"
	"\256\135\272\211\136\347\055\271\065\306\103\127\311\303\152\165"
	"\046\065\217\365\165\145\340\214\126\215\226\103\175\102\047\234"
	"\230\271\056\303\172\266\261\341\356\343\351\350\121\347\131\315"
	"\330\016\174\377\374\213\016\057\076\304\006\312\373\145\224\307"
	"\315\041\213\230\021\024\004\155\202\250\202\336\377\142\311\362"
	"\130\235\274\241\150\303\273\314\052\013\342\331\050\000\006\376"
	"\226\227\116\126\126\335\371\305\135\355\341\117\153\377\222\350"
	"\003\255\323\221\221\000\235\011\072\144\202\021\045\120\201\213"
	"\033\213\103\164\375\116\003\215\302\225\101\175\240\027\252\260"
	"\226\146\104\153\255\310\313\001\152\152\047\267\106\277\237\114"
	"\143\274\044\006\340\016\300\251\052\015\324\271\241\157\060\030"
	"\007\125\304\247\352\231\257\240\201\340\243\354\071\000\013\241"
	"\017\361\263\325\133\254\275\052\305\033\221\275\111\307\313\254"
	"\012\317\350\213\173\172\064\304\053\124\273\001\325\005\144\157"
	"\326\366\126\063\143\254\200\210\013\160\265\332\250\360\123\234"
	"\174\247\163\175\362\360\222\112\074\056\216\365\016\343\002\057"
	"\053\302\025\141\240\364\036\315\311\121\225\354\065\251\114\360"
	"\177\170\254\023\315\301\101\203\155\130\121\063\175\133\304\353"
	"\050\156\314\207\347\027\222\341\117\076\247\301\151\365\134\004"
	"\200\120\222\303\346\305\141\315\237\057\036\215\174\314\345\237"
	"\360\145\071\354\150\377\024\005\222\076\367\277\215\275\350\317"
	"\362\127\252\042\224\326\224\350\320\324\042\160\176\051\041\272"
	"\116\353\315\031\256\165\107\266\166\355\145\053\264\261\252\174"
	"\362\166\141\255\137\010\142\071\043\120\151\127\006\365\200\204"
	"\033\027\002\167\204\311\153\367\037\274\033\035\002\210\062\175"
	"\207\343\053\372\357\263\057\102\336\320\363\057\214\167\043\061"
	"\142\033\074\234\303\256\025\072\262\042\163\222\240\020\150\301"
	"\235\334\132\267\231\356\112\175\276\157\072\223\027\206\254\075"
	"\223\372\263\263\222\026\210\114\172\055\004\064\077\056\135\240"
	"\105\123\330\366\240\217\217\273\300\273\306\107\262\116\141\345"
	"\151\200\021\324\070\034\235\305\075\341\036\356\216\251\300\232"
	"\104\043\372\271\062\226\125\042\316\325\371\062\022\147\302\032"
	"\273\047\024\255\022\270\114\007\126\355\034\156\145\324\321\163"
	"\170\017\360\143\072\112\120\124\254\137\107\253\166\053\077\321"
	"\033\041\061\335\356\321\314\033\224\037\333\262\231\247\323\235"
	"\200\262\331\074\154\147\121\347\266\135\007\305\076\343\014\256"
	"\137\217\301\121\031\125\115\014\012\126\375\046\135\227\222\012"
	"\020\146\214\034\014\217\170\312\026\004\300\065\311\223\335\022"
	"\134\321\066\100\205\275\225\100\355\071\040\021\117\163\326\201"
	"\370\017\246\161\237\011\304\142\251\067\125\042\140\235\327\316"
	"\036\264\014\100\006\363\234\245\152\173\134\037\007\220\324\210"
	"\243\024\120\204\010\265\146\223\303\221\147\237\102\146\003\310"
	"\351\154\240\255\055\233\263\325\211\335\174\346\111\100\366\004"
	"\341\167\040\376\171\154\171\211\065\226\213\314\122\202\030\211"
	"\154\321\257\017\147\260\177\002\332\306\212\337\324\311\043\324"
	"\265\361\014\367\226\221\313\343\075\223\250\136\115\277\074\122"
	"\325\160\131\362\033\177\062\071\160\021\020\222\233\370\102\125"
	"\012\022\206\110\370\303\010\066\271\045\016\355\107\254\215\222"
	"\342\076\345\007\301\361\260\064\042\026\273\377\177\254\061\057"
	"\103\362\074\117\227\257\310\051\171\064\160\063\154\035\234\050"
	"\331\204\257\252\177\057\054\360\342\264\112\267\260\111\354\276"
	"\173\173\047\264\007\320\025\246\332\323\311\162\356\220\362\156"
	"\001\016\240\001\174\223\311\261\313\175\372\311\377\231\345\220"
	"\227\271\227\327\156\265\355\036\221\374\102\112\073\353\360\270"
	"\201\167\055\050\031\276\027\351\005\354\300\055\252\242\015\133"
	"\302\201\251\275\355\157\131\024\200\344\055\340\133\250\145\032"
	"\105\003\207\060\004\116\032\053\342\324\224\223\260\176\021\246"
	"\116\267\272\161\263\052\102\134\337\007\167\042\317\360\370\015"
	"\014\132\374\154\157\304\365\224\215\237\252\321\245\004\313\056"
	"\001\227\263\056\034\250\125\030\142\265\005\120\324\014\373\036"
	"\245\052\331\124\115\066\304\370\371\040\302\325\067\136\056\256"
	"\003\217\153\245\303\370\211\265\145\300\370\166\275\066\254\134"
	"\010\025\001\303\116\150\177\165\105\174\265\312\212\124\245\037"
	"\130\244\174\015\054\323\232\366\243\277\001\320\073\046\031\027"
	"\206\324\255\221\007\042\355\051\261\226\271\123\161\215\343\325"
	"\333\321\321\062\112\360\371\252\152\334\333\122\373\103\044\025"
	"\002\000\201\112\303\000\131\033\277\043\202\272\063\277\074\375"
	"\010\157\224\142\161\062\251\270\167\032\336\143\175\040\072\127"
	"\037\230\060\046\176\161\351\167\337\040\331\256\100\310\272\271"
	"\042\256\104\044\164\126\120\240\317\051\165\167\121\170\316\143"
	"\372\034\267\140\077\274\372\140\313\012\154\243\330\240\356\366"
	"\201\312\143\122\244\057\177\171\251\071\230\044\326\274\212\212"
	"\236\245\036\023\314\046\365\037\362\154\061\324\054\213\234\151"
	"\121\037\204\365\145\035\306\163\164\304\265\000\112\036\231\370"
	"\141\311\264\324\356\375\236\070\134\232\371\315\322\251\031\304"
	"\156\242\137\067\057\066\070\063\054\127\253\253\272\321\021\103"
	"\150\007\074\050\003\034\010\211\234\311\010\211\135\104\340\236"
	"\161\017\042\137\231\342\031\132\074\264\267\134\231\354\015\321"
	"\325\364\310\117\220\366\153\076\120\050\337\005\137\301\110\175"
	"\016\100\100\134\345\363\265\024\225\277\020\057\000\330\032\264"
	"\030\000\005\007\101\017\130\202\135\346\356\347\251\327\271\064"
	"\305\201\111\276\153\252\343\330\342\033\165\353\132\305\071\360"
	"\356\215\214\207\004\264\324\126\051\031\301\040\276\157\233\335"
	"\261\305\215\111\010\140\032\024\367\160\154\015\154\026\233\266"
	"\330\244\310\244\202\077\114\006\215\134\376\164\311\150\002\245"
	"\020\044\305\351\270\261\251\267\361\247\150\364\071\157\007\300"
	"\075\066\344\337\311\336\231\356\212\245\141\315\211\042\246\234"
	"\057\260\053\334\370\270\044\170\302\021\064\073\133\123\073\053"
	"\252\213\171\230\077\322\053\117\273\015\166\133\374\166\335\211"
	"\316\361\355\070\324\202\373\303\325\033\257\136\326\077\007\267"
	"\133\100\122\063\047\147\312\164\254\230\156\333\222\070\034\133"
	"\123\157\373\364\117\365\210\163\147\314\057\344\024\364\146\266"
	"\300\307\140\307\264\155\110\236\007\165\150\275\112\375\130\213"
	"\350\144\105\024\255\020\201\035\314\330\162\354\064\126\264\130"
	"\077\305\033\334\000\170\041\250\232\004\037\170\324\347\222\377"
	"\106\227\355\173\075\176\026\136\217\120\215\024\116\032\045\242"
	"\144\203\071\312\323\374\056\314\077\163\203\012\040\174\033\047"
	"\323\203\157\064\112\246\142\012\066\256\062\115\002\306\131\002"
	"\355\230\154\220\350\263\007\065\361\320\372\350\267\306\146\054"
	"\360\347\326\156\272\375\266\173\145\223\020\157\274\247\364\312"
	"\227\155\336\366\036\163\203\375\070\304\254\235\222\271\134\303"
	"\345\165\301\257\240\200\321\133\304\137\316\011\016\115\253\004"
	"\330\310\310\045\170\155\256\314\027\307\232\305\063\107\245\351"
	"\057\357\357\035\016\326\263\133\010\326\254\264\267\117\016\045"
	"\035\131\062\122\147\072\121\052\357\255\325\277\241\041\014\217"
	"\224\251\307\315\315\035\111\247\322\335\253\100\200\112\121\127"
	"\231\135\031\066\232\277\151\243\230\227\370\320\354\226\241\037"
	"\351\200\163\176\047\065\121\335\003\266\014\163\011\114\212\160"
	"\143\200\144\242\103\112\145\160\076\272\026\007\105\205\154\313"
	"\264\366\147\255\032\050\021\324\020\016\335\063\154\016\210\107"
	"\304\134\214\202\040\241\250\035\057\147\064\334\242\063\223\172"
	"\350\344\306\216\341\345\010\017\205\360\272\110\310\115\064\072"
	"\126\351\263\367\335\310\144\123\346\371\244\212\233\360\246\176"
	"\102\214\267\320\072\010\143\354\107\156\044\305\064\357\060\240"
	"\307\274\047\354\131\153\052\144\002\316\231\042\100\345\375\367"
	"\065\143\334\277\336\316\175\072\271\230\071\065\363\023\327\162"
	"\103\171\141\364\212\153\263\367\123\012\075\323\210\013\246\326"
	"\267\355\063\114\325\355\360\215\151\054\045\352\211\027\274\036"
	"\364\146\064\072\313\205\121\023\366\275\034\363\234\340\243\214"
	"\305\101\077\042\023\373\156\165\117\307\272\004\340\074\077\035"
	"\312\305\020\021\337\102\270\063\165\176\070\141\336\244\001\162"
	"\326\161\234\356\277\122\274\012\200\061\267\032\251\141\274\344"
	"\325\021\211\065\354\260\351\140\265\313\224\213\343\042\013\336"
	"\056\115\151\267\051\161\341\251\336\057\073\020\232\266\364\114"
	"\260\124\366\125\367\031\060\177\346\212\322\071\233\105\026\232"
	"\056\250\066\240\045\330\145\072\267\111\337\255\350\216\012\204"
	"\137\300\157\066\003\061\371\020\160\006\123\257\177\374\066\122"
	"\055\321\122\215\317\214\313\357\334\345\236\104\017\275\302\044"
	"\055\304\042\364\030\066\262\222\023\040\225\174\145\242\015\311"
	"\360\077\255\006\313\313\155\017\172\246\017\061\234\306\113\201"
	"\016\210\252\104\163\253\352\237\013\342\131\251\021\241\311\341"
	"\325\205\272\017\355\254\132\336\045\045\350\363\313\214\121\075"
	"\177\342\065\040\115\060\111\356\043\335\302\075\246\325\020\317"
	"\275\313\267\161\025\137\233\134\242\203\103\377\077\231\316\106"
	"\050\133\026\161\237\173\121\157\276\035\362\232\315\014\016\243"
	"\243\330\355\222\354\160\204\230\167\023\013\022\267\057\052\322"
	"\333\257\313\117\367\264\266\143\241\147\045\145\014\254\004\316"
	"\262\174\304\213\304\033\244\370\372\002\257\105\135\055\331\231"
	"\250\313\070\212\032\377\047\013\076\216\232\216\006\002\234\307"
	"\224\345\327\301\003\247\316\122\374\323\145\367\113\371\357\264"
	"\234\016\315\161\303\173\143\160\354\127\336\045\063\317\177\131"
	"\060\012\062\227\125\120\324\074\377\351\125\033\063\051\012\143"
	"\007\353\220\262\174\360\213\233\326\177\314\222\004\372\060\205"
	"\372\046\161\157\066\364\371\236\214\167\246\265\270\137\366\363"
	"\063\247\105\172\076\354\116\322\140\176\146\322\055\237\333\255"
	"\232\040\133\230\271\206\074\367\130\330\075\026\230\001\071\205"
	"\341\347\262\211\065\337\020\044\112\311\057\204\045\301\230\147"
	"\307\067\246\274\161\376\223\164\310\202\114\135\034\107\231\231"
	"\052\205\124\327\146\172\351\030\375\316\346\102\214\361\360\326"
	"\254\104\262\241\253\234\262\173\151\161\361\236\365\375\114\313"
	"\202\315\256\102\066\356\273\057\205\127\332\375\355\160\031\126"
	"\073\266\226\145\375\112\005\057\030\316\251\311\020\305\226\206"
	"\307\364\335\234\310\363\313\160\260\042\155\035\252\233\226\020"
	"\357\200\361\236\134\120\247\032\231\134\051\340\151\154\111\011"
	"\250\257\141\307\351\143\112\161\347\363\170\041\335\347\300\063"
	"\255\324\074\156\120\042\061\253\166\250\322\211\226\315\355\140"
	"\213\344\300\135\201\264\215\366\334\122\303\356\030\102\107\332"
	"\325\216\360\207\104\140\275\071\074\177\372\324\000\117\346\231"
	"\340\051\276\225\221\046\101\355\115\153\212\175\021\350\233\254"
	"\027\305\071\341\244\363\074\346\022\046\213\035\311\115\140\332"
	"\227\046\112\260\206\147\300\352\144\345\273\226\173\261\133\172"
	"\313\243\275\155\362\241\365\065\004\250\320\112\313\217\307\226"
	"\216\300\232\041\137\347\277\153\245\041\377\247\247\025\177\350"
	"\177\061\367\270\072\207\045\322\040\341\231\335\140\116\052\377"
	"\176\130\374\036\276\157\041\327\120\361\225\272\164\376\104\261"
	"\275\067\373\101\366\013\255\040\071\047\323\350\006\015\114\226"
	"\122\345\052\376\066\102\374\133\224\001\175\103\304\375\032\102"
	"\134\116\223\015\165\334\047\201\273\317\037\165\367\130\323\201"
	"\313\121\105\054\073\357\257\145\335\302\071\272\266\176\027\142"
	"\242\125\216\060\343\260\255\316\223\357\132\072\254\333\234\325"
	"\153\345\377\320\133\014\065\043\377\306\165\224\125\211\270\040"
	"\233\004\105\362\177\012\142\230\331\074\312\035\026\376\153\147"
	"\031\076\323\333\152\377\326\104\147\010\016\276\312\023\004\016"
	"\063\346\054\046\274\304\171\241\140\251\050\014\101\311\172\277"
	"\006\204\204\161\051\146\164\073\000\331\161\272\175\003\345\036"
	"\035\213\362\233\373\161\123\130\356\321\347\166\232\123\007\045"
	"\056\162\146\214\007\077\206\361\031\314\052\362\176\005\071\145"
	"\021\162\113\065\164\373\076\366\350\024\006\236\124\275\000\173"
	"\120\105\176\071\020\265\340\013\240\157\032\202\026\171\022\315"
	"\027\215\371\257\210\020\327\253\036\371\044\223\232\261\324\251"
	"\067\104\041\065\370\034\211\230\057\374\034\337\240\336\073\341"
	"\331\230\056\334\012\331\244\071\170\075\014\223\350\347\223\327"
	"\070\065\336\175\063\363\271\242\374\173\007\371\323\255\365\165"
	"\130\331\344\030\120\273\011\213\053\171\023\063\327\215\353\141"
	"\216\140\034\334\063\036\161\310\030\113\123\225\333\267\251\056"
	"\137\171\303\304\026\252\017\060\137\351\027\270\064\214\211\170"
	"\364\364\260\255\037\022\045\157\235\067\272\272\340\360\075\361"
	"\235\304\044\013\157\167\377\067\077\314\060\230\200\364\042\064"
	"\277\146\237\302\372\211\302\024\304\242\264\011\315\273\374\262"
	"\067\061\060\320\275\335\044\052\222\003\115\250\377\321\173\121"
	"\056\224\260\115\156\321\344\164\211\202\262\130\264\127\377\345"
	"\251\233\126\326\366\253\321\073\216\320\161\357\230\223\105\072"
	"\373\145\232\105\370\004\351\157\124\046\016\136\153\044\224\325"
	"\317\020\271\053\341\105\023\334\152\105\211\264\017\323\237\013"
	"\200\301\124\165\024\233\370\054\051\062\344\171\367\242\360\057"
	"\210\063\277\177\255\251\070\252\313\076\257\303\253\307\050\042"
	"\072\220\347\055\337\032\152\010\371\064\322\331\133\352\167\277"
	"\257\165\010\067\017\023\320\342\230\037\124\013\042\363\013\227"
	"\262\023\053\171\312\121\122\301\104\327\073\122\121\347\364\323"
	"\242\306\074\044\067\254\060\221\163\043\065\242\227\145\140\155"
	"\274\063\167\377\025\012\113\002\162\356\325\377\311\211\104\013"
	"\201\020\304\134\154\306\024\141\235\242\261\151\117\144\002\030"
	"\241\244\173\341\036\277\316\214\055\072\167\042\350\324\053\355"
	"\156\035\373\354\130\235\165\147\345\152\324\351\143\327\245\237"
	"\121\070\044\172\313\065\016\161\133\073\064\076\311\041\057\034"
	"\165\023\103\306\111\047\132\310\246\143\323\217\062\110\355\344"
	"\331\166\250\074\350\025\132\302\157\261\232\272\230\140\342\004"
	"\264\207\336\013\051\171\017\166\237\373\021\055\354\152\230\142"
	"\042\363\035\275\026\173\111\224\061\025\131\302\017\113\003\170"
	"\367\073\151\030\103\130\025\110\317\361\122\361\141\241\063\317"
	"\231\164\321\263\254\004\316\142\262\366\123\103\203\065\127\157"
	"\152\346\216\161\340\156\365\242\143\233\163\150\141\131\274\024"
	"\205\202\140\127\366\052\321\325\267\072\101\307\106\132\031\363"
	"\256\275\315\355\061\372\251\037\330\212\320\127\367\143\217\000"
	"\165\331\033\146\063\116\142\043\125\331\103\207\344\254\302\214"
	"\273\327\123\255\327\304\121\325\115\350\023\303\213\275\376\257"
	"\306\003\153\347\375\043\231\346\161\136\217\043\261\276\373\342"
	"\011\263\071\366\114\206\055\240\357\222\065\276\376\146\253\126"
	"\002\161\226\262\074\030\120\132\143\223\046\263\366\233\354\215"
	"\216\073\310\050\031\313\126\077\174\163\267\273\273\225\051\044"
	"\375\205\156\223\261\336\133\345\025\103\003\176\175\137\325\366"
	"\076\262\007\145\110\012\252\017\047\033\123\272\037\346\032\003"
	"\160\300\242\102\304\050\227\336\265\315\147\235\067\036\026\353"
	"\004\166\240\151\131\247\252\320\322\075\264\217\207\047\136\120"
	"\376\152\257\352\156\150\041\216\113\267\226\024\375\053\242\144"
	"\324\322\046\145\333\204\114\371\045\133\312\114\356\167\165\127"
	"\327\121\310\076\020\106\346\147\035\163\041\176\171\326\307\212"
	"\243\164\033\302\346\110\352\015\124\025\135\323\207\173\052\042"
	"\257\126\233\221\034\207\014\253\342\156\006\005\021\305\045\227"
	"\054\253\124\013\110\112\244\214\174\134\243\014\146\033\157\027"
	"\342\225\354\205\373\356\365\304\075\313\271\253\047\376\306\323"
	"\214\336\246\113\066\124\076\311\326\366\310\171\356\032\114\174"
	"\313\245\130\046\037\231\001\363\261\232\145\006\347\164\037\310"
	"\252\231\376\106\347\134\233\353\344\147\307\015\030\030\305\132"
	"\342\225\325\242\243\312\114\347\127\123\036\341\272\221\362\100"
	"\323\026\067\125\033\373\200\067\172\035\250\214\165\347\076\230"
	"\150\173\145\044\236\231\033\350\042\073\202\034\321\237\147\371"
	"\034\304\256\205\175\343\167\215\172\101\254\127\176\201\347\365"
	"\221\230\117\321\016\150\071\377\243\316\141\360\153\307\376\031"
	"\002\312\114\251\221\310\253\211\133\316\070\255\272\305\053\232"
	"\025\235\171\324\310\100\202\232\306\214\105\207\274\273\104\364"
	"\233\265\253\301\223\275\062\073\246\042\321\170\371\343\024\025"
	"\003\133\020\077\130\371\006\202\204\175\150\067\115\155\144\135"
	"\066\165\361\370\377\376\245\055\074\174\321\273\311\036\222\077"
	"\224\141\144\226\063\227\336\215\342\107\247\265\035\102\312\151"
	"\266\312\272\237\203\052\352\206\355\347\333\275\252\236\336\052"
	"\063\137\063\102\003\253\244\332\354\205\222\245\061\336\104\323"
	"\117\337\135\105\226\012\325\024\274\050\341\167\346\351\014\111"
	"\221\207\004\021\340\242\011\150\107\306\047\366\230\246\060\214"
	"\250\001\207\031\161\027\343\141\336\162\266\142\117\163\215\221"
	"\115\167\010\172\313\165\112\024\111\211\130\270\261\236\204\351"
	"\371\130\145\027\234\115\161\166\303\274\302\101\002\231\347\065"
	"\025\244\377\074\301\003\361\312\276\034\226\313\310\204\246\122"
	"\370\117\147\131\106\216\112\214\310\251\234\372\247\317\217\140"
	"\016\120\017\015\005\164\100\157\152\102\237\034\346\172\264\155"
	"\313\242\162\224\026\071\073\064\110\354\333\022\106\212\106\170"
	"\007\011\135\004\254\217\006\172\206\217\104\162\133\164\357\367"
	"\315\275\172\070\154\056\004\065\125\164\261\240\144\131\100\335"
	"\361\007\004\066\222\133\237\123\343\232\300\240\204\033\317\043"
	"\266\041\352\376\124\022\310\004\140\132\205\153\115\071\262\355"
	"\174\377\331\133\225\141\301\351\137\240\241\311\226\102\227\163"
	"\373\043\003\043\356\052\060\315\145\140\156\214\124\062\022\273"
	"\034\137\354\222\035\160\110\070\223\273\002\362\211\124\267\347"
	"\164\342\226\174\224\234\007\057\162\043\142\166\240\220\076\211"
	"\206\146\362\126\051\261\262\043\373\034\007\035\145\061\207\104"
	"\275\223\140\056\123\144\155\164\072\300\074\342\304\273\226\265"
	"\065\024\321\047\313\336\011\267\167\017\117\323\357\237\177\033"
	"\272\312\174\073\330\073\052\001\154\055\065\307\220\343\200\263"
	"\214\051\343\002\056\030\140\043\017\160\364\120\107\231\240\160"
	"\131\066\211\324\147\355\023\204\036\137\210\357\005\101\353\235"
	"\066\210\260\147\353\375\255\050\031\211\170\364\335\172\110\115"
	"\124\154\345\276\022\135\156\163\366\322\017\165\127\113\267\037"
	"\302\341\325\104\012\222\102\313\157\150\222\330\023\102\355\274"
	"\330\315\142\136\352\260\307\164\322\100\130\033\216\375\240\121"
	"\255\212\261\370\236\152\216\223\253\117\101\130\302\063\204\320"
	"\001\123\154\221\343\362\315\051\307\163\243\327\075\227\072\011"
	"\202\154\350\153\040\224\256\166\144\111\147\161\056\272\344\017"
	"\076\157\311\141\311\231\376\226\362\254\171\206\122\056\130\376"
	"\245\065\152\153\371\267\353\157\047\316\152\307\335\240\303\273"
	"\042\350\017\343\231\156\275\271\130\246\126\272\352\205\207\131"
	"\335\010\203\270\270\002\375\121\364\150\276\352\335\153\245\261"
	"\146\246\354\035\003\137\331\114\157\143\152\204\107\352\077\367"
	"\271\176\130\163\301\037\272\172\077\347\026\167\126\022\160\136"
	"\261\212\161\152\067\240\070\043\366\161\062\101\075\055\112\066"
	"\361\330\010\025\131\024\323\276\022\360\047\156\273\056\113\045"
	"\350\354\020\123\376\205\352\220\171\035\341\114\105\350\263\332"
	"\210\114\212\057\015\246\060\130\074\337\146\334\030\264\254\352"
	"\367\233\315\024\141\231\200\360\251\201\215\317\316\032\310\251"
	"\215\250\322\234\367\332\000\367\204\056\131\154\356\126\061\051"
	"\331\256\013\307\272\366\043\022\074\102\124\274\006\126\056\073"
	"\041\117\325\360\331\270\002\105\267\147\325\212\034\115\005\355"
	"\173\040\023\041\214\324\136\245\327\002\110\131\005\141\255\367"
	"\265\175\252\322\063\172\173\351\034\105\064\235\051\276\123\140"
	"\212\015\237\267\336\224\346\355\224\226\316\246\343\056\322\264"
	"\226\330\352\243\033\364\102\361\223\170\072\311\047\322\071\261"
	"\302\372\251\265\202\075\251\251\267\150\053\220\160\161\305\245"
	"\077\256\337\270\106\044\302\341\313\034\047\220\004\107\207\340"
	"\022\052\067\334\116\031\067\273\330\201\113\342\134\320\223\276"
	"\174\275\120\363\136\325\002\045\163\173\127\133\110\300\264\226"
	"\034\222\337\360\210\350\161\166\004\347\101\160\324\174\276\370"
	"\047\241\276\046\262\114\344\352\072\341\355\060\107\257\213\134"
	"\072\206\045\153\002\365\226\257\152\303\006\254\007\074\164\131"
	"\312\177\155\374\170\121\222\045\175\103\266\364\330\273\017\157"
	"\032\026\014\254\336\240\254\320\014\015\020\341\336\213\174\315"
	"\134\030\104\025\225\345\234\223\362\104\174\076\125\166\254\255"
	"\170\264\372\154\025\036\120\232\363\140\173\321\354\370\237\111"
	"\021\343\137\247\311\374\072\274\100\267\372\225\055\246\103\246"
	"\133\075\022\160\134\143\013\117\303\207\041\260\177\300\371\220"
	"\244\131\067\155\125\162\051\226\051\044\054\127\313\157\376\046"
	"\255\020\227\011\163\242\130\067\051\172\350\251\072\342\071\337"
	"\073\161\114\220\343\166\046\015\232\122\144\145\302\142\214\157"
	"\163\043\171\347\306\321\037\360\114\007\231\207\351\323\146\045"
	"\104\262\265\047\050\334\065\303\057\232\050\361\375\264\141\160"
	"\330\332\130\236\254\167\217\370\177\050\177\151\373\345\216\077"
	"\230\103\147\301\040\234\204\117\067\254\100\064\141\241\244\071"
	"\174\375\330\050\164\147\041\363\217\240\134\213\206\353\313\037"
	"\056\063\340\117\320\144\236\007\021\337\073\162\200\340\254\375"
	"\335\204\046\121\354\107\105\173\350\242\007\157\215\322\216\274"
	"\005\156\013\325\322\251\335\343\210\030\125\011\370\002\007\325"
	"\206\055\047\162\164\154\356\135\017\365\314\234\310\132\131\316"
	"\310\144\244\233\016\201\176\227\231\324\241\222\326\250\147\135"
	"\326\216\317\112\373\276\250\012\264\164\247\175\316\000\113\227"
	"\145\360\062\163\161\261\013\013\206\255\235\134\125\004\272\054"
	"\223\212\167\216\110\037\231\374\223\100\172\142\100\305\372\245"
	"\265\054\031\047\336\045\062\144\322\320\301\050\324\173\124\150"
	"\005\313\367\116\352\220\112\176\320\305\340\021\212\333\266\100"
	"\007\320\150\346\365\232\112\307\152\014\357\077\207\103\250"
#define      tst2_z	19
#define      tst2	((&data[8332]))
	"\343\060\016\124\277\062\254\306\140\236\227\005\352\306\153\207"
	"\135\217\357\333\371\057"
#define      date_z	1
#define      date	((&data[8354]))
	"\134"
#define      shll_z	10
#define      shll	((&data[8356]))
	"\166\270\206\064\347\345\371\327\354\146\017"
#define      inlo_z	3
#define      inlo	((&data[8366]))
	"\271\005\207"
#define      xecc_z	15
#define      xecc	((&data[8371]))
	"\042\215\022\116\137\364\322\314\062\372\146\230\157\343\273\312"
	"\376"
#define      tst1_z	22
#define      tst1	((&data[8388]))
	"\044\171\017\202\070\143\356\250\011\044\146\072\165\300\026\331"
	"\374\135\050\026\212\232\046\144\104"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
