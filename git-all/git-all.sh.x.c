#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f /home/wetsock/coding/ez-scripts/git-all/git-all.sh -o /usr/bin/git-all 
#endif

static  char data [] = 
#define      chk2_z	19
#define      chk2	((&data[0]))
	"\140\164\017\233\235\214\207\100\220\133\325\211\333\255\327\070"
	"\151\153\311\061\135\142\136"
#define      xecc_z	15
#define      xecc	((&data[24]))
	"\306\164\202\003\054\005\143\342\200\043\034\254\266\265\071\122"
#define      pswd_z	256
#define      pswd	((&data[101]))
	"\107\225\300\176\257\354\213\056\171\237\215\224\112\041\067\347"
	"\345\057\374\265\140\131\030\277\275\147\351\203\152\337\241\261"
	"\165\142\060\045\117\273\123\310\132\341\135\245\002\224\214\347"
	"\303\210\235\043\342\266\342\237\035\314\043\207\254\305\021\276"
	"\110\350\035\257\310\047\057\263\246\135\223\072\124\012\077\120"
	"\177\204\134\060\063\163\125\300\341\323\014\201\042\036\100\152"
	"\006\135\032\317\204\112\203\053\247\026\145\373\040\245\114\240"
	"\051\250\320\134\033\046\035\374\372\052\176\034\110\276\207\117"
	"\033\242\036\240\354\241\313\223\267\061\217\330\326\333\171\377"
	"\203\111\134\237\160\172\234\152\244\032\206\355\330\016\074\363"
	"\260\133\224\234\374\137\060\264\221\277\214\147\232\006\147\036"
	"\120\304\276\300\077\132\052\344\165\261\321\115\277\016\101\160"
	"\151\325\015\145\065\075\032\307\375\246\056\230\255\226\266\375"
	"\133\165\275\232\317\347\176\104\230\120\222\130\136\324\311\310"
	"\252\326\056\340\024\110\247\021\357\326\251\234\155\140\231\310"
	"\325\126\143\245\076\341\352\326\062\175\057\220\121\370\131\374"
	"\316\207\334\343\317\204\364\277\132\236\133\307\377\364\220\324"
	"\113\363\172\211\324\144\140\007\341\217\227\063\207\361\060\125"
	"\170\015\070\110\221\055\007\354\314\142\264\313\127\104\237\242"
	"\067\031\054\014\176\214\023\137\033\253\223\242\234\303\070\042"
	"\047\151\107\167\044"
#define      msg2_z	19
#define      msg2	((&data[365]))
	"\174\132\140\121\346\103\061\275\153\050\307\170\220\032\073\226"
	"\245\037\070\173\234\045"
#define      tst1_z	22
#define      tst1	((&data[387]))
	"\147\230\052\033\171\173\055\172\020\204\304\125\317\235\374\372"
	"\000\321\026\201\100\161\372\364\073\004\030"
#define      msg1_z	65
#define      msg1	((&data[425]))
	"\274\330\310\337\137\164\244\230\227\314\001\337\037\361\273\311"
	"\112\271\145\006\234\121\315\102\040\224\300\364\344\112\300\257"
	"\221\072\047\142\246\076\243\205\233\013\174\370\031\240\371\327"
	"\046\221\046\314\003\325\156\176\126\113\155\173\263\264\243\072"
	"\024\000\040\073\074\106\306\032\034\144\157\043\107\103\046\172"
	"\203\246\366\040\313\166\121\176\335\106\271\342\136"
#define      text_z	6286
#define      text	((&data[1471]))
	"\223\165\042\162\325\227\027\156\056\344\160\015\050\226\210\253"
	"\075\177\313\010\365\035\206\322\143\100\264\301\026\121\034\251"
	"\307\076\034\235\326\064\013\005\030\174\023\100\022\233\354\120"
	"\032\270\131\017\325\340\342\070\040\226\372\066\350\026\340\260"
	"\125\374\115\053\060\131\061\111\326\104\212\351\340\167\071\373"
	"\057\222\013\004\162\355\075\222\204\067\311\155\116\251\035\243"
	"\245\153\317\326\305\000\040\233\105\252\204\046\042\275\041\121"
	"\117\054\126\302\032\223\124\236\313\035\013\031\306\051\274\154"
	"\224\213\103\131\214\143\365\321\016\171\367\060\067\031\201\206"
	"\105\330\110\137\153\235\376\067\272\011\120\201\063\015\356\307"
	"\231\061\041\045\224\026\367\243\220\357\323\307\010\125\116\116"
	"\055\227\256\231\064\254\320\357\266\041\161\351\056\137\261\310"
	"\221\322\355\046\351\344\311\172\324\234\101\334\362\217\052\040"
	"\046\330\271\133\205\212\113\073\254\274\045\333\034\326\243\255"
	"\251\220\323\223\165\234\015\112\071\117\046\053\336\121\113\005"
	"\052\005\141\257\220\254\353\074\150\021\030\204\347\273\062\221"
	"\114\005\044\302\241\062\014\333\201\062\006\140\204\122\146\256"
	"\130\307\136\350\163\111\045\334\132\075\141\102\370\223\324\104"
	"\230\371\006\072\053\023\025\255\105\034\015\312\156\163\170\306"
	"\073\326\257\256\040\324\213\173\021\354\276\012\177\222\117\030"
	"\213\126\122\267\151\147\145\256\203\162\171\362\346\361\271\041"
	"\310\150\320\351\074\133\145\116\107\043\130\307\266\247\337\102"
	"\375\062\372\146\232\137\025\036\321\216\020\270\200\311\332\110"
	"\062\252\062\156\005\227\275\115\273\025\025\161\275\365\263\273"
	"\047\255\042\301\014\070\337\336\306\360\227\107\271\161\220\354"
	"\033\302\132\041\131\030\157\025\056\204\206\353\171\072\247\240"
	"\347\311\142\364\001\101\323\310\061\153\017\353\334\240\327\370"
	"\142\062\031\274\113\210\321\171\015\127\145\206\222\014\047\172"
	"\326\211\156\330\313\102\240\375\256\260\350\212\120\300\203\263"
	"\363\235\157\076\046\101\267\063\231\035\271\053\051\341\245\000"
	"\152\024\330\065\127\171\062\005\051\033\220\172\334\023\055\317"
	"\260\234\016\326\335\306\011\166\343\303\242\015\244\107\015\017"
	"\133\345\104\262\136\166\267\210\222\107\002\156\133\057\075\013"
	"\314\114\341\252\022\353\041\365\257\303\002\124\013\017\143\146"
	"\365\247\031\124\036\320\335\261\030\340\037\163\020\135\177\334"
	"\251\141\207\273\114\251\261\374\154\263\120\170\303\263\336\271"
	"\133\367\016\172\310\353\053\341\313\113\125\334\250\324\270\122"
	"\065\100\016\202\351\277\176\126\163\317\316\067\203\255\360\337"
	"\244\377\132\155\352\206\117\266\321\244\222\172\171\113\315\257"
	"\213\333\061\165\232\260\313\016\200\232\105\003\107\065\343\354"
	"\064\075\132\037\303\251\326\224\116\151\017\310\264\334\167\100"
	"\267\250\266\122\131\201\140\331\034\245\335\143\333\300\117\020"
	"\376\251\060\301\123\007\126\241\160\145\151\045\102\341\145\372"
	"\212\034\114\343\235\255\275\272\123\232\035\057\133\155\077\131"
	"\026\160\033\152\167\161\014\347\327\166\014\031\127\162\023\341"
	"\216\140\305\054\015\202\346\140\035\004\217\171\161\317\323\210"
	"\100\356\362\267\137\377\237\066\165\254\120\315\036\144\256\255"
	"\304\164\332\321\367\301\062\024\305\302\216\066\222\141\277\322"
	"\117\262\211\257\261\050\346\047\325\066\364\363\232\243\241\137"
	"\027\173\060\016\074\143\043\002\045\261\071\267\023\370\212\143"
	"\253\023\022\134\074\370\203\021\057\170\005\312\033\247\051\063"
	"\042\132\102\137\276\145\141\343\027\233\233\053\223\046\216\076"
	"\071\240\233\166\231\037\210\310\227\216\223\263\065\275\347\130"
	"\027\051\270\325\217\032\271\247\265\125\322\110\173\140\207\265"
	"\000\043\054\232\102\265\143\332\103\366\216\171\263\165\322\313"
	"\237\212\241\056\244\132\325\131\260\247\242\053\010\052\341\010"
	"\115\015\243\220\302\006\152\006\375\371\200\260\157\122\174\016"
	"\335\035\075\201\170\022\333\051\272\175\124\302\250\066\313\365"
	"\104\157\206\007\165\360\015\162\352\216\043\131\340\237\147\276"
	"\275\244\077\066\267\032\137\162\230\264\065\101\352\000\067\056"
	"\157\275\065\345\256\305\005\004\001\005\013\031\161\143\120\363"
	"\161\163\270\074\046\146\274\001\321\345\061\336\112\074\071\170"
	"\302\127\117\221\246\317\005\224\037\002\040\175\212\107\016\101"
	"\136\347\217\023\350\041\303\121\346\135\275\272\260\027\324\207"
	"\250\257\031\364\172\256\376\112\013\026\110\316\041\276\352\246"
	"\130\322\110\152\347\117\305\351\122\022\330\357\030\060\274\022"
	"\340\032\022\065\243\366\163\304\277\374\150\130\072\223\232\267"
	"\313\244\126\055\014\254\243\000\051\362\166\070\144\125\057\041"
	"\334\047\150\345\374\374\240\067\360\011\376\143\012\124\325\233"
	"\326\013\161\156\010\230\135\017\225\055\226\257\204\136\077\166"
	"\344\077\173\177\022\010\075\061\354\300\161\206\002\014\213\271"
	"\256\150\001\142\022\055\335\370\045\136\116\140\220\226\074\112"
	"\232\042\352\214\064\205\121\050\073\331\167\033\114\027\240\346"
	"\010\221\307\015\341\277\330\215\361\370\062\365\306\121\234\310"
	"\102\202\044\160\137\135\221\100\364\325\041\033\256\051\033\056"
	"\054\003\310\116\335\151\210\245\012\057\237\333\356\031\220\150"
	"\145\172\106\351\270\100\307\361\021\214\264\174\227\064\211\037"
	"\020\245\051\053\176\232\154\302\217\120\163\045\104\335\244\152"
	"\237\124\312\101\274\233\220\234\027\175\062\204\231\235\062\012"
	"\224\310\315\314\270\075\166\113\157\032\057\235\130\256\366\017"
	"\070\140\333\030\261\217\373\042\004\066\267\376\366\077\175\102"
	"\133\033\147\225\262\171\332\040\110\354\171\075\011\224\175\332"
	"\046\072\347\351\254\155\041\072\202\302\323\134\053\034\260\323"
	"\364\362\216\132\251\223\121\112\170\246\314\225\206\370\105\153"
	"\073\024\025\307\162\254\023\202\211\130\101\002\332\140\147\223"
	"\177\302\272\277\170\261\230\153\370\312\140\364\037\305\357\003"
	"\153\236\116\327\164\254\043\066\022\111\214\261\030\376\343\042"
	"\266\044\037\367\073\001\200\112\330\107\215\106\100\220\362\125"
	"\243\072\212\147\071\240\250\027\031\224\247\131\134\133\246\104"
	"\145\063\363\244\101\202\173\210\261\027\035\075\055\337\365\202"
	"\223\021\107\125\233\331\357\126\327\045\077\130\023\111\073\317"
	"\032\051\241\340\361\066\142\370\363\374\336\256\207\242\303\374"
	"\305\056\346\136\344\127\061\125\213\111\200\030\045\231\025\072"
	"\170\075\325\007\327\123\120\265\234\162\250\274\134\136\370\271"
	"\047\325\102\250\114\264\127\274\247\002\314\365\275\337\111\110"
	"\272\361\317\025\115\010\234\067\227\046\073\020\074\051\060\373"
	"\346\132\115\361\140\025\073\250\141\331\273\242\215\333\304\346"
	"\146\157\342\015\026\270\236\274\324\327\201\250\061\074\340\322"
	"\373\333\203\032\151\054\117\266\010\156\224\155\221\344\142\177"
	"\013\161\170\167\022\250\057\047\160\353\244\107\324\110\300\231"
	"\222\321\245\150\344\142\303\006\154\260\243\307\226\321\225\232"
	"\026\231\350\124\231\200\160\166\364\040\015\010\040\204\016\304"
	"\104\171\056\250\201\362\320\117\342\340\113\201\224\325\057\027"
	"\003\117\056\363\200\205\121\335\352\377\177\241\171\335\273\015"
	"\352\224\063\077\361\301\071\261\135\226\220\251\035\347\257\034"
	"\260\360\067\313\354\072\332\071\355\165\363\146\317\300\035\202"
	"\356\375\007\054\231\346\225\367\115\200\053\122\271\145\236\347"
	"\101\122\350\231\035\323\340\057\027\202\236\021\266\000\274\112"
	"\264\027\273\050\373\336\207\336\000\221\257\276\210\043\254\013"
	"\124\273\342\131\100\072\340\067\263\320\020\015\000\155\124\132"
	"\271\324\220\160\276\111\101\337\323\021\337\201\332\145\063\116"
	"\362\327\224\237\276\330\201\166\053\375\363\061\144\151\227\140"
	"\007\160\243\170\060\243\371\046\310\154\351\121\136\265\352\075"
	"\321\227\153\114\163\071\200\044\054\121\056\371\230\021\254\003"
	"\330\247\274\240\375\254\120\261\150\353\000\154\250\264\333\166"
	"\217\200\340\043\274\237\310\322\132\111\077\366\361\150\000\323"
	"\021\340\320\136\020\170\325\101\021\247\120\164\357\075\340\041"
	"\151\064\350\360\204\210\047\244\345\240\304\117\115\063\234\366"
	"\034\366\224\370\253\104\064\077\310\366\101\343\001\300\143\251"
	"\030\350\160\237\341\260\266\130\062\032\200\260\110\124\365\353"
	"\156\152\073\112\211\200\335\170\361\220\242\121\113\323\104\167"
	"\346\332\141\150\016\122\176\305\045\176\275\213\055\101\317\121"
	"\143\106\211\027\036\354\272\156\310\077\227\125\052\143\354\167"
	"\244\045\101\345\350\036\355\204\314\122\167\227\170\336\335\207"
	"\241\035\023\265\260\303\212\053\014\315\341\063\341\272\165\247"
	"\222\235\255\156\271\177\366\276\217\371\263\013\012\373\061\161"
	"\166\130\357\205\167\315\322\245\266\236\000\225\012\313\303\156"
	"\272\070\171\226\205\211\127\353\331\256\267\157\274\271\145\117"
	"\113\167\035\152\140\224\062\022\242\351\163\221\243\344\165\242"
	"\106\077\101\353\021\362\371\221\233\102\351\074\145\173\076\034"
	"\302\372\230\003\367\336\232\376\057\362\332\007\255\300\232\006"
	"\150\252\141\225\155\160\007\206\051\014\246\257\260\041\161\363"
	"\263\360\370\073\243\103\210\327\353\064\012\200\113\302\164\202"
	"\304\206\063\176\154\261\200\152\241\157\122\174\247\257\232\042"
	"\300\356\362\021\275\151\175\000\172\325\302\247\026\102\356\215"
	"\061\270\002\042\007\116\213\255\031\320\335\060\104\016\005\170"
	"\072\370\337\016\325\143\215\377\335\002\027\054\334\003\354\265"
	"\272\131\277\040\206\250\264\076\137\326\240\230\175\121\163\103"
	"\116\236\253\365\031\131\134\266\120\331\067\015\376\146\256\043"
	"\021\341\325\363\066\052\121\202\263\250\235\010\050\145\052\274"
	"\136\310\021\373\012\200\146\173\040\273\140\053\220\145\175\072"
	"\003\252\077\053\314\052\342\320\213\112\040\023\061\256\260\302"
	"\145\301\363\376\255\120\367\062\264\146\123\047\004\166\303\321"
	"\145\041\264\221\261\327\365\015\137\144\263\351\300\336\120\230"
	"\372\166\235\173\150\175\175\206\100\123\365\142\123\250\205\105"
	"\037\270\001\014\242\251\234\116\203\164\362\155\171\303\336\277"
	"\133\204\232\144\277\147\316\076\147\235\260\203\047\047\155\221"
	"\213\316\005\345\032\375\216\326\165\325\322\073\352\176\120\322"
	"\016\371\047\030\323\075\336\307\113\214\353\160\147\167\263\110"
	"\355\203\070\341\207\023\201\275\055\363\146\113\307\160\060\041"
	"\010\336\320\054\316\365\006\014\234\012\215\322\201\062\130\301"
	"\054\210\026\147\073\120\125\315\077\025\114\055\307\213\353\177"
	"\026\314\064\154\220\025\230\250\312\235\324\116\121\206\064\006"
	"\012\314\043\111\137\001\132\161\104\213\175\330\365\335\216\311"
	"\217\252\123\364\113\371\302\302\212\103\043\275\047\067\233\016"
	"\274\270\274\062\360\037\337\032\202\022\374\202\254\133\145\051"
	"\112\237\054\065\271\254\022\066\046\354\171\175\351\021\173\072"
	"\111\052\365\113\242\055\261\370\272\027\000\036\162\260\135\266"
	"\046\145\071\311\314\251\311\120\255\143\057\135\066\160\305\271"
	"\352\154\112\015\173\256\343\375\221\122\370\235\372\252\102\135"
	"\335\114\273\273\076\041\074\347\035\156\345\344\217\155\150\227"
	"\070\341\000\111\134\125\310\367\261\176\372\275\076\336\242\273"
	"\235\276\251\125\104\072\335\066\072\061\123\225\171\112\205\260"
	"\267\272\275\301\077\174\244\074\131\273\147\264\264\234\340\324"
	"\251\070\234\120\050\157\264\343\256\072\117\264\267\353\122\335"
	"\205\100\222\361\115\251\117\041\357\270\356\353\163\054\015\372"
	"\325\261\223\360\261\056\335\307\076\261\070\100\164\102\017\275"
	"\302\003\050\030\351\161\352\121\261\277\146\173\000\264\264\050"
	"\323\062\006\330\336\145\146\360\052\252\351\173\160\163\020\227"
	"\024\304\014\303\334\242\076\056\066\021\204\207\367\277\237\343"
	"\160\166\212\376\033\337\013\162\032\127\202\107\056\014\374\031"
	"\077\137\053\113\220\072\114\352\246\065\020\116\244\271\040\317"
	"\022\346\177\234\332\050\311\225\354\374\167\227\202\357\066\377"
	"\340\373\020\207\134\050\276\307\312\246\055\125\162\215\057\204"
	"\040\276\373\266\260\377\023\372\260\163\331\333\172\241\326\253"
	"\040\157\053\334\232\313\340\004\317\163\244\250\130\102\304\355"
	"\336\155\324\201\120\012\160\240\024\010\223\256\115\222\127\150"
	"\377\145\331\352\033\321\012\315\364\154\315\342\123\171\201\250"
	"\063\125\326\007\317\275\304\031\240\030\162\315\015\122\021\035"
	"\043\304\001\162\155\061\031\173\261\302\034\301\335\225\121\257"
	"\272\246\301\134\301\104\311\241\304\055\154\356\205\146\072\011"
	"\007\370\047\203\221\354\000\352\154\335\307\011\355\017\227\141"
	"\165\143\307\140\154\272\357\313\000\027\310\333\264\053\336\224"
	"\235\323\121\352\233\210\313\140\323\005\326\151\211\244\117\364"
	"\176\245\372\317\207\260\213\160\072\321\313\067\132\063\127\313"
	"\227\321\354\202\306\236\115\061\143\240\305\256\374\262\300\146"
	"\103\072\321\001\170\127\232\153\322\110\130\103\320\144\062\237"
	"\046\253\120\327\161\343\067\244\077\200\220\101\021\273\335\154"
	"\241\222\055\010\155\072\003\301\363\337\147\201\027\222\146\200"
	"\150\142\314\237\273\121\314\064\165\057\007\170\001\323\277\062"
	"\175\246\256\047\377\337\104\313\155\032\333\370\003\153\343\233"
	"\140\215\064\220\225\312\025\031\365\313\162\160\127\143\221\046"
	"\236\255\373\316\233\262\020\311\220\244\143\356\301\141\245\267"
	"\143\111\106\071\177\301\025\054\216\236\172\013\042\207\210\234"
	"\244\015\005\131\103\166\075\353\314\060\210\235\047\005\344\164"
	"\253\252\207\267\350\342\177\252\156\123\374\161\222\207\234\353"
	"\054\230\001\056\205\373\124\273\356\142\104\305\244\355\370\216"
	"\036\120\245\124\115\316\220\300\354\174\201\040\175\300\045\361"
	"\360\131\277\367\175\363\077\234\255\121\016\235\200\054\247\344"
	"\023\321\121\111\162\256\263\040\315\203\055\252\311\324\343\342"
	"\266\263\322\005\371\311\105\126\047\122\304\341\332\030\200\205"
	"\067\203\272\222\116\143\352\151\026\102\230\120\170\073\163\217"
	"\146\320\245\240\002\317\122\156\216\064\043\142\011\302\013\023"
	"\154\365\067\100\310\251\002\006\237\214\216\372\323\124\364\063"
	"\206\041\335\075\065\264\220\176\046\255\312\117\325\216\203\120"
	"\223\233\112\023\160\341\122\323\357\077\155\065\000\067\261\315"
	"\334\054\342\165\137\231\311\167\022\067\025\052\056\363\325\200"
	"\315\177\377\375\077\217\015\254\367\274\122\357\307\017\210\247"
	"\116\233\273\112\202\320\055\366\316\336\076\217\356\301\300\116"
	"\356\354\355\164\037\000\306\350\163\046\267\015\141\310\150\202"
	"\161\341\121\330\244\336\306\164\215\037\260\126\040\146\311\067"
	"\347\166\115\033\176\130\227\237\140\057\246\106\005\264\361\156"
	"\212\121\142\013\250\235\236\337\121\142\362\053\244\246\076\321"
	"\044\017\066\330\172\131\121\307\363\327\337\023\241\343\335\164"
	"\226\057\221\377\253\074\124\005\024\132\137\225\022\154\215\242"
	"\260\227\064\006\101\301\014\305\061\020\226\375\352\360\107\152"
	"\270\306\077\103\065\363\241\137\277\001\032\233\140\124\327\140"
	"\136\377\117\121\055\223\340\253\114\322\025\113\052\307\200\010"
	"\350\043\014\255\272\163\306\026\023\116\010\263\306\251\315\153"
	"\057\301\112\046\142\212\241\217\374\326\163\216\247\016\341\235"
	"\102\355\326\220\323\040\066\052\050\033\150\231\266\237\257\246"
	"\214\275\373\355\247\356\306\010\311\221\051\143\032\366\041\262"
	"\276\370\202\372\323\300\060\024\326\213\346\002\132\151\314\362"
	"\374\220\066\336\016\165\222\356\001\274\274\105\100\271\126\051"
	"\047\354\240\206\155\266\065\171\154\262\253\011\243\124\232\343"
	"\163\245\325\243\252\136\011\226\322\360\065\143\276\253\074\034"
	"\250\132\275\066\163\265\157\164\234\027\172\013\046\205\137\202"
	"\142\274\364\043\344\161\221\205\101\022\234\112\000\163\210\076"
	"\343\273\245\053\375\146\063\104\041\067\022\121\171\132\351\110"
	"\360\324\346\205\107\255\124\317\366\355\105\363\255\226\020\137"
	"\006\351\261\107\031\173\157\243\207\151\074\327\252\075\103\310"
	"\264\130\074\121\306\000\033\342\235\112\262\006\021\160\347\215"
	"\114\047\100\214\214\355\200\014\343\133\232\264\257\200\364\044"
	"\273\146\137\066\334\263\302\067\130\100\042\255\370\176\227\042"
	"\331\015\135\274\063\252\357\120\004\170\066\273\137\161\227\132"
	"\125\064\017\173\030\125\234\272\251\017\265\170\246\347\337\004"
	"\305\053\171\357\310\012\262\241\223\356\226\146\366\270\034\031"
	"\255\160\250\323\164\311\140\370\366\315\170\214\164\054\101\140"
	"\136\203\135\342\200\110\006\247\005\365\321\257\364\362\100\006"
	"\337\064\356\016\333\356\343\333\223\106\364\070\215\324\110\273"
	"\374\007\302\037\251\356\201\367\117\122\112\324\351\301\373\056"
	"\115\031\241\157\345\102\312\002\352\234\224\252\101\057\144\157"
	"\145\326\052\353\064\143\005\352\046\225\133\230\310\033\241\122"
	"\146\306\211\301\112\246\307\312\204\334\327\165\206\035\226\243"
	"\214\344\060\352\266\351\323\307\065\132\210\033\012\243\171\005"
	"\214\340\235\013\122\237\333\206\307\304\374\255\253\032\060\244"
	"\155\102\233\333\026\144\011\065\241\351\124\374\267\171\267\047"
	"\110\214\026\373\051\105\175\000\122\173\230\324\073\225\105\257"
	"\025\246\057\212\143\317\157\366\251\002\043\010\361\122\047\307"
	"\133\210\350\160\367\130\020\051\141\173\065\235\305\052\267\131"
	"\055\012\106\045\015\311\331\136\147\244\246\066\341\150\140\325"
	"\306\055\347\264\136\204\056\156\103\040\167\353\245\263\307\202"
	"\114\367\223\112\373\132\140\025\016\325\346\046\031\306\204\070"
	"\034\267\313\344\237\107\076\041\331\111\157\000\053\032\234\131"
	"\260\311\252\020\253\272\040\222\346\076\342\225\253\202\326\026"
	"\203\144\236\115\370\137\270\106\000\171\057\067\025\171\044\235"
	"\276\201\067\200\020\225\034\203\162\130\304\270\067\263\173\253"
	"\005\037\145\300\157\246\267\331\154\247\365\104\267\346\267\062"
	"\152\201\154\213\277\005\266\165\245\176\016\357\131\233\100\333"
	"\202\054\244\036\150\250\035\343\342\372\261\122\326\130\333\356"
	"\131\336\302\252\372\210\162\126\365\142\012\313\154\003\362\330"
	"\233\251\363\212\177\003\240\252\205\037\143\310\047\350\216\224"
	"\277\043\027\324\274\105\062\254\207\335\013\150\316\237\204\354"
	"\263\025\161\006\242\170\303\100\054\060\207\223\210\133\242\162"
	"\066\371\123\175\317\360\132\270\111\321\253\024\311\064\143\324"
	"\275\170\160\375\366\242\102\024\216\127\266\154\077\340\073\071"
	"\164\254\151\056\301\347\114\035\277\061\177\101\215\373\025\375"
	"\274\064\321\037\126\304\231\004\243\222\110\104\160\207\146\017"
	"\033\234\112\361\224\275\020\266\371\263\122\160\117\024\255\175"
	"\266\340\103\374\151\271\261\117\136\144\003\261\237\351\116\114"
	"\223\054\234\226\115\234\021\073\036\061\341\154\322\277\111\151"
	"\301\063\357\036\211\054\023\232\120\366\123\075\033\374\304\034"
	"\306\230\147\010\000\260\274\124\022\057\030\275\375\213\143\015"
	"\211\070\331\321\104\250\115\117\211\201\112\143\055\305\024\324"
	"\317\164\023\021\363\022\371\214\142\152\270\053\363\150\352\106"
	"\145\040\173\132\257\351\272\323\202\265\276\370\372\167\360\222"
	"\320\021\067\224\353\050\273\216\310\370\120\244\111\204\165\177"
	"\246\000\307\301\342\342\057\056\320\017\061\355\201\307\104\020"
	"\352\236\114\245\262\151\316\176\321\160\065\057\374\022\355\010"
	"\101\212\362\110\275\164\202\062\304\246\153\111\172\346\316\056"
	"\062\147\305\312\246\041\234\261\221\212\022\304\273\067\074\307"
	"\243\064\335\017\101\250\076\342\021\176\034\352\227\132\375\160"
	"\307\357\131\112\302\157\306\107\322\365\231\017\223\121\310\044"
	"\105\123\143\160\367\114\214\074\315\123\151\166\235\066\006\253"
	"\272\150\265\026\063\363\240\007\135\136\222\221\201\125\242\274"
	"\206\327\030\327\031\374\276\330\114\021\263\353\207\066\233\353"
	"\050\274\103\173\202\060\070\267\206\212\330\123\023\342\141\354"
	"\324\201\124\112\300\362\217\167\134\023\232\361\304\254\356\132"
	"\111\026\207\312\307\247\045\212\152\074\012\072\072\244\037\214"
	"\242\344\102\063\320\327\021\230\151\105\245\221\041\163\201\360"
	"\157\024\040\356\027\123\065\357\067\327\263\021\161\022\127\341"
	"\314\102\126\331\237\154\012\044\134\314\242\326\337\271\370\066"
	"\235\110\074\073\336\344\311\203\214\254\300\310\216\362\040\030"
	"\110\305\062\136\367\244\362\171\264\116\301\132\316\162\251\165"
	"\056\210\041\327\170\334\256\000\140\373\006\176\072\105\265\344"
	"\156\131\236\214\051\062\346\152\336\050\042\304\363\252\366\353"
	"\273\333\224\333\077\047\101\345\332\317\321\001\031\052\356\140"
	"\321\133\255\275\066\074\153\102\120\210\265\013\250\243\122\063"
	"\111\163\117\156\015\322\133\240\151\020\205\321\242\341\104\115"
	"\161\111\027\316\047\041\375\170\357\031\276\377\062\353\305\126"
	"\056\160\162\011\260\235\162\267\010\106\006\343\170\152\326\136"
	"\047\054\225\263\133\071\146\305\063\022\017\236\101\142\052\006"
	"\372\321\320\007\147\165\156\047\124\310\331\303\071\212\317\211"
	"\277\163\133\255\256\265\240\144\012\150\166\037\026\237\233\050"
	"\330\067\323\023\120\101\313\350\211\260\141\271\357\306\234\006"
	"\111\357\373\101\054\061\155\205\160\354\253\321\270\224\236\321"
	"\007\163\377\104\056\345\017\307\253\016\174\331\013\015\152\072"
	"\033\053\265\043\245\306\351\120\244\320\304\373\150\244\372\102"
	"\144\245\310\334\023\122\261\216\241\143\374\340\146\036\070\147"
	"\001\324\237\123\120\356\030\204\247\047\045\056\104\371\260\236"
	"\131\270\114\260\125\310\004\276\065\035\301\371\165\323\043\124"
	"\303\176\344\074\221\062\251\004\165\013\177\076\044\351\041\105"
	"\133\055\222\160\032\353\103\024\045\106\065\302\044\054\037\024"
	"\210\115\370\156\227\110\347\350\243\247\361\171\200\345\367\063"
	"\045\267\157\101\121\106\124\010\327\026\150\376\256\371\067\214"
	"\352\203\251\076\200\271\353\044\331\373\364\310\236\300\135\254"
	"\257\173\335\204\220\372\001\016\103\000\225\040\073\256\023\360"
	"\267\375\115\024\271\076\154\350\274\270\225\311\001\157\261\360"
	"\306\106\100\211\363\027\072\343\204\364\006\332\137\002\053\223"
	"\327\320\363\327\062\255\351\357\114\246\034\001\175\240\277\271"
	"\032\047\067\045\071\124\260\372\220\112\131\275\154\206\302\141"
	"\035\150\247\031\022\343\163\051\013\212\053\374\032\017\025\134"
	"\335\041\323\165\303\122\177\274\206\212\373\243\277\123\204\177"
	"\020\364\064\013\303\060\152\312\050\363\362\263\330\360\335\352"
	"\351\341\261\251\005\150\174\303\314\132\116\066\155\026\032\041"
	"\203\222\044\277\103\125\033\220\231\065\242\170\100\253\343\113"
	"\133\113\202\042\154\163\014\346\341\200\324\115\250\222\163\206"
	"\174\051\171\066\141\205\142\212\061\176\231\004\156\200\300\323"
	"\035\066\075\345\151\034\210\317\073\350\330\145\225\115\251\346"
	"\306\317\302\267\262\133\371\154\007\303\063\244\204\267\334\161"
	"\141\313\062\124\264\351\206\353\325\316\117\247\065\264\072\155"
	"\065\230\200\104\173\115\076\054\123\266\175\263\302\131\062\253"
	"\111\252\074\276\352\103\056\244\315\344\036\256\247\202\276\212"
	"\102\077\215\263\270\322\170\024\355\000\045\073\327\220\337\365"
	"\240\216\255\273\364\313\101\054\317\312\204\161\314\211\137\076"
	"\363\306\276\215\356\270\055\053\321\145\371\377\147\062\153\072"
	"\273\366\322\250\230\004\100\310\121\006\216\232\204\260\144\007"
	"\351\011\340\303\040\266\360\060\342\124\206\044\217\346\020\210"
	"\375\347\020\370\077\377\247\301\215\270\227\235\053\041\057\212"
	"\105\335\251\214\247\043\316\077\376\352\043\034\334\043\025\101"
	"\011\322\324\344\263\324\212\231\260\251\104\014\064\045\142\212"
	"\111\204\247\237\134\272\143\115\330\043\344\101\043\111\134\341"
	"\352\121\356\174\106\277\016\265\225\207\311\354\223\057\160\124"
	"\040\122\167\313\273\145\046\320\374\260\266\304\361\363\054\127"
	"\367\206\273\375\347\204\032\016\012\010\211\267\130\200\226\210"
	"\360\044\334\217\042\355\216\020\161\340\177\362\062\330\215\156"
	"\345\042\022\175\277\004\375\123\255\220\014\245\311\253\011\132"
	"\306\264\325\011\136\132\076\171\352\014\251\030\065\175\104\075"
	"\171\277\231\360\117\035\246\136\330\022\255\110\365\365\340\162"
	"\116\004\267\372\027\214\363\234\113\155\013\100\170\302\245\177"
	"\124\215\045\272\264\141\223\277\031\162\000\317\202\277\142\301"
	"\270\063\165\145\133\365\332\243\217\271\104\140\032\013\075\042"
	"\157\122\170\135\022\360\024\034\206\132\346\333\067\261\150\163"
	"\167\020\305\122\034\066\344\226\062\163\201\317\322\015\352\016"
	"\373\115\220\264\035\037\247\206\215\226\250\317\251\136\010\023"
	"\004\324\120\367\140\215\136\130\141\174\303\046\323\015\152\025"
	"\122\121\022\023\205\174\151\243\252\006\207\252\013\323\370\142"
	"\106\267\156\140\165\236\256\301\111\125\332\125\100\240\233\164"
	"\325\211\121\070\374\231\247\231\077\264\236\206\021\033\261\061"
	"\207\047\303\045\175\373\210\240\051\231\322\273\350\343\266\054"
	"\375\236\171\150\325\244\254\355\277\314\107\275\062\067\020\261"
	"\277\146\106\337\113\170\114\162\366\147\130\023\130\245\144\026"
	"\044\320\116\325\267\364\244\051\374\366\202\050\260\254\342\056"
	"\343\046\256\326\002\003\230\227\267\334\235\023\044\056\114\317"
	"\031\000\140\257\040\355\342\060\161\004\116\011\046\171\207\301"
	"\107\164\164\172\321\363\321\237\065\010\172\004\164\330\006\055"
	"\246\171\072\371\324\025\375\152\142\332\376\177\314\042\327\014"
	"\013\145\343\261\016\017\015\103\037\140\051\356\002\071\014\060"
	"\353\022\066\217\022\323\322\137\317\122\261\003\145\167\372\153"
	"\123\157\373\000\204\323\366\065\012\251\107\127\375\304\375\323"
	"\337\031\134\277\325\320\333\320\366\055\140\026\043\140\112\064"
	"\247\003\246\145\037\354\302\250\271\372\021\020\153\215\037\112"
	"\176\261\023\300\234\155\075\200\214\336\066\056\027\134\340\132"
	"\037\377\365\317\133\257\276\042\261\175\100\050\246\054\231\137"
	"\126\335\245\224\163\146\027\076\105\053\157\350\047\071\127\245"
	"\044\032\262\161\157\237\277\065\322\234\245\025\046\047\265\362"
	"\026\225\075\274\266\206\337\214\305\260\064\103\031\134\201\060"
	"\032\223\326\322\362\211\357\062\005\000\370\041\153\300\026\330"
	"\140\120\101\006\206\132\332\210\325\070\131\366\027\040\246\224"
	"\352\350\146\202\156\302\232\317\061\320\326\174\266\111\272\072"
	"\321\120\330\361\162\356\205\145\042\251\143\204\102\047\176\363"
	"\340\204\224\260\361\236\272\343\323\264\275\117\375\175\201\273"
	"\236\004\035\134\267\242\156\075\170\152\253\034\111\306\214\040"
	"\257\311\167\210\216\324\117\177\235\372\147\061\173\055\134\147"
	"\174\075\072\115\015\212\310\214\306\303\005\054\142\122\047\052"
	"\221\341\015\034\166\141\237\111\241\170\300\344\240\326\060\110"
	"\021\107\324\053\006\375\241\122\022\115\062\100\323\251\036\064"
	"\270\223\307\344\067\340\314\043\333\122\156\347\071\327\240\007"
	"\026\066\155\125\370\361\323\345\273\334\202\277\231\222\172\334"
	"\255\011\036\042\210\014\150\361\206\362\262\356\202\226\141\276"
	"\126\164\053\107\020\006\036\157\224\364\364\317\107\143\336\272"
	"\100\100\245\142\205\066\344\012\043\006\260\147\155\202\326\014"
	"\116\333\225\327\321\020\065\241\041\127\254\344\166\351\010\303"
	"\156\310\306\165\037\064\115\153\006\034\157\361\202\357\202\134"
	"\174\164\172\333\257\102\325\303\016\350\172\346\174\114\363\362"
	"\212\274\207\343\155\351\130\113\233\024\223\274\210\105\044\201"
	"\025\047\325\347\300\340\162\361\346\160\063\066\053\003\242\057"
	"\177\326\375\120\041\302\132\273\361\367\305\116\132\331\305\211"
	"\215\076\027\073\300\261\065\351\160\240\346\375\223\326\344\006"
	"\361\366\013\065\201\021\055\314\236\104\123\122\111\231\100\022"
	"\372\104\007\034\055\071\266\371\344\045\173\313\006\222\235\251"
	"\255\343\345\132\322\006\204\277\074\003\302\372\245\075\224\064"
	"\353\032\170\267\364\004\377\012\163\201\214\041\230\176\161\017"
	"\062\271\013\041\046\276\172\155\060\212\240\133\313\137\202\257"
	"\132\051\217\137\265\072\253\172\331\256\245\027\266\102\200\366"
	"\162\247\021\162\116\003\377\344\025\331\111\243\161\022\372\170"
	"\364\373\147\303\220\267\110\135\335\332\077\261\067\365\233\005"
	"\042\204\276\337\027\261\257\257\123\216\154\340\350\217\102\136"
	"\127\243\113\313\161\226\065\356\177\141\377\345\355\017\046\110"
	"\355\003\131\336\177\002\274\267\105\075\365\346\322\301\071\370"
	"\052\313\322\167\242\075\241\153\113\317\326\071\327\331\373\376"
	"\150\156\054\075\042\013\037\301\163\200\132\252\172\031\125\234"
	"\153\261\154\101\252\032\135\356\151\017\317\343\113\367\371\220"
	"\230\315\133\277\033\171\375\011\271\330\136\127\222\326\103\123"
	"\305\031\153\257\101\316\235\224\125\211\130\140\033\303\033\214"
	"\036\351\221\217\270\344\025\043\062\344\075\374\052\260\123\320"
	"\315\171\205\345\362\006\273\345\071\246\263\370\122\244\122\356"
	"\316\217\106\055\041\341\255\075\110\077\347\166\112\247\107\001"
	"\364\057\316\311\063\320\115\314\135\052\151\146\122\035\262\220"
	"\235\304\174\273\335\372\336\332\327\270\303\037\327\126\065\276"
	"\201\045\104\033\312\172\363\071\115\103\076\073\306\014\326\243"
	"\364\372\044\066\360\033\045\102\330\126\040\242\133\032\114\040"
	"\151\024\327\335\231\033\246\315\334\311\152\272\366\014\106\140"
	"\326\276\001\367\353\344\224\322\206\044\113\153\066\243\362\032"
	"\301\275\064\126\272\323\070\064\205\202\116\204\320\011\131\307"
	"\125\021\012\225\054\315\302\054\206\372\354\233\055\263\303\361"
	"\325\240\033\025\333\006\326\312\241\335\010\005\116\277\125\126"
	"\072\037\200\001\150\114\213\002\222\353\050\253\351\062\267\216"
	"\130\054\365\341\124\366\045\122\171\252\137\256\221\021\127\000"
	"\066\322\132\247\237\104\137\044\120\222\327\273\340\151\205\021"
	"\344\003\237\172\342\317\240\177\252\171\347\351\030\316\347\356"
	"\041\234\247\342\351\064\021\366\227\220\130\336\222\320\031\111"
	"\131\113\101\176\317\103\326\152\040\330\273\354\070\170\030\327"
	"\047\147\265\350\301\170\135\250\330\321\251\372\065\251\325\315"
	"\362\152\205\355\251\222\074\250\233\115\147\377\363\151\164\315"
	"\251\353\074\023\121\231\065\031\306\313\135\330\352\270\161\062"
	"\155\344\311\377\315\211\036\014\126\352\353\355\324\215\054\225"
	"\107\317\353\360\305\366\251\036\231\344\212\242\366\256\362\240"
	"\154\314\172\366\142\177\336\265\026\143\216\214\125\045\313\173"
	"\061\126\352\045\170\346\256\171\103\203\267\274\066\063\044\317"
	"\043\305\360\067\116\364\115\046\017\164\052\032\157\057\033\360"
	"\306\340\025\042\125\131\356\261\171\213\313\031\107\245\176\220"
	"\173\143\314\224\272\304\112\244\326\026\152\250\137\277\011\273"
	"\231\037\143\136\352\237\055\070\325\347\331\221\077\307\364\376"
	"\313\241\104\344\006\101\110\317\377\241\374\346\216\105\054\274"
	"\063\340\234\124\252\064\312\366\061\274\331\260\003\177\276\130"
	"\043\235\101\327\304\205\004\144\335\340\114\370\033\102\255\111"
	"\013\351\275\353\041\340\313\117\021\356\265\016\022\121\001\042"
	"\205\350\325\025\230\153\263\157\371\057\001\213\313\347\146\130"
	"\116\236\003\245\164\273\064\366\157\006\062\064\271\215\337\162"
	"\057\246\223\264\375\053\323\301\064\071\214\213\023\067\160\342"
	"\106\210\037\052\156\345\006\050\126\041\005\060\370\161\267\225"
	"\066\141\270\346\313\071\042\013\260\166\056\311\046\367\327\070"
	"\034\121\164\103\127\230\322\173\361\262\033\130\161\330\375\260"
	"\017\265\313\156\047\144\042\134\245\014\135\334\073\315\231\161"
	"\262\107\264\012\340\206\205\321\071\241\052\252\172\050\133\211"
	"\335\046\367\004\213\031\141\061\046\276\015\141\214\247\322\076"
	"\357\207\111\317\016\317\241\110\160\313\362\352\363\116\163\320"
	"\165\153\325\000\204\067\061\253\365\077\014\202\347\337\301\326"
	"\146\012\246\165\332\107\275\112\022\257\065\006\375\251\327\163"
	"\024\254\163\231\343\245\104\331\344\121\134\313\060\035\242\227"
	"\047\110\014\001\217\311\114\242\171\202\251\167\054\200\352\100"
	"\054\135\332\020\002\036\352\347\160\106\262\240\144\124\070\214"
	"\235\104\216\055\015\332\317\206\135\170\376\211\370\350\312\045"
	"\106\244\066\111\303\041\060\063\150\343\324\314\070\014\130\325"
	"\120\346\002\136\301\322\345\037\112\343\250\103\314\162\151\022"
	"\027\240\133\332\302\213\016\052\156\343\367\246\357\120\174\100"
	"\067\176\237\371\120\204\030\233\150\300\336\064\063\110\106\112"
	"\351\241\045\253\055\063\325\234\027\315\103\006\035\277\107\125"
	"\075\346\116\215\153\146\051\324\046\010\010\131\120\117\244\071"
	"\361\311\345\036\375\273\273\024\210\376\033\246\275\143\373\372"
	"\111\111\210\265\260\262\211\327\272\222\061\013\342\325\105\323"
	"\237\052\362\234\345\255\261\156\253\314\024\151\057\020\144\171"
	"\132\355\057\012\237\270\341\131\113\022\144\055\350\252\000\207"
	"\324\363\044\272\241\325\050\115\242\074\266\322\114\032\113\246"
	"\007\173\261\246\063\223\000\177\246\145\254\216\017\255\026\343"
	"\241\072\235\102\020\305\217\262\002\106\204\117\140\320\366\150"
	"\113\247\016\177\072\017\376\340\164\253\157\203\131\205\147\372"
	"\300\005\075\320\313\315\202\315\023\007\034\163\327\023\333\043"
	"\272\352\242\365\371\241\325\156\115\105\361\247\312\130\242\213"
	"\136\337\133\051\254\335\366\277\344\023\063\274\046\017\337\341"
	"\372\202\326\363\044\254\142\161\362\123\030\274\254\273\107\012"
	"\232\243\064\107\200\052\007\145\076\072\041\145\112\001\107\104"
	"\203\035\070\247\312\232\031\274\355\062\171\232\355\301\245\210"
	"\144\331\320\345\004\327\112\103\022\154\250\134\155\357\241\360"
	"\015\331\230\330\163\262\224\141\344\015\374\322\317\241\132\063"
	"\173\052\030\177\002\143\302\024\317\153\161\074\133\022\055\151"
	"\353\306\101\137\170\326\300\134\343\275\057\263\136"
#define      chk1_z	22
#define      chk1	((&data[8316]))
	"\264\377\131\267\142\106\311\316\022\031\207\314\003\237\016\147"
	"\220\063\001\357\212\270\367\204\123\331\240\034\314\061\210\076"
#define      lsto_z	1
#define      lsto	((&data[8343]))
	"\217"
#define      rlax_z	1
#define      rlax	((&data[8344]))
	"\314"
#define      opts_z	1
#define      opts	((&data[8345]))
	"\347"
#define      tst2_z	19
#define      tst2	((&data[8347]))
	"\066\056\224\104\201\363\260\203\216\211\013\116\046\326\246\212"
	"\057\075\320\315\111"
#define      date_z	1
#define      date	((&data[8367]))
	"\227"
#define      shll_z	10
#define      shll	((&data[8370]))
	"\122\244\223\130\323\374\077\103\031\032\216\036\342\254"
#define      inlo_z	3
#define      inlo	((&data[8382]))
	"\311\311\014"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
