#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f /home/wetsock/coding/ez-scripts/git-all/git-all.sh -o /usr/bin/git-all 
#endif

static  char data [] = 
#define      msg2_z	19
#define      msg2	((&data[4]))
	"\047\355\034\246\331\124\024\243\034\365\370\103\233\032\126\371"
	"\005\061\334\210\152\317\001"
#define      chk2_z	19
#define      chk2	((&data[24]))
	"\145\327\100\133\064\021\272\200\030\107\274\367\000\231\031\354"
	"\114\336\353\100\026\055\323\000"
#define      lsto_z	1
#define      lsto	((&data[47]))
	"\004"
#define      tst1_z	22
#define      tst1	((&data[51]))
	"\277\300\213\360\121\345\232\333\031\022\161\345\217\026\110\220"
	"\073\113\051\122\073\355\004\267\115\025"
#define      pswd_z	256
#define      pswd	((&data[84]))
	"\070\333\241\332\304\245\001\261\302\250\021\051\005\027\361\060"
	"\220\312\137\126\253\257\330\226\172\052\110\171\325\345\273\207"
	"\135\066\271\366\035\121\376\257\273\020\331\300\047\312\360\267"
	"\225\117\015\100\377\346\327\172\020\040\364\346\005\257\155\143"
	"\346\047\131\003\170\130\262\063\150\214\364\217\126\345\107\354"
	"\065\124\055\064\072\005\257\113\045\243\062\052\122\237\216\070"
	"\306\347\073\077\100\356\162\250\172\146\067\321\114\176\276\201"
	"\323\353\266\016\360\145\132\025\010\214\100\133\054\317\223\362"
	"\266\317\061\367\276\244\237\071\013\327\013\127\125\311\330\051"
	"\265\216\070\246\364\222\274\374\036\374\130\112\313\354\075\202"
	"\273\157\171\172\023\031\264\037\360\277\166\106\211\117\157\077"
	"\336\247\345\322\071\241\317\130\236\047\242\152\023\340\355\317"
	"\117\146\112\143\200\376\203\160\276\371\266\107\111\045\207\050"
	"\315\154\372\007\016\312\137\254\362\002\026\005\342\003\325\062"
	"\152\040\226\353\036\031\133\334\023\021\044\134\067\254\204\004"
	"\030\177\014\046\112\153\323\074\156\352\102\120\355\027\203\130"
	"\067\031\103\126\062\237\063\105\260\130\252\006\231\020\035\307"
	"\343\036\067\007\014\276\257\124\176\160\340\224"
#define      xecc_z	15
#define      xecc	((&data[358]))
	"\200\341\365\333\375\042\325\016\376\120\076\010\101\026\237\234"
	"\346\177"
#define      chk1_z	22
#define      chk1	((&data[380]))
	"\171\134\350\042\303\264\212\005\221\340\060\114\326\123\243\104"
	"\242\037\365\233\344\161\245\004\123\102"
#define      msg1_z	65
#define      msg1	((&data[417]))
	"\027\013\203\372\051\272\002\066\171\262\213\367\042\153\213\056"
	"\003\117\133\174\213\335\025\320\370\221\324\246\257\000\112\344"
	"\130\365\055\102\333\021\245\201\011\012\032\145\160\061\317\136"
	"\363\171\334\175\067\244\303\237\051\220\153\304\366\224\065\165"
	"\005\001\034\236\025\122\327\161\206\271\251\175\230\124\122\370"
	"\206\166\151\043\135\350\233\010\015\024\144\365"
#define      shll_z	10
#define      shll	((&data[495]))
	"\363\236\077\073\106\167\037\371\211\251\352\202\357"
#define      rlax_z	1
#define      rlax	((&data[507]))
	"\311"
#define      date_z	1
#define      date	((&data[508]))
	"\147"
#define      opts_z	1
#define      opts	((&data[509]))
	"\127"
#define      text_z	6286
#define      text	((&data[1036]))
	"\056\334\277\227\000\035\200\233\045\215\257\211\203\346\365\147"
	"\332\170\127\121\365\161\202\166\302\056\251\236\321\376\347\377"
	"\333\246\227\333\303\030\167\351\245\047\163\051\015\150\220\347"
	"\340\350\070\326\131\273\115\033\352\366\272\273\365\241\273\320"
	"\110\123\254\013\153\044\365\020\113\150\072\130\320\312\100\261"
	"\262\171\210\014\065\325\047\037\313\342\332\301\203\225\222\314"
	"\350\076\330\124\142\315\144\256\065\236\006\006\151\107\270\034"
	"\300\100\050\366\026\120\025\342\062\360\243\266\205\065\202\156"
	"\164\132\302\327\050\047\205\135\306\214\143\060\323\034\115\224"
	"\134\165\213\163\306\240\125\371\220\371\260\026\057\062\205\244"
	"\215\110\173\266\160\001\023\067\216\167\147\142\223\264\367\360"
	"\052\202\144\361\042\272\352\263\263\232\312\343\315\117\207\133"
	"\230\003\021\010\004\044\100\222\234\250\364\060\134\353\040\207"
	"\156\204\171\220\077\143\104\362\376\016\326\313\136\135\046\366"
	"\140\067\377\145\134\077\370\371\347\354\051\104\330\112\314\106"
	"\317\105\327\016\250\033\000\246\052\326\162\210\064\230\176\224"
	"\320\175\372\055\275\362\046\244\336\120\350\267\232\265\376\151"
	"\372\326\167\243\362\170\111\034\117\274\244\203\124\042\030\045"
	"\240\022\123\136\004\172\002\343\312\353\233\145\240\232\316\232"
	"\160\106\075\142\276\207\176\016\103\043\222\230\106\252\276\346"
	"\275\022\105\302\214\107\246\127\063\101\274\323\333\213\156\114"
	"\322\254\256\221\064\055\237\170\120\061\021\226\334\317\175\232"
	"\342\302\134\156\012\002\306\075\104\203\021\040\017\200\154\341"
	"\055\033\162\141\111\021\331\232\103\353\061\040\272\256\273\234"
	"\161\027\013\174\032\322\272\136\125\313\177\145\114\353\106\171"
	"\007\270\332\120\312\264\352\016\237\033\057\132\312\352\367\074"
	"\002\003\270\034\325\163\173\053\076\372\220\212\346\326\003\355"
	"\217\336\075\132\223\050\151\062\104\230\215\016\202\204\113\204"
	"\207\004\241\135\167\034\210\266\027\030\100\375\357\104\352\177"
	"\043\050\331\266\120\102\351\224\333\166\243\136\373\356\342\202"
	"\362\204\340\152\240\150\040\267\201\141\265\161\246\237\360\311"
	"\307\312\200\030\015\151\255\350\337\120\106\333\077\051\135\062"
	"\255\076\234\116\246\275\006\050\036\273\232\304\132\212\053\224"
	"\065\013\064\033\124\302\047\006\333\022\030\072\341\135\135\240"
	"\310\312\100\003\032\334\330\227\017\102\306\317\255\336\076\276"
	"\110\313\336\150\317\304\020\075\205\250\036\145\243\304\124\071"
	"\277\046\204\372\155\127\003\353\030\342\152\305\171\333\342\112"
	"\232\010\244\014\236\122\174\351\031\250\314\310\117\265\243\210"
	"\232\044\301\317\033\061\242\201\014\223\377\225\025\300\004\061"
	"\226\174\120\360\306\007\226\316\353\163\226\015\326\273\123\200"
	"\363\223\126\175\257\001\206\234\312\334\175\344\077\331\366\173"
	"\221\337\117\072\317\046\110\111\236\103\170\065\272\037\006\152"
	"\147\346\146\345\112\371\166\301\145\163\031\345\363\131\103\315"
	"\333\323\212\050\104\117\251\252\351\256\337\005\335\347\241\017"
	"\137\105\327\361\051\251\346\034\273\036\324\071\165\127\240\203"
	"\147\063\356\005\017\377\026\072\376\021\147\042\023\165\111\142"
	"\127\252\040\030\007\342\275\335\270\140\214\066\057\066\152\257"
	"\323\356\325\264\045\060\151\230\002\171\353\237\215\040\047\060"
	"\217\126\315\103\062\346\156\316\025\156\265\370\010\055\140\073"
	"\265\036\046\321\243\110\207\104\050\027\226\211\245\366\054\001"
	"\257\057\051\331\354\244\363\255\234\117\265\054\211\341\144\377"
	"\164\321\015\210\007\250\325\017\053\201\127\060\010\046\137\137"
	"\325\171\225\337\166\376\070\052\165\051\252\302\300\171\243\266"
	"\367\306\337\323\042\354\212\375\061\255\005\302\376\330\333\034"
	"\354\210\166\337\315\020\023\313\274\332\345\012\246\045\273\306"
	"\225\002\254\251\031\020\171\305\044\115\037\110\360\163\231\013"
	"\355\177\163\156\361\055\057\313\367\134\314\253\042\051\254\257"
	"\167\365\061\066\220\343\231\077\107\110\341\257\105\267\327\322"
	"\156\337\344\331\116\100\160\241\221\322\240\231\353\025\202\114"
	"\351\222\317\134\145\143\064\010\106\173\260\124\144\153\271\107"
	"\371\006\033\267\313\004\053\135\355\202\131\031\105\215\040\050"
	"\206\203\016\265\334\176\111\352\252\314\103\024\272\000\114\102"
	"\032\160\074\366\031\050\313\174\144\275\225\036\100\175\206\255"
	"\077\057\330\011\234\372\346\214\012\102\063\140\230\336\115\201"
	"\257\152\065\104\257\360\274\046\160\027\345\147\373\054\156\106"
	"\107\253\316\102\306\033\144\063\131\211\347\253\112\355\042\353"
	"\313\075\103\061\220\040\140\172\126\331\212\017\107\323\352\355"
	"\030\352\114\076\366\061\127\223\200\245\130\143\332\024\164\253"
	"\046\141\241\034\116\211\300\055\060\155\112\072\275\131\205\256"
	"\112\062\102\263\242\101\344\007\372\005\357\355\232\033\176\252"
	"\100\113\105\300\173\340\072\334\106\246\272\321\250\052\273\316"
	"\055\134\202\244\156\132\236\244\276\220\322\200\342\076\327\064"
	"\141\200\241\051\175\227\133\160\123\157\052\175\276\263\027\247"
	"\336\214\043\244\347\124\335\145\021\070\153\374\340\140\345\324"
	"\073\227\166\171\067\335\073\230\110\003\031\345\227\172\351\117"
	"\234\315\150\364\370\201\106\143\334\226\174\031\110\035\146\150"
	"\340\241\237\235\361\041\342\230\260\111\002\117\346\116\132\020"
	"\202\044\027\356\356\102\072\002\072\237\021\111\312\031\303\266"
	"\371\100\311\306\371\172\346\016\165\146\052\033\317\001\033\067"
	"\107\151\005\203\230\003\237\260\272\337\264\107\111\120\363\206"
	"\124\033\104\135\145\354\106\106\360\334\314\371\273\110\273\324"
	"\177\030\216\120\107\140\102\152\126\370\230\332\144\076\162\174"
	"\041\111\320\043\031\120\012\075\336\223\243\172\256\245\104\300"
	"\315\266\041\073\227\221\000\133\204\315\210\261\002\145\052\044"
	"\211\272\326\107\037\273\134\077\145\224\233\224\324\143\324\225"
	"\044\346\144\205\163\303\043\000\223\031\016\010\010\253\301\257"
	"\324\042\174\353\226\327\075\225\240\204\310\116\041\116\202\136"
	"\206\226\272\026\053\034\321\167\171\305\063\341\375\073\142\342"
	"\015\055\325\323\233\363\357\074\322\105\105\206\271\203\256\133"
	"\327\307\007\113\246\007\273\101\143\037\150\211\271\365\234\026"
	"\065\145\152\167\231\257\103\000\077\022\075\114\074\262\355\041"
	"\306\362\172\117\044\055\024\111\270\064\373\214\172\163\315\077"
	"\007\377\031\176\026\161\311\000\311\140\130\115\066\353\240\060"
	"\275\267\105\275\300\154\200\060\162\111\271\071\105\250\217\350"
	"\014\150\117\136\326\005\245\020\261\046\257\253\355\305\243\112"
	"\330\310\172\027\170\376\167\373\157\350\173\373\312\257\314\073"
	"\301\252\024\247\134\300\063\117\304\322\247\265\102\117\223\250"
	"\336\052\224\222\172\143\256\331\055\236\142\074\231\014\271\021"
	"\342\205\016\062\365\203\227\205\331\212\373\231\113\023\066\300"
	"\224\046\344\202\353\250\133\335\162\005\160\135\355\015\212\122"
	"\207\123\302\273\235\027\233\025\326\315\334\032\147\142\217\001"
	"\101\255\015\324\030\265\220\150\112\163\153\100\237\113\356\213"
	"\003\311\256\003\066\231\276\100\356\001\207\144\051\063\131\246"
	"\246\374\225\254\231\053\363\075\205\040\076\066\373\240\305\251"
	"\155\250\234\213\134\124\323\043\004\174\057\010\022\326\363\321"
	"\025\122\131\164\316\270\370\270\303\200\360\130\113\134\100\100"
	"\311\032\277\131\041\036\367\335\042\152\363\270\242\031\103\230"
	"\123\276\347\316\052\222\177\313\265\130\371\031\154\041\270\213"
	"\274\164\276\362\214\146\151\130\020\276\173\172\040\034\300\216"
	"\342\272\101\316\111\334\045\115\351\352\356\152\352\334\236\072"
	"\010\377\305\123\204\227\360\075\160\151\066\031\032\012\362\307"
	"\314\370\311\215\170\136\347\322\313\210\011\035\056\207\205\006"
	"\277\167\236\176\234\037\057\325\047\144\203\232\235\063\232\025"
	"\231\276\267\114\171\312\112\126\121\000\307\344\265\106\157\131"
	"\000\346\163\323\307\153\305\300\275\001\044\315\000\050\311\073"
	"\107\036\322\024\331\363\265\327\150\166\006\206\103\067\116\114"
	"\304\325\140\113\303\117\056\336\110\061\320\124\205\075\270\074"
	"\155\167\213\131\116\044\257\101\126\007\237\336\000\057\131\220"
	"\166\176\315\370\025\015\072\316\006\306\062\046\202\276\171\115"
	"\355\006\271\176\106\377\214\271\360\076\330\232\155\153\017\224"
	"\330\271\303\155\042\335\133\057\005\017\152\073\343\314\071\200"
	"\201\134\235\120\234\311\035\372\373\124\030\263\123\151\155\216"
	"\172\367\305\146\142\202\046\155\162\067\012\004\235\223\342\361"
	"\077\321\122\231\230\254\132\245\306\357\200\172\214\255\041\020"
	"\002\344\270\127\147\117\273\041\072\002\177\015\370\162\207\371"
	"\223\207\015\135\176\111\023\345\327\140\260\066\237\042\275\243"
	"\263\354\241\102\100\277\224\152\271\064\053\214\077\005\043\236"
	"\131\227\336\204\240\304\302\035\305\130\156\166\222\037\277\064"
	"\265\021\170\275\115\264\163\071\147\066\372\113\060\011\152\252"
	"\126\321\226\335\223\035\302\137\110\063\263\057\101\314\351\144"
	"\202\204\335\130\252\053\267\143\157\130\205\321\220\316\132\124"
	"\014\105\117\244\032\056\055\235\223\212\301\205\127\254\374\305"
	"\200\372\231\217\213\014\107\130\024\051\054\103\224\255\074\237"
	"\171\356\127\057\342\014\143\330\246\313\045\341\017\257\155\076"
	"\122\221\257\063\265\025\163\303\015\266\240\353\150\021\333\170"
	"\261\315\267\377\102\053\016\220\325\010\230\061\220\174\304\212"
	"\021\223\053\057\036\212\112\013\204\347\255\335\323\372\314\352"
	"\031\335\035\247\306\161\371\021\110\030\350\304\303\232\203\304"
	"\234\022\167\222\145\225\326\206\344\126\153\102\304\205\232\222"
	"\161\341\116\253\321\367\313\311\202\163\203\255\373\065\016\355"
	"\103\173\115\307\054\375\115\371\001\315\217\332\337\204\063\051"
	"\210\000\137\113\327\343\065\241\347\023\317\031\174\040\144\067"
	"\041\163\154\377\021\367\362\136\273\155\233\146\114\102\174\107"
	"\027\127\351\070\266\361\042\050\267\051\177\377\135\123\372\343"
	"\037\335\331\034\056\062\152\303\043\001\366\067\126\121\065\304"
	"\340\217\221\217\254\230\341\163\256\243\053\030\200\375\101\133"
	"\363\271\301\261\175\342\364\327\310\217\145\154\330\153\007\206"
	"\334\244\334\130\305\312\113\377\167\152\002\075\132\332\375\264"
	"\371\135\303\117\070\003\275\222\170\077\004\141\241\342\140\154"
	"\142\305\225\154\367\320\264\152\356\374\350\075\112\212\222\116"
	"\135\015\361\106\253\056\251\110\005\300\025\036\350\076\201\201"
	"\123\214\314\253\116\066\011\072\312\344\345\352\056\173\114\045"
	"\267\124\346\035\360\036\367\224\366\212\221\247\062\325\247\355"
	"\052\326\224\024\207\311\010\114\304\214\167\256\116\340\361\276"
	"\255\221\310\340\236\302\100\217\166\035\274\014\142\165\124\153"
	"\143\255\176\225\031\012\340\143\354\267\314\254\154\177\267\366"
	"\342\305\103\143\371\242\151\216\127\165\040\163\222\362\263\041"
	"\124\245\011\140\170\363\144\040\245\303\351\321\046\335\103\354"
	"\357\052\340\002\345\275\224\062\165\050\032\255\243\202\277\034"
	"\322\226\312\142\033\371\252\355\157\316\267\050\166\043\326\171"
	"\352\117\202\213\027\026\177\227\346\026\173\073\245\070\010\023"
	"\276\301\102\231\163\011\256\035\306\205\137\312\065\162\167\172"
	"\166\207\247\240\212\120\216\226\004\211\352\317\007\317\013\171"
	"\122\036\310\053\124\307\027\020\070\246\066\017\164\240\071\250"
	"\146\232\222\012\222\274\145\275\113\002\224\164\316\362\047\367"
	"\220\361\147\136\321\334\124\066\213\262\012\333\222\010\302\211"
	"\305\327\157\164\200\117\024\173\012\017\325\142\132\373\155\143"
	"\105\040\236\073\031\143\240\325\251\030\017\371\121\374\117\016"
	"\171\251\242\071\033\011\354\353\252\264\121\265\053\217\122\216"
	"\076\374\142\136\345\062\335\120\025\314\167\266\053\045\005\321"
	"\302\120\235\200\362\376\075\105\246\252\015\034\342\307\031\307"
	"\122\036\121\243\307\100\077\273\310\322\272\150\211\324\107\100"
	"\157\010\212\215\345\340\074\307\345\263\150\176\155\315\235\072"
	"\220\166\053\333\023\117\050\052\120\154\271\357\325\032\264\001"
	"\337\076\351\151\043\033\367\031\242\272\202\305\354\371\242\052"
	"\171\101\354\051\141\332\362\156\347\107\042\213\023\245\041\072"
	"\036\074\205\327\065\067\256\367\054\144\316\105\267\327\314\066"
	"\264\373\060\232\346\121\317\047\133\271\100\242\306\127\057\326"
	"\012\377\303\113\163\036\303\160\364\211\125\110\005\256\246\353"
	"\252\146\132\252\354\057\115\300\044\101\333\264\315\152\170\225"
	"\034\224\036\076\066\022\062\171\320\256\013\071\114\250\230\243"
	"\024\034\032\072\334\112\346\305\275\301\177\135\276\204\333\376"
	"\301\070\163\263\100\305\347\361\247\076\006\305\340\045\116\004"
	"\013\115\205\132\074\150\133\003\314\250\147\116\051\251\345\312"
	"\244\121\236\022\343\336\177\103\316\106\005\133\344\266\274\115"
	"\206\174\336\113\342\104\346\001\107\003\026\301\201\005\377\154"
	"\305\175\165\213\272\334\331\120\050\234\214\063\252\204\077\021"
	"\116\341\005\003\256\363\226\104\240\004\033\045\344\032\316\341"
	"\334\051\345\154\227\125\112\006\273\210\052\044\113\116\101\352"
	"\003\310\065\132\333\001\125\123\171\332\212\305\253\115\200\023"
	"\011\023\376\257\274\243\070\140\260\010\060\237\077\130\211\341"
	"\204\155\343\011\204\231\205\131\047\077\160\206\331\135\154\345"
	"\301\331\311\313\370\345\273\257\304\323\125\211\367\006\065\164"
	"\025\230\312\003\351\065\242\026\166\035\375\353\217\120\315\161"
	"\047\223\170\224\265\361\137\203\332\306\272\054\044\250\350\233"
	"\161\070\150\366\236\033\061\233\050\122\242\317\331\153\310\112"
	"\144\315\225\067\071\026\152\263\253\305\337\236\245\270\241\316"
	"\251\305\304\177\114\004\040\165\150\124\164\171\200\360\161\147"
	"\333\334\221\126\141\025\126\175\072\237\335\232\077\157\020\352"
	"\216\012\152\263\342\063\032\357\325\201\136\146\124\020\024\306"
	"\115\361\111\325\351\227\200\336\133\233\137\167\026\263\047\037"
	"\334\273\270\022\312\220\334\117\035\251\031\151\315\031\332\270"
	"\236\371\256\323\006\263\305\117\365\003\335\310\223\255\056\241"
	"\145\362\215\034\075\003\214\057\251\214\066\347\255\376\221\023"
	"\206\175\060\374\005\303\025\264\007\277\323\305\200\141\174\150"
	"\274\044\027\272\116\321\133\027\241\312\005\075\123\230\165\244"
	"\330\250\177\116\162\276\233\253\164\170\253\003\111\173\217\171"
	"\171\251\342\030\360\037\234\054\345\376\071\261\225\030\321\027"
	"\164\241\260\225\077\147\335\015\172\242\036\157\352\223\046\353"
	"\323\361\331\146\144\101\172\203\201\126\325\324\150\063\070\035"
	"\302\111\074\134\165\146\150\052\235\273\274\307\006\034\312\100"
	"\374\123\062\311\326\341\013\214\207\371\320\031\320\371\236\066"
	"\343\041\012\367\313\063\151\065\207\230\116\234\060\164\015\140"
	"\117\232\006\030\272\054\101\065\177\022\301\060\341\276\067\341"
	"\160\104\000\167\045\217\253\375\163\033\250\374\245\020\275\237"
	"\357\232\311\137\012\377\375\112\117\022\112\255\111\270\365\266"
	"\203\362\341\225\174\274\212\104\313\151\046\041\076\004\233\310"
	"\257\036\145\133\206\160\011\026\154\360\335\320\222\240\371\062"
	"\344\061\057\041\060\076\274\226\356\061\156\345\357\273\057\244"
	"\113\127\164\066\205\015\165\310\127\352\355\242\054\260\364\135"
	"\211\030\262\072\215\270\374\257\127\355\040\213\027\260\367\303"
	"\006\322\261\341\247\344\326\123\004\015\067\010\144\217\037\156"
	"\250\233\362\314\040\245\273\027\341\057\131\103\065\171\237\207"
	"\237\055\356\333\035\104\203\030\227\336\224\311\200\030\256\310"
	"\067\312\217\301\172\267\055\060\254\226\146\165\055\000\302\265"
	"\074\300\352\247\152\037\142\132\276\066\357\163\353\027\372\235"
	"\136\261\335\075\115\342\100\232\075\007\222\260\230\373\310\232"
	"\265\206\056\066\236\105\327\103\121\344\363\017\127\043\370\222"
	"\224\372\006\142\366\055\035\272\364\160\265\211\220\223\253\140"
	"\040\101\260\236\126\072\217\363\077\011\165\351\152\213\334\173"
	"\344\310\172\247\155\026\372\042\113\175\045\317\265\127\147\017"
	"\374\251\013\221\236\151\336\254\152\153\141\034\345\223\012\020"
	"\040\226\076\027\117\160\145\052\112\027\334\022\021\251\307\255"
	"\043\007\115\236\375\033\361\105\061\203\331\360\135\115\220\067"
	"\367\013\340\313\367\351\117\171\246\262\160\331\243\227\374\110"
	"\324\243\012\030\007\354\302\037\322\042\374\014\201\337\243\205"
	"\020\177\170\175\303\370\236\272\374\270\337\155\004\335\057\253"
	"\170\101\364\034\154\035\074\175\210\352\063\271\023\355\344\337"
	"\046\003\327\323\264\015\136\165\262\050\240\245\313\003\204\262"
	"\330\022\142\165\310\210\377\273\340\265\330\251\126\300\017\205"
	"\040\113\322\216\036\222\274\067\310\152\357\376\165\233\374\037"
	"\131\354\336\132\044\211\377\272\074\344\302\313\150\015\004\123"
	"\217\146\265\357\156\002\160\350\246\062\173\071\341\263\131\334"
	"\151\047\271\333\007\045\372\264\356\343\372\206\167\362\047\146"
	"\002\147\122\016\152\135\245\235\252\215\317\026\257\124\066\300"
	"\325\132\020\133\367\023\140\155\373\141\272\212\341\301\173\033"
	"\170\364\106\360\170\202\236\272\104\072\122\315\377\024\147\241"
	"\372\152\105\133\325\101\017\030\123\154\051\075\045\232\052\335"
	"\275\022\254\221\340\047\103\211\222\354\263\046\257\044\023\360"
	"\303\117\153\257\240\036\135\341\135\333\226\160\106\277\200\160"
	"\005\356\356\010\247\027\032\124\326\373\155\314\326\054\152\032"
	"\237\027\224\257\117\347\165\324\132\032\323\267\315\046\145\215"
	"\373\277\130\111\076\012\344\100\033\123\333\377\374\226\064\114"
	"\244\305\022\362\251\255\115\030\271\210\072\030\003\003\154\067"
	"\145\026\027\101\323\203\234\152\165\366\053\215\342\045\131\047"
	"\113\025\153\216\363\241\051\305\231\165\326\203\016\264\033\256"
	"\173\273\355\271\056\147\155\254\043\042\326\242\156\301\247\267"
	"\375\244\051\131\173\112\173\074\377\171\307\044\166\315\307\352"
	"\042\110\245\235\373\334\050\233\154\264\310\033\202\123\226\123"
	"\243\044\300\206\132\317\007\265\235\376\361\152\253\060\265\301"
	"\374\242\050\153\333\317\056\124\045\020\244\000\126\362\236\074"
	"\265\235\126\003\075\173\017\142\206\131\207\166\161\153\141\266"
	"\160\326\300\306\115\013\116\224\064\217\104\377\006\114\374\354"
	"\016\355\363\056\015\157\047\231\371\170\025\062\052\055\163\177"
	"\323\142\170\140\016\241\006\140\170\342\127\144\347\363\254\226"
	"\032\146\272\332\151\320\246\341\364\161\161\324\152\016\245\364"
	"\105\355\316\100\356\111\072\250\074\174\350\115\000\161\171\045"
	"\214\046\202\033\150\117\155\360\315\166\151\022\014\035\374\271"
	"\356\117\073\135\225\216\343\375\377\276\157\305\255\153\131\000"
	"\332\160\212\143\033\313\134\334\361\351\205\073\303\232\137\245"
	"\150\005\341\173\311\035\015\266\331\127\052\147\102\335\367\052"
	"\042\121\102\107\116\033\303\350\036\236\362\263\371\070\000\275"
	"\275\105\113\321\151\203\074\001\166\011\373\233\060\176\110\011"
	"\014\212\103\127\364\154\053\113\031\147\001\200\336\307\303\076"
	"\173\246\241\254\100\210\164\044\043\361\266\302\056\327\310\200"
	"\037\163\135\306\353\073\164\201\341\373\007\303\231\174\150\157"
	"\277\027\302\153\374\005\032\274\004\344\141\164\332\063\364\230"
	"\302\312\340\163\110\173\334\334\164\334\302\277\352\036\050\126"
	"\343\024\243\376\053\363\356\163\336\373\231\244\235\146\162\252"
	"\201\076\212\176\112\247\203\376\043\222\023\057\272\204\350\237"
	"\355\015\116\220\302\367\305\056\360\215\341\056\037\066\022\100"
	"\146\376\274\105\207\126\021\351\251\213\163\266\204\005\124\115"
	"\016\173\356\252\270\055\302\001\236\242\250\344\375\100\340\025"
	"\103\352\320\325\205\310\073\035\226\333\142\324\244\215\120\072"
	"\110\103\207\315\351\042\111\251\345\355\047\337\367\104\366\230"
	"\354\020\117\307\035\221\342\235\173\316\331\345\146\166\313\062"
	"\223\023\053\343\354\013\234\031\361\072\257\015\345\115\142\062"
	"\062\350\172\256\333\361\013\140\146\340\214\345\040\060\335\170"
	"\006\154\100\161\145\300\311\125\264\262\110\136\321\304\313\257"
	"\242\115\063\012\312\376\366\005\156\350\202\117\003\377\112\051"
	"\354\126\021\054\153\317\117\026\010\377\174\347\131\163\112\026"
	"\101\343\256\353\235\337\114\153\237\355\337\113\163\055\066\113"
	"\024\342\207\164\301\231\233\117\000\203\075\341\176\051\045\374"
	"\256\326\307\132\032\113\166\107\274\037\315\333\364\101\067\120"
	"\216\146\210\363\311\360\171\001\205\056\077\170\247\117\040\250"
	"\125\262\234\254\024\245\163\013\344\130\013\111\267\140\346\374"
	"\221\257\311\332\210\332\260\022\341\143\145\265\006\127\247\143"
	"\033\016\105\043\164\170\247\003\043\045\167\211\136\323\306\076"
	"\325\377\146\044\116\214\007\375\271\365\024\136\223\050\377\165"
	"\047\313\147\051\326\246\277\276\111\146\256\244\124\110\221\272"
	"\236\270\117\017\110\103\250\260\226\166\074\336\323\322\146\023"
	"\124\366\073\304\017\374\272\224\016\036\075\231\164\021\341\066"
	"\253\021\104\311\172\127\272\274\214\143\326\317\121\160\075\023"
	"\122\306\112\232\353\015\073\140\375\301\375\261\046\344\305\053"
	"\267\211\114\043\120\200\267\005\350\072\064\346\352\133\365\377"
	"\334\065\263\133\342\256\367\206\261\154\233\127\206\212\210\333"
	"\217\327\315\015\216\146\216\032\105\313\017\166\165\065\160\076"
	"\160\267\155\030\023\317\266\372\161\045\335\144\020\065\374\055"
	"\031\021\202\341\157\313\240\067\342\356\143\211\316\266\156\072"
	"\034\230\003\333\173\213\057\126\351\172\030\042\013\373\076\071"
	"\075\372\246\007\156\062\355\135\337\262\244\042\224\243\274\132"
	"\215\055\234\303\303\254\140\244\105\125\251\330\265\233\325\360"
	"\120\132\173\046\051\210\070\015\020\167\225\173\073\065\334\233"
	"\017\100\273\120\151\133\257\250\361\344\131\311\376\270\210\176"
	"\055\007\225\011\201\376\312\175\347\111\010\107\274\223\151\301"
	"\302\036\124\102\255\324\221\016\315\227\032\203\121\256\214\045"
	"\337\112\245\252\257\146\165\010\346\205\343\343\254\120\154\314"
	"\223\303\121\232\150\367\260\264\245\115\074\301\100\050\156\051"
	"\037\347\101\331\147\275\313\071\270\320\000\016\311\177\330\023"
	"\170\334\075\375\146\053\124\370\172\071\170\166\135\320\037\002"
	"\032\204\260\366\225\167\110\170\137\073\234\320\034\045\065\172"
	"\045\020\242\221\264\033\142\154\020\214\241\032\162\034\222\032"
	"\156\234\116\137\114\366\204\332\031\215\343\377\051\374\147\202"
	"\104\261\115\114\272\027\002\346\343\234\036\043\232\324\232\020"
	"\025\307\332\220\217\005\257\253\063\124\317\210\275\262\313\056"
	"\160\307\342\202\065\175\111\224\375\166\115\104\025\151\002\322"
	"\325\267\074\022\046\172\031\350\120\274\044\261\043\015\104\273"
	"\337\124\371\145\322\302\357\227\273\005\225\004\220\067\116\201"
	"\221\206\333\062\047\363\200\103\176\243\240\005\372\353\114\317"
	"\150\306\017\255\055\061\253\166\346\374\046\316\017\150\103\337"
	"\307\041\057\142\141\106\145\327\332\257\000\202\105\306\012\110"
	"\073\044\264\343\054\124\026\325\031\263\115\155\034\050\357\267"
	"\216\117\357\075\300\153\015\074\264\271\024\176\001\145\057\302"
	"\033\222\176\130\147\263\072\372\072\035\066\274\265\225\353\354"
	"\060\123\265\216\324\102\343\032\170\171\323\040\351\032\344\064"
	"\053\253\242\040\361\106\156\260\313\132\137\346\027\350\121\172"
	"\011\200\114\054\175\154\130\167\142\212\064\353\352\263\062\125"
	"\222\044\242\007\057\131\123\024\011\233\272\072\014\116\107\037"
	"\202\175\257\337\004\252\154\320\144\277\175\236\216\361\250\025"
	"\252\311\162\206\241\321\044\372\160\142\263\143\321\121\146\176"
	"\101\245\054\220\211\140\346\112\375\224\157\265\073\236\330\034"
	"\005\241\271\107\375\320\240\064\345\061\161\020\244\046\111\374"
	"\135\061\225\205\152\235\266\355\363\261\022\000\042\362\360\316"
	"\156\045\031\123\003\056\023\350\272\112\122\115\142\213\024\023"
	"\116\024\011\224\367\165\211\155\116\216\074\160\246\354\276\121"
	"\003\306\250\373\206\064\121\013\316\047\330\116\277\100\370\040"
	"\207\031\214\245\164\176\245\146\316\101\257\014\166\316\111\374"
	"\013\004\255\302\375\360\310\103\137\251\277\137\250\366\331\011"
	"\032\100\162\110\017\266\366\366\151\243\301\202\207\211\201\323"
	"\355\065\013\032\204\261\143\231\341\277\127\232\254\263\041\140"
	"\314\213\051\202\103\055\022\127\201\357\164\304\230\352\155\275"
	"\252\357\376\022\164\117\174\235\336\240\143\314\344\043\212\043"
	"\361\161\165\346\260\321\270\075\230\155\053\104\005\211\302\267"
	"\006\351\011\307\161\055\162\127\140\147\240\011\043\267\013\076"
	"\243\117\313\301\215\352\121\257\256\340\025\166\337\312\231\331"
	"\173\021\240\260\076\336\252\242\276\217\314\313\324\153\201\023"
	"\265\006\016\213\017\373\324\064\362\042\027\034\271\002\266\277"
	"\370\364\232\352\050\025\061\003\031\326\134\363\045\076\375\051"
	"\016\053\034\377\033\214\131\250\137\005\367\303\337\176\240\035"
	"\325\307\156\054\243\102\246\266\256\137\127\104\335\210\136\301"
	"\022\200\312\131\312\304\100\242\171\145\240\060\076\170\266\073"
	"\135\326\265\065\140\347\173\016\071\200\106\256\334\227\246\057"
	"\117\210\352\270\074\245\377\073\353\266\113\112\054\312\350\020"
	"\154\132\066\240\010\237\351\002\335\246\305\344\366\315\225\363"
	"\317\152\141\035\307\162\157\156\121\355\210\316\212\105\263\322"
	"\004\101\156\166\363\055\366\124\347\045\351\002\276\014\341\272"
	"\011\014\337\341\027\054\314\023\352\120\070\210\277\150\302\344"
	"\117\103\117\174\052\005\333\355\211\140\206\273\233\017\263\207"
	"\334\151\366\241\251\120\014\167\152\104\272\247\051\100\277\322"
	"\320\270\067\155\127\123\310\215\272\174\051\355\171\167\001\323"
	"\232\241\260\062\022\270\325\176\271\144\205\314\023\012\023\206"
	"\211\206\302\255\211\064\377\071\337\316\133\311\052\054\045\000"
	"\073\102\365\332\173\175\261\224\342\170\035\335\060\344\367\065"
	"\312\273\155\266\005\014\052\200\235\005\322\264\144\042\224\354"
	"\130\323\114\267\060\345\025\244\057\046\207\107\061\106\052\263"
	"\100\321\147\060\077\335\231\153\023\301\011\240\224\300\367\053"
	"\107\264\034\140\260\326\340\320\267\333\263\160\325\251\054\115"
	"\072\254\311\222\265\031\127\105\040\013\076\216\214\300\045\210"
	"\377\020\150\012\331\145\361\356\105\055\051\107\270\351\064\251"
	"\141\115\023\107\070\225\262\117\024\172\007\064\327\122\127\105"
	"\346\136\177\013\046\145\367\305\117\263\134\315\314\243\043\200"
	"\323\320\136\370\036\025\310\206\013\122\070\130\224\371\176\334"
	"\142\300\107\216\314\337\073\070\201\301\071\342\143\340\135\171"
	"\066\160\370\336\274\237\025\132\153\304\311\044\374\161\151\300"
	"\336\123\217\043\212\002\244\130\000\014\236\125\200\275\144\130"
	"\213\201\244\341\204\042\100\317\312\252\214\016\104\030\022\125"
	"\306\042\160\126\033\164\334\001\342\263\137\156\121\327\220\362"
	"\265\025\317\346\202\341\155\266\274\130\153\354\316\173\266\262"
	"\143\213\101\117\067\340\140\343\315\237\150\177\365\074\362\362"
	"\013\204\221\110\256\074\327\011\116\042\171\256\117\106\244\313"
	"\353\317\074\126\013\370\272\121\254\171\270\273\147\307\343\305"
	"\221\311\000\304\252\213\030\300\015\322\277\224\370\336\101\323"
	"\137\240\253\307\301\106\107\175\037\300\032\341\024\077\024\077"
	"\155\010\217\100\346\307\266\362\312\301\123\324\136\016\153\356"
	"\002\061\140\252\166\010\132\107\251\236\137\200\050\172\353\264"
	"\063\172\167\342\201\210\266\246\041\006\116\024\173\105\111\266"
	"\012\355\152\377\360\164\045\265\230\126\235\261\301\361\353\224"
	"\044\231\202\207\241\362\174\162\270\377\357\250\045\007\053\336"
	"\246\205\067\250\224\141\313\312\005\332\312\005\036\146\047\237"
	"\172\102\211\075\253\176\221\227\137\074\233\110\015\310\201\024"
	"\226\202\007\175\154\114\022\152\356\232\176\174\120\057\240\265"
	"\177\363\227\171\211\363\143\132\134\236\006\061\145\031\064\136"
	"\104\336\175\271\235\100\325\115\202\300\117\336\351\214\205\271"
	"\364\030\245\122\132\021\361\350\157\060\002\177\242\032\231\241"
	"\003\125\357\031\134\244\355\254\232\306\251\172\017\146\036\345"
	"\250\157\324\271\270\235\006\240\357\002\114\112\251\211\052\373"
	"\342\165\007\265\375\116\211\125\245\174\123\136\010\344\000\046"
	"\146\150\046\307\002\052\335\114\111\334\353\123\077\027\113\001"
	"\022\237\071\223\374\051\202\072\130\260\120\035\364\054\134\256"
	"\104\105\033\154\262\275\265\205\274\224\224\200\350\253\014\046"
	"\334\113\024\012\066\165\367\162\130\126\173\010\244\010\377\134"
	"\015\101\004\052\253\361\111\042\116\120\230\022\044\337\334\144"
	"\036\224\241\312\135\016\046\020\373\003\143\266\314\173\313\374"
	"\153\302\301\215\310\251\130\203\250\142\035\337\300\316\115\127"
	"\376\175\002\235\351\341\130\331\344\241\151\373\154\157\057\347"
	"\147\027\000\130\107\060\007\263\273\264\057\363\074\045\267\232"
	"\351\336\063\362\153\160\030\140\147\023\252\324\164\373\325\352"
	"\270\134\323\261\000\264\160\234\320\250\310\025\175\157\360\332"
	"\307\244\336\140\004\245\050\125\247\300\300\375\014\370\176\277"
	"\323\025\117\131\011\126\261\144\145\352\162\121\151\113\375\325"
	"\362\267\061\005\165\353\375\170\340\144\231\077\230\005\207\114"
	"\104\050\320\063\173\246\335\247\042\046\355\015\013\377\125\320"
	"\173\077\072\017\055\010\133\274\064\062\011\141\124\045\045\206"
	"\134\121\013\272\044\352\217\223\336\012\044\375\327\056\127\010"
	"\030\213\110\120\272\305\322\077\247\075\240\061\374\031\150\022"
	"\122\050\002\322\201\114\046\061\074\367\366\305\216\042\125\016"
	"\073\142\167\350\113\127\071\222\062\171\274\220\254\152\316\111"
	"\270\165\006\277\236\044\172\070\351\325\303\167\370\030\206\063"
	"\173\375\034\307\125\126\132\207\317\026\030\173\200\347\305\071"
	"\134\313\370\373\360\163\063\331\110\367\121\101\020\327\164\213"
	"\325\221\123\052\347\255\262\267\304\312\063\105\262\370\177\016"
	"\303\170\012\263\353\075\215\064\065\337\165\105\266\352\321\214"
	"\173\044\267\142\322\151\031\226\064\115\334\346\105\133\365\010"
	"\323\377\274\276\075\112\363\162\051\150\267\340\123\211\154\316"
	"\255\043\061\200\215\113\027\301\230\363\250\335\117\235\346\042"
	"\235\242\341\332\355\324\115\026\075\005\367\221\216\144\140\074"
	"\210\221\274\025\335\323\327\165\307\200\123\026\036\072\071\273"
	"\335\032\226\312\357\343\340\055\350\330\276\166\074\037\262\304"
	"\260\157\332\216\103\262\003\012\062\127\040\120\221\132\013\156"
	"\164\242\070\144\205\031\222\156\362\121\344\056\160\227\363\040"
	"\007\316\256\112\200\262\124\263\012\165\003\234\317\017\012\104"
	"\261\103\250\067\135\072\245\120\213\212\176\373\042\162\034\051"
	"\100\313\163\301\176\310\164\210\076\170\044\015\210\057\122\072"
	"\163\372\161\321\065\026\041\301\241\240\275\303\022\332\354\123"
	"\245\140\024\043\050\211\254\146\001\320\164\212\377\306\304\163"
	"\301\066\104\367\115\145\270\356\005\166\261\030\120\236\153\365"
	"\376\200\031\047\011\305\216\013\226\002\226\226\311\132\011\212"
	"\220\115\202\335\262\072\314\270\261\175\320\001\034\073\367\032"
	"\274\020\102\306\326\320\322\154\323\150\002\234\302\013\047\123"
	"\130\251\061\013\344\375\304\225\173\224\226\227\320\216\262\214"
	"\236\364\122\165\305\044\341\230\214\343\065\117\357\135\243\110"
	"\006\325\123\353\322\027\200\116\254\027\345\174\245\230\010\104"
	"\215\133\271\122\200\232\353\015\176\040\135\155\175\000\265\204"
	"\325\011\157\250\041\357\366\315"
#define      inlo_z	3
#define      inlo	((&data[7766]))
	"\147\320\167"
#define      tst2_z	19
#define      tst2	((&data[7771]))
	"\360\002\227\064\310\367\345\064\060\130\342\103\204\247\045\075"
	"\211\170\077\224\253\256"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
